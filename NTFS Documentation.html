<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- saved from url=(0059)http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="generator" content="HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org">

<title>NTFS Documentation</title>
<meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
<meta name="description" content="This is technical documentation, created to help the programmer. It was originally written to complement the Linux NTFS driver. The latest version is available online at: http://linux-ntfs.sourceforge.net/ntfs/index.html and can be downloaded from: http://sourceforge.net/project/showfiles.php?group_id=13956 We&#39;re confident that the information is correct. We think we know where there are gaps in our knowledge. We may be wrong. Beware. For simple answers to common questions, try reading the NTFS FAQ.">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="book" lang="en">
<div class="titlepage">
<div>
<div>
<h1 class="title"><a name="ntfsdoc" id="ntfsdoc"></a>NTFS
Documentation</h1>
</div>
<div>
<div class="authorgroup">
<div class="author">
<h3 class="author"><span class="firstname">Richard</span>
<span class="surname">Russon</span></h3>
</div>
<div class="author">
<h3 class="author"><span class="firstname">Yuval</span>
<span class="surname">Fledel</span></h3>
</div>
</div>
</div>
<div>
<p class="releaseinfo">0.5.8</p>
</div>
<div>
<div class="abstract">
<p class="title"><b>Abstract</b></p>
<p>This is technical documentation, created to help the
programmer.</p>
<p>It was originally written to complement the <a href="http://linux-ntfs.sourceforge.net/" target="_top">Linux NTFS
driver</a>.</p>
<p>The latest version is available online at: <a href="http://linux-ntfs.sourceforge.net/ntfs/index.html" target="_top">http://linux-ntfs.sourceforge.net/ntfs/index.html</a> and
can be downloaded from: <a href="http://sourceforge.net/project/showfiles.php?group_id=13956" target="_top">http://sourceforge.net/project/showfiles.php?group_id=13956</a></p>
<p>We're confident that the information is correct. We think we
know where there are gaps in our knowledge. We may be wrong.
Beware.</p>
<p>For simple answers to common questions, try reading the <a href="http://linux-ntfs.sourceforge.net/info/ntfs.html" target="_top">NTFS FAQ</a>.</p>
</div>
</div>
</div>
<hr></div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="chapter"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue">1.
Prologue</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_preface">NTFS
Documentation Preface</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_about">About the NTFS
Documentation</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4701165">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700553">Documentation
Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700617">Accuracy</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700635">Contact
Points</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700706">License</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4749949">Thanks</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_tables_legend">Tables
Legend</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750070">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750082">Footnotes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750094">Size
Fields</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750226">Indexes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750380">Operating
System</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_volume_layout">Volume
Layout</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750516">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750635">Notes</a></span></dt>
</dl>
</dd>
</dl>
</dd>
<dt><span class="chapter"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attributes">2. NTFS
Attributes</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752135">Overview</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752739">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information">Attribute - $STANDARD_INFORMATION
(0x10)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752784">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752813">Layout of the
Attribute (Resident)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753400">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list">Attribute - $ATTRIBUTE_LIST
(0x20)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753441">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753463">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753716">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name">Attribute
- $FILE_NAME (0x30)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753836">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753860">Layout of the
Attribute (Resident)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754338">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id">Attribute
- $OBJECT_ID (0x40)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754415">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754440">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754639">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor">Attribute - $SECURITY_DESCRIPTOR
(0x50)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754678">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754930">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754962">Layout of the
stream</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755218">ACL</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755350">ACE</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755872">SID (Security
Identifier)</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name">Attribute - $VOLUME_NAME
(0x60)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756466">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756490">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756829">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information">Attribute - $VOLUME_INFORMATION
(0x70)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756871">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756893">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757149">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data">Attribute -
$DATA (0x80)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757270">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757293">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757378">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root">Attribute
- $INDEX_ROOT (0x90)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757577">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757595">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758008">Notes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758101">List of Common
Indexes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation">Attribute - $INDEX_ALLOCATION
(0xA0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758414">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758445">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758812">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap">Attribute -
$BITMAP (0xB0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4751993">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752016">Layout of the
Attribute</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point">Attribute - $REPARSE_POINT
(0xC0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759145">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759164">Layout of the
Attribute (Microsoft Reparse Point)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759291">Layout of the
Attribute (Third-Party Reparse Point)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759833">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information">Attribute - $EA_INFORMATION
(0xD0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759886">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759911">Layout of the
Attribute</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea">Attribute - $EA
(0xE0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760042">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760066">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760292">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream">Attribute -
$LOGGED_UTILITY_STREAM (0x100)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760334">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760352">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760444">Notes</a></span></dt>
</dl>
</dd>
</dl>
</dd>
<dt><span class="chapter"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#files">3. NTFS
Files</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768976">Overview</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768332">Layout of the
Volume</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769527">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft">NTFS Files: $MFT
(0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769595">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769613">$MFT
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769779">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769977">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mftmirr">NTFS Files:
$MFTMirr (1)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770031">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770062">$MFTMirr
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770201">Layout of the
File</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile">NTFS Files:
$LogFile (2)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770384">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770392">$LogFile
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770532">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770550">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_volume">NTFS Files:
$Volume (3)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768858">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768869">$Volume
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771319">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771337">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef">NTFS Files:
$AttrDef (4)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771385">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771403">$AttrDef
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771569">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771938">Notes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771992">Examples</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_dot">NTFS Files: . (Root
Directory) (5)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773289">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773317">Dot (.)
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773566">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773714">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_bitmap">NTFS Files:
$Bitmap (6)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773749">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773761">$Bitmap
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773900">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774003">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot">NTFS Files: $Boot
(7)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774062">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774086">$Boot
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774252">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774573"></a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774598">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_badclus">NTFS Files:
$BadClus (8)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774641">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774661">$BadClus
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774827">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774861">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure">NTFS Files:
$Secure (9)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774978">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775032">$Secure
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775336">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776249">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_upcase">NTFS Files:
$UpCase (10)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776291">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776310">$UpCase
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776449">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776549">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_extend">NTFS Files:
$Extend (11)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776577">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776621">$Extend
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776761">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776779">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid">NTFS Files: $ObjId
(Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776808">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776834">$ObjId
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777028">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777438">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota">NTFS Files: $Quota
(NT:9, 2K:Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777512">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777528">$Quota
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777803">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778691">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse">NTFS Files:
$Reparse (Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778764">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778775">$Reparse
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778969">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779240">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl">NTFS Files:
$UsnJrnl (Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779267">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779278">$UsnJrnl
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779444">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779720"></a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779848">Notes</a></span></dt>
</dl>
</dd>
</dl>
</dd>
<dt><span class="chapter"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concepts">4. NTFS
Concepts</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4791956">Overview</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4791310">Index</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header">Concept - Attribute
Header</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4792461">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4792481">Standard Attribute
Header</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793838">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_id">Concept -
Attribute Id</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793888">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_btree">Concept -
B*Trees</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793959">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793976">Basic
Terminology</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794114">NTFS
Trees</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794140">Discussion</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794156">References</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_clusters">Concept -
Clusters</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794403">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794468">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_collation">Concept -
Collation</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794615">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794770">Usage</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794861">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_compression">Concept -
Compression</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794896">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_data_runs">Concept -
Data Runs</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795373">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795405">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795619">data
runs</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795857">Examples</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory">Concept -
Directory</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797230">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797241">Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797536">Definition</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797549">Properties</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797600">Interest</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file">Concept -
File</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797646">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797657">Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797920">Named Data
Streams</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_summary_information">Summary
Information</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record">Concept -
File Record</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798573">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798661">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799178">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_reference">Concept
- File Reference</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799297">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799307">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799386">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace">Concept - Filename
Namespace</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799428">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799448">Possible
Namespaces</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_fixup">Concept -
Fixup</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799585">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799697">What Does It
Do?</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799717">Example</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4800988">The
Details</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header">Concept -
Index Header</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801118">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801141">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801378">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_record">Concept -
Index Record</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801694">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801710">Definition</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801723">Layout</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_links">Concept -
Links</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802132">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802140">Interest</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802155">Questions</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_restart">Concept -
Restart</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802186">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sid">Concept -
SID</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802224">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sparse">Concept -
Sparse</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4803518">Overview</a></span></dt>
</dl>
</dd>
</dl>
</dd>
<dt><span class="chapter"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#epilogue">5.
Epilogue</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4815632">ToDo</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#unanswered_questions">Unanswered Questions</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#history">History</a></span></dt>
</dl>
</dd>
<dt><span class="appendix"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#appendix_license">Appendix I.
License</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817137">GNU Free
Documentation License</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817143">Version 1.1, March
2000</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817160">0.
PREAMBLE</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817838">1. APPLICABILITY AND
DEFINITIONS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818004">2. VERBATIM
COPYING</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818029">3. COPYING IN
QUANTITY</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818096">4.
MODIFICATIONS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818352">5. COMBINING
DOCUMENTS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818409">6. COLLECTIONS OF
DOCUMENTS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818433">7. AGGREGATION WITH
INDEPENDENT WORKS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818474">8.
TRANSLATION</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818494">9.
TERMINATION</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818512">10. FUTURE REVISIONS
OF THIS LICENSE</a></span></dt>
</dl>
</dd>
</dl>
</dd>
<dt><span class="glossary"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary">Glossary</a></span></dt>
</dl>
</div>
<div class="list-of-tables">
<p><b>List of Tables</b></p>
<dl>
<dt>1.1. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750110">Size fields table legend</a></dt>
<dt>1.2. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750236">An example for an index
table</a></dt>
<dt>1.3. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750391">NTFS volume versions for each
OS</a></dt>
<dt>1.4. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750526">Layout of a freshly formatted NTFS
volume</a></dt>
<dt>2.1. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4751509">Standard NTFS Attributes</a></dt>
<dt>2.2. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752819">Layout of the $STANDARD_INFORMATION
(0x10) attribute</a></dt>
<dt>2.3. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753104">File Permissions</a></dt>
<dt>2.4. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753512">Layout of the $ATTRIBUTE_LIST (0x20)
attribute</a></dt>
<dt>2.5. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753866">Layout of the $FILE_NAME (0x30)
attribute</a></dt>
<dt>2.6. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754141">File Flags</a></dt>
<dt>2.7. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754446">Layout of the $OBJECT_ID (0x40)
attribute</a></dt>
<dt>2.8. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754741">Layout of the $SECURITY_DESCRIPTOR
(0x50) attribute</a></dt>
<dt>2.9. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755060">Layout of the $SECURITY_DESCRIPTOR
(0x50) attribute header</a></dt>
<dt>2.10. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755223">Layout of an ACL</a></dt>
<dt>2.11. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755355">Layout of an ACE</a></dt>
<dt>2.12. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755476">ACE types</a></dt>
<dt>2.13. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755557">ACE flags</a></dt>
<dt>2.14. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755640">ACE audit flags</a></dt>
<dt>2.15. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755709">ACE access mask</a></dt>
<dt>2.16. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755886">SID contents</a></dt>
<dt>2.17. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755972">SID example</a></dt>
<dt>2.18. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756162">Security Descriptor Control
Flags</a></dt>
<dt>2.19. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756496">Layout of the $VOLUME_NAME (0x60)
attribute</a></dt>
<dt>2.20. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756898">Layout of the $VOLUME_INFORMATION
(0x70) attribute</a></dt>
<dt>2.21. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757038">Volume Flags</a></dt>
<dt>2.22. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757172">Volume Version Numbers</a></dt>
<dt>2.23. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757298">Layout of the $DATA (0x80)
attribute</a></dt>
<dt>2.24. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757659">Layout of the $INDEX_ROOT (0x90)
attribute: an Index Root</a></dt>
<dt>2.25. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757808">Layout of the $INDEX_ROOT (0x90)
attribute: an Index Header</a></dt>
<dt>2.26. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757934">Index flags</a></dt>
<dt>2.27. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758107">Common Indexes</a></dt>
<dt>2.28. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758456">Layout of the $INDEX_ALLOCATION
(0xA0) attribute</a></dt>
<dt>2.29. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758547">Layout of a data entry in the
$INDEX_ALLOCATION (0xA0) attribute</a></dt>
<dt>2.30. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758745">Data entry flags</a></dt>
<dt>2.31. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752038">Layout of the $BITMAP (0xB0)
attribute</a></dt>
<dt>2.32. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759170">Layout of the $REPARSE_POINT (0xC0)
attribute (Microsoft Reparse Point)</a></dt>
<dt>2.33. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759298">Layout of the $REPARSE_POINT (0xC0)
attribute (Third-Party Reparse Point)</a></dt>
<dt>2.34. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759446">Symbolic Link Reparse Data</a></dt>
<dt>2.35. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759566">Volume Link Reparse Data</a></dt>
<dt>2.36. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759692">Reparse Tag Flags</a></dt>
<dt>2.37. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759917">Layout of the $EA_INFORMATION (0xD0)
attribute</a></dt>
<dt>2.38. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760077">Layout of the $EA (0xE0)
attribute</a></dt>
<dt>2.39. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760243">EA flags</a></dt>
<dt>2.40. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760365">Layout of the $LOGGED_UTILITY_STREAM
(0x100) attribute</a></dt>
<dt>3.1. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768350">Layout of files on the
Volume</a></dt>
<dt>3.2. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769618">$MFT Attributes</a></dt>
<dt>3.3. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769827">Sample records from the beginning of
$MFT</a></dt>
<dt>3.4. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770068">$MFTMirr Attributes</a></dt>
<dt>3.5. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770217">Layout of $MFTMirr</a></dt>
<dt>3.6. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770398">$LogFile Attributes</a></dt>
<dt>3.7. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768875">$Volume Attributes</a></dt>
<dt>3.8. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771408">$AttrDef Attributes</a></dt>
<dt>3.9. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771586">Layout of $AttrDef</a></dt>
<dt>3.10. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771747">$AttrDef Collation Rules</a></dt>
<dt>3.11. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771868">$AttrDef Flags</a></dt>
<dt>3.12. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4772004">$AttrDef example from Windows
NT</a></dt>
<dt>3.13. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4772614">$AttrDef example from Windows
2000/XP</a></dt>
<dt>3.14. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773323">Dot (.) Attributes</a></dt>
<dt>3.15. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773587">Layout of Dot (.)</a></dt>
<dt>3.16. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773766">$Bitmap Attributes</a></dt>
<dt>3.17. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773916">Layout of $Bitmap</a></dt>
<dt>3.18. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774092">$Boot Attributes</a></dt>
<dt>3.19. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774264">Layout of $Boot</a></dt>
<dt>3.20. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774666">$BadClus Attributes</a></dt>
<dt>3.21. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775038">$Secure Attributes</a></dt>
<dt>3.22. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775361">Layout of $Secure:$SDS</a></dt>
<dt>3.23. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775513">Layout of $Secure:$SDH</a></dt>
<dt>3.24. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775906">Layout of $Secure:$SII</a></dt>
<dt>3.25. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776316">$UpCase Attributes</a></dt>
<dt>3.26. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776461">Layout of $UpCase</a></dt>
<dt>3.27. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776627">$Extend Attributes</a></dt>
<dt>3.28. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776840">$ObjId Attributes</a></dt>
<dt>3.29. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777039">Layout of $ObjId:$O</a></dt>
<dt>3.30. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777378">$ObjId flags</a></dt>
<dt>3.31. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777533">$Quota Attributes</a></dt>
<dt>3.32. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777814">Layout of $Quota:$O</a></dt>
<dt>3.33. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778117">Layout of $Quota:$Q</a></dt>
<dt>3.34. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778539">$Quota flags</a></dt>
<dt>3.35. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778781">$Reparse Attributes</a></dt>
<dt>3.36. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778981">Layout of $Reparse:$R</a></dt>
<dt>3.37. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779284">$UsnJrnl Attributes</a></dt>
<dt>3.38. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779465">Layout of $UsnJrnl:$J</a></dt>
<dt>3.39. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779734">Layout of $UsnJrnl:$Max</a></dt>
<dt>3.40. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779865">$UsnJrnl reason flags</a></dt>
<dt>3.41. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4780137">$UsnJrnl source info flags</a></dt>
<dt>4.1. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4791315">NTFS Concepts</a></dt>
<dt>4.2. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4792492">Layout of a resident unnamed
attribute header</a></dt>
<dt>4.3. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4792762">Layout of a resident named attribute
header</a></dt>
<dt>4.4. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793056">Layout of a non-resident unnamed
attribute header</a></dt>
<dt>4.5. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793402">Layout of a non-resident named
attribute header</a></dt>
<dt>4.6. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793768">Attribute flags</a></dt>
<dt>4.7. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794514">Default cluster size</a></dt>
<dt>4.8. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794625">Collation types</a></dt>
<dt>4.9. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794780">Default collations types for standard
indexes</a></dt>
<dt>4.10. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795422">Layout of a data run</a></dt>
<dt>4.11. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795876">Parsed data runs: Example 1 -
Normal, Unfragmented File</a></dt>
<dt>4.12. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4796081">Parsed data runs: Example 2 -
Normal, Fragmented File</a></dt>
<dt>4.13. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4796348">Parsed data runs: Example 3 -
Normal, Scrambled File</a></dt>
<dt>4.14. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4796617">Parsed data runs: Example 4 -
Sparse, Unfragmented File</a></dt>
<dt>4.15. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4796889">Parsed data runs: Example 5 -
Compressed, Unfragmented File</a></dt>
<dt>4.16. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797247">A directory record
attributes</a></dt>
<dt>4.17. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797663">A file record attributes</a></dt>
<dt>4.18. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797932">Fictional named data
streams</a></dt>
<dt>4.19. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798116">Summary Information named data
streams</a></dt>
<dt>4.20. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798291">contents of Summary Information
named data streams</a></dt>
<dt>4.21. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798687">Layout of a file record</a></dt>
<dt>4.22. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799045">File record flags</a></dt>
<dt>4.23. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799313">Layout of a file reference</a></dt>
<dt>4.24. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799727">Fixup example: before</a></dt>
<dt>4.25. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4800357">Fixup example: after</a></dt>
<dt>4.26. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801152">Layout of a Standard Index
Header</a></dt>
<dt>4.27. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801389">List of Common Indexes</a></dt>
<dt>4.28. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801744">Layout of an Index record
header</a></dt>
<dt>4.29. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802261">Common well known SIDs</a></dt>
<dt>4.30. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802333">Identifier Authorities</a></dt>
<dt>4.31. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802453">Relative Identifiers</a></dt>
<dt>4.32. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802828">Domain Users</a></dt>
<dt>4.33. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802899">Domain Groups</a></dt>
<dt>4.34. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4803030">Domain Aliases</a></dt>
<dt>4.35. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4803184">Universal well-known SIDs</a></dt>
<dt>4.36. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4803306">NT well-known SIDs</a></dt>
<dt>122. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4824321">Measurement Units</a></dt>
</dl>
</div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="prologue" id="prologue"></a>Chapter&nbsp;1.&nbsp;Prologue</h2>
</div>
</div>
</div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_preface">NTFS
Documentation Preface</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_about">About the NTFS
Documentation</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4701165">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700553">Documentation
Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700617">Accuracy</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700635">Contact
Points</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4700706">License</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4749949">Thanks</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_tables_legend">Tables
Legend</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750070">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750082">Footnotes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750094">Size
Fields</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750226">Indexes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750380">Operating
System</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_volume_layout">Volume
Layout</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750516">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4750635">Notes</a></span></dt>
</dl>
</dd>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="prologue_preface" id="prologue_preface"></a>NTFS Documentation Preface</h2>
</div>
</div>
</div>
<p>This is version 0.5 of the NTFS Documentation and is available
as part of the <a href="http://linux-ntfs.sourceforge.net/" target="_top">Linux-NTFS Project</a></p>
<p>This is technical documentation, created to help the
programmer.</p>
<p>It was originally written to complement the <a href="http://linux-ntfs.sourceforge.net/" target="_top">Linux NTFS
driver</a>.</p>
<p>The latest version is available online at: <a href="http://linux-ntfs.sourceforge.net/ntfs/index.html" target="_top">http://linux-ntfs.sourceforge.net/ntfs/index.html</a> and
can be downloaded from: <a href="http://sourceforge.net/project/showfiles.php?group_id=13956" target="_top">http://sourceforge.net/project/showfiles.php?group_id=13956</a></p>
<p>For simple answers to common questions, try reading the <a href="http://linux-ntfs.sourceforge.net/info/ntfs.html" target="_top">NTFS FAQ</a>.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="prologue_about" id="prologue_about"></a>About the NTFS Documentation</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4701165" id="id4701165"></a>Overview</h3>
</div>
</div>
</div>
<p>NTFS is the filesystem of Windows NT, 2000 and XP. It supports
almost all POSIX features, all HFS features, and all HPFS
features.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>It can deal with large capacity (up to 2 <sup>46</sup> GB)
storage units.</p>
</li>
<li>
<p>It has built-in data compression.</p>
</li>
<li>
<p>It uses log file for transactions.</p>
</li>
<li>
<p>Byte order: everything is little-endian on-disk.</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4700553" id="id4700553"></a>Documentation Layout</h3>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Chapter 1 - Prologue: is information describing the
documentation.</p>
</li>
<li>
<p>Chapter 2 - Files: is a list of the Metadata files.</p>
</li>
<li>
<p>Chapter 3 - Attributes: is a list of Metadata attributes.</p>
</li>
<li>
<p>Chapter 4 - Concepts: is a list of objects that are neither
file, nor attribute.</p>
</li>
<li>
<p>Chapter 5 - Epilogue: is some more information about the
documentation.</p>
</li>
<li>
<p>Appendix I - License: is the license under which the
documentation is distributed.</p>
</li>
<li>
<p>The Glossary: is a what's what of technical terminology</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4700617" id="id4700617"></a>Accuracy</h3>
</div>
</div>
</div>
<p>Microsoft hasn't released any documentation for NTFS. These
documents have been pieced together partly by carefully reading all
the SDKs and Windows help but mostly by reverse-engineering the
filesystem.</p>
<p>We're confident that the information is correct. We think we
know where there are gaps in our knowledge. We may be wrong.
Beware.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4700635" id="id4700635"></a>Contact
Points</h3>
</div>
</div>
</div>
<p>You can post questions to an open forum on <a href="http://sourceforge.net/" target="_top">SourceForge</a> at:
<a href="http://sourceforge.net/forum/forum.php?forum_id=44084" target="_top">http://sourceforge.net/forum/forum.php?forum_id=44084</a></p>
<p>If you'd like to get more involved in the Linux project, then
you can join one of the mailing lists (both low volume).</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>A general list for NTFS: <a href="http://tiger.informatik.hu-berlin.de/cgi-bin/mailman/listinfo/linux-ntfs" target="_top">http://tiger.informatik.hu-berlin.de/cgi-bin/mailman/listinfo/linux-ntfs</a></p>
</li>
<li>
<p>A bit more technical one: <a href="http://lists.sourceforge.net/lists/listinfo/linux-ntfs-dev" target="_top">http://lists.sourceforge.net/lists/listinfo/linux-ntfs-dev</a></p>
</li>
</ul>
</div>
<p>Alternatively, if you have any questions, suggestions or
corrections, please email me.</p>
<p>Richard Russon</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4700706" id="id4700706"></a>License</h3>
</div>
</div>
</div>
<p>Copyright (C) 1996-2004 Richard Russon.</p>
<p>Copyright (C) 2005 Yuval Fledel.</p>
<p>Permission is granted to copy, distribute and/or modify this
document under the terms of the GNU Free Documentation License,
Version 1.1 or any later version published by the Free Software
Foundation;</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>With the Invariant Sections being <span class="emphasis"><em>Thanks</em></span></p>
</li>
<li>
<p>With the Front-Cover Texts being <span class="emphasis"><em>About the NTFS Documentation</em></span></p>
</li>
<li>
<p>And with the no Back-Cover Texts.</p>
</li>
</ul>
</div>
<p>A copy of the license is included in the section entitled
<span class="emphasis"><em>GNU Free Documentation
License</em></span>.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4749949" id="id4749949"></a>Thanks</h3>
</div>
</div>
</div>
<p>Many thanks to the following for their help preparing these
documents.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Albert Cahalan</p>
</li>
<li>
<p>Alex Ionescu</p>
</li>
<li>
<p>Anton Altaparmakov</p>
</li>
<li>
<p>Bram Moolenaar (for vim)</p>
</li>
<li>
<p>Damon Casale</p>
</li>
<li>
<p>David Dillard</p>
</li>
<li>
<p>Domagoj Pensa</p>
</li>
<li>
<p>Helen Custer</p>
</li>
<li>
<p>Martin von Lwis</p>
</li>
<li>
<p>Olof Wolgast</p>
</li>
<li>
<p>Rani Assaf</p>
</li>
<li>
<p>Rgis Duchesne</p>
</li>
<li>
<p>Richard Russon</p>
</li>
<li>
<p>Yuval Fledel</p>
</li>
</ul>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="prologue_tables_legend" id="prologue_tables_legend"></a>Tables
Legend</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750070" id="id4750070"></a>Overview</h3>
</div>
</div>
</div>
<p>The tables in this documentation aren't completely consistant.
Below is a key to the tables showing how various fields are
represented.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750082" id="id4750082"></a>Footnotes</h3>
</div>
</div>
</div>
<p>Any table fields that have footnote marks, e.g. (a), (e), will
have a fuller description immediately below the table.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750094" id="id4750094"></a>Size
Fields</h3>
</div>
</div>
</div>
<p>In NTFS not all fields are of a fixed size. Some depend on the
value of another field, some depend on the contents of the
field.</p>
<p>All the numbers in size fields are in decimal format. e.g. 12
(twelve), 42 (forty-two).</p>
<div class="table"><a name="id4750110" id="id4750110"></a>
<p class="title"><b>Table&nbsp;1.1.&nbsp;Size fields table
legend</b></p>
<table summary="Size fields table legend" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Key</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>12</td>
<td>Fixed</td>
<td>This field is twelve bytes long. Its size is constant.</td>
</tr>
<tr>
<td>P8</td>
<td>Padding</td>
<td>P8 means pad the field to an 8 byte boundary. The size of this
field could be 0 - 7 bytes. P4 means 4 byte alignment, etc (a)</td>
</tr>
<tr>
<td>V</td>
<td>Variable</td>
<td>The length of this field depends on its contents. An example is
a SID. To know its length, you must decode the structure.</td>
</tr>
<tr>
<td>S</td>
<td>X-Ref</td>
<td>A cross-reference shows that the size is defined elsewhere in
the table. The size can be represented by any letter, except P or
V.</td>
</tr>
</tbody>
</table>
</div>
<p>(a) Any padding of a fixed size will be displayed as a fixed
size.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750226" id="id4750226"></a>Indexes</h3>
</div>
</div>
</div>
<p>Where a table represents an index, the key and data will be
shown as below:</p>
<div class="table"><a name="id4750236" id="id4750236"></a>
<p class="title"><b>Table&nbsp;1.2.&nbsp;An example for an index
table</b></p>
<table summary="An example for an index table" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>2</td>
<td colspan="2">Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td colspan="2">Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Key</td>
<td>SID</td>
</tr>
<tr>
<td>0x08</td>
<td>4</td>
<td>Data</td>
<td>Owner Id</td>
</tr>
<tr>
<td>0x0C</td>
<td>4</td>
<td>Data</td>
<td>Hash</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750380" id="id4750380"></a>Operating
System</h3>
</div>
</div>
</div>
<p>Note that the fields are not all used in exactly the same way.
NT indicates old fields whereas 2K and XP indicate new fields.</p>
<div class="table"><a name="id4750391" id="id4750391"></a>
<p class="title"><b>Table&nbsp;1.3.&nbsp;NTFS volume versions for
each OS</b></p>
<table summary="NTFS volume versions for each OS" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>OS</th>
<th>NTFS</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>blank</td>
<td>all</td>
<td>Used by all versions of Windows</td>
</tr>
<tr>
<td>NT</td>
<td>1.2</td>
<td>Only used in Windows NT</td>
</tr>
<tr>
<td>2K</td>
<td>3.0</td>
<td>Windows 2000 and later</td>
</tr>
<tr>
<td>XP</td>
<td>3.1</td>
<td>New to Windows XP</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">    repeating groups?
    link padding8, padding and other table features to help/tables
    consistant use of padding/alignment fields
                        
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="prologue_volume_layout" id="prologue_volume_layout"></a>Volume
Layout</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750516" id="id4750516"></a>Overview</h3>
</div>
</div>
</div>
<p>A freshly formatted NTFS volume will look like:</p>
<div class="table"><a name="id4750526" id="id4750526"></a>
<p class="title"><b>Table&nbsp;1.4.&nbsp;Layout of a freshly
formatted NTFS volume</b></p>
<table summary="Layout of a freshly formatted NTFS volume" border="1">
<colgroup>
<col align="center">
<col align="center">
<col align="center">
<col align="center">
<col align="center"></colgroup>
<tbody>
<tr>
<td align="center">
<p>B</p>
<p>O</p>
<p>O</p>
<p>T</p>
</td>
<td align="center">
<p>M</p>
<p>F</p>
<p>T</p>
</td>
<td align="center">
<p>Free Space</p>
</td>
<td align="center">
<p>More</p>
<p>Meta</p>
<p>data</p>
</td>
<td align="center">
<p>Free Space</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4750635" id="id4750635"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4750641" id="id4750641"></a>Other
information</h4>
</div>
</div>
</div>
<p>Everything is a file in NTFS. The index to these files is the
Master File Table (MFT). The MFT lists the Boot Sector file
($Boot), located at the beginning of the disk. $Boot also lists
where to find the MFT. The MFT also lists itself.</p>
<p>Located in the centre of the disk, we find some more Metadata
files. The interesting ones are: $MFTMirr and $LogFile. The MFT
Mirror is an exact copy of the first 4 records of the MFT. If the
MFT is damaged, then the volume could be recovered by finding the
mirror. The LogFile is journal of all the events waiting to be
written to disk. If the machine crashes, then the LogFile is used
to return the disk to a sensible state.</p>
<p>Hidden at the end of the volume, is a copy of the boot sector
(cluster 0). The only Metadata file that makes reference to it is
$Bitmap, and that only says that the cluster is in use.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4750672" id="id4750672"></a>MFT
Zone</h4>
</div>
</div>
</div>
<p>To prevent the MFT becoming fragmented, Windows maintains a
buffer around it. No new files will be created in this buffer
region until the other disk space is used up. The buffer size is
configurable and can be 12.5%, 25%, 37.5% or 50% of the disk. Each
time the rest of the disk becomes full, the buffer size is
halved.</p>
<pre class="programlisting">    MFT Zone Reservation IS NOT STORED ON DISK
    MFT Zone (reserved space for MFT)
      1 = 12.5%
      2 = 25.0%
      3 = 37.5%
      4 = 50.0%
      Where is this stored on disk?
      volume?  mft?  boot?
      This is the 'system files' space at
      the beginning of the disk.
      NtfsMftZoneReservation

    link in to mft and bitmap
                                
</pre>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>cluster size 512 bytes, 1k, 2k, 4k, 8k, 16k, 32k, 64k</p>
</li>
<li>
<p>very flexible, all the system files can be relocated, except
$Boot</p>
</li>
<li>
<p>supports streams named data streams</p>
</li>
<li>
<p>attributes for a file can span several MFT records not
necessarily contiguous or in order</p>
</li>
<li>
<p>everything is an attribute, including the data</p>
</li>
<li>
<p>filenames stored in Unicode</p>
</li>
<li>
<p>journalling file system</p>
</li>
<li>
<p>compression</p>
</li>
<li>
<p>security</p>
</li>
<li>
<p>hard links</p>
</li>
<li>
<p>encryption</p>
</li>
<li>
<p>LCNs vs VCNs</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="attributes" id="attributes"></a>Chapter&nbsp;2.&nbsp;NTFS Attributes</h2>
</div>
</div>
</div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752135">Overview</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752739">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information">Attribute - $STANDARD_INFORMATION
(0x10)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752784">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752813">Layout of the
Attribute (Resident)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753400">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list">Attribute - $ATTRIBUTE_LIST
(0x20)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753441">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753463">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753716">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name">Attribute
- $FILE_NAME (0x30)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753836">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4753860">Layout of the
Attribute (Resident)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754338">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id">Attribute
- $OBJECT_ID (0x40)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754415">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754440">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754639">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor">Attribute - $SECURITY_DESCRIPTOR
(0x50)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754678">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754930">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4754962">Layout of the
stream</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755218">ACL</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755350">ACE</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4755872">SID (Security
Identifier)</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name">Attribute - $VOLUME_NAME
(0x60)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756466">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756490">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756829">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information">Attribute - $VOLUME_INFORMATION
(0x70)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756871">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4756893">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757149">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data">Attribute -
$DATA (0x80)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757270">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757293">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757378">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root">Attribute
- $INDEX_ROOT (0x90)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757577">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4757595">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758008">Notes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758101">List of Common
Indexes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation">Attribute - $INDEX_ALLOCATION
(0xA0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758414">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758445">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4758812">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap">Attribute -
$BITMAP (0xB0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4751993">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4752016">Layout of the
Attribute</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point">Attribute - $REPARSE_POINT
(0xC0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759145">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759164">Layout of the
Attribute (Microsoft Reparse Point)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759291">Layout of the
Attribute (Third-Party Reparse Point)</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759833">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information">Attribute - $EA_INFORMATION
(0xD0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759886">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4759911">Layout of the
Attribute</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea">Attribute - $EA
(0xE0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760042">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760066">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760292">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream">Attribute -
$LOGGED_UTILITY_STREAM (0x100)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760334">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760352">Layout of the
Attribute</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4760444">Notes</a></span></dt>
</dl>
</dd>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="id4752135" id="id4752135"></a>Overview</h2>
</div>
</div>
</div>
<p>Each MFT <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">FILE Record</a> is built up from
Attributes.</p>
<p>The list of possible Attributes is defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>.</p>
<div class="table"><a name="id4751509" id="id4751509"></a>
<p class="title"><b>Table&nbsp;2.1.&nbsp;Standard NTFS
Attributes</b></p>
<table summary="Standard NTFS Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>OS</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">0x20</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">$ATTRIBUTE_LIST</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
</tr>
<tr>
<td>0x40</td>
<td>NT</td>
<td>$VOLUME_VERSION</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">0x40</a></td>
<td>2K</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">$OBJECT_ID</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">0x60</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">$VOLUME_NAME</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">0x70</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">$VOLUME_INFORMATION</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
</tr>
<tr>
<td>0xC0</td>
<td>NT</td>
<td>$SYMBOLIC_LINK</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">0xC0</a></td>
<td>2K</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">$REPARSE_POINT</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">0xD0</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">$EA_INFORMATION</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">0xE0</a></td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">$EA</a></td>
</tr>
<tr>
<td>0xF0</td>
<td>NT</td>
<td>$PROPERTY_SET</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream" title="Attribute - $LOGGED_UTILITY_STREAM (0x100)">0x100</a></td>
<td>2K</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream" title="Attribute - $LOGGED_UTILITY_STREAM (0x100)">$LOGGED_UTILITY_STREAM</a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4752739" id="id4752739"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4752744" id="id4752744"></a>Other
Information</h4>
</div>
</div>
</div>
<p>$PROPERTY_SET, $SYMBOLIC_LINK and $VOLUME_VERSION existed in
NTFS v1.2, but weren't used. They no longer exist in NTFS v3.0
(that used by Win2K).</p>
<p>Each MFT record has a <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Header</a>, followed by a
list of attributes (in order of ascending Attribute Id) and an end
marker. The end marker is just four bytes: 0xFFFFFFFF.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_standard_information" id="attribute_standard_information"></a>Attribute -
$STANDARD_INFORMATION (0x10)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4752784" id="id4752784"></a>Overview</h3>
</div>
</div>
</div>
<p>In old version of NTFS this Attribute contained little more than
the DOS File Permissions and the file times.</p>
<p>Windows 2000 introduced four new fields which are used to
reference Quota, Security, File Size and Logging information.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a
minimum size of 48 bytes and a maximum of 72 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4752813" id="id4752813"></a>Layout of
the Attribute (Resident)</h3>
</div>
</div>
</div>
<div class="table"><a name="id4752819" id="id4752819"></a>
<p class="title"><b>Table&nbsp;2.2.&nbsp;Layout of the
$STANDARD_INFORMATION (0x10) attribute</b></p>
<table summary="Layout of the $STANDARD_INFORMATION (0x10) attribute" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>OS</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>&nbsp;</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>8</td>
<td>&nbsp;</td>
<td>C Time - File Creation</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>&nbsp;</td>
<td>A Time - File Altered</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>&nbsp;</td>
<td>M Time - MFT Changed</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>&nbsp;</td>
<td>R Time - File Read</td>
</tr>
<tr>
<td>0x20</td>
<td>4</td>
<td>&nbsp;</td>
<td>DOS File Permissions</td>
</tr>
<tr>
<td>0x24</td>
<td>4</td>
<td>&nbsp;</td>
<td>Maximum Number of Versions</td>
</tr>
<tr>
<td>0x28</td>
<td>4</td>
<td>&nbsp;</td>
<td>Version Number</td>
</tr>
<tr>
<td>0x2C</td>
<td>4</td>
<td>&nbsp;</td>
<td>Class Id</td>
</tr>
<tr>
<td>0x30</td>
<td>4</td>
<td>2K</td>
<td>Owner Id</td>
</tr>
<tr>
<td>0x34</td>
<td>4</td>
<td>2K</td>
<td>Security Id</td>
</tr>
<tr>
<td>0x38</td>
<td>8</td>
<td>2K</td>
<td>Quota Charged</td>
</tr>
<tr>
<td>0x40</td>
<td>8</td>
<td>2K</td>
<td>Update Sequence Number (USN)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4753095" id="id4753095"></a>File
Permissions</h4>
</div>
</div>
</div>
<p>Also called attributes in DOS terminology.</p>
<div class="table"><a name="id4753104" id="id4753104"></a>
<p class="title"><b>Table&nbsp;2.3.&nbsp;File Permissions</b></p>
<table summary="File Permissions" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>Read-Only</td>
</tr>
<tr>
<td>0x0002</td>
<td>Hidden</td>
</tr>
<tr>
<td>0x0004</td>
<td>System</td>
</tr>
<tr>
<td>0x0020</td>
<td>Archive</td>
</tr>
<tr>
<td>0x0040</td>
<td>Device</td>
</tr>
<tr>
<td>0x0080</td>
<td>Normal</td>
</tr>
<tr>
<td>0x0100</td>
<td>Temporary</td>
</tr>
<tr>
<td>0x0200</td>
<td>Sparse File</td>
</tr>
<tr>
<td>0x0400</td>
<td>Reparse Point</td>
</tr>
<tr>
<td>0x0800</td>
<td>Compressed</td>
</tr>
<tr>
<td>0x1000</td>
<td>Offline</td>
</tr>
<tr>
<td>0x2000</td>
<td>Not Content Indexed</td>
</tr>
<tr>
<td>0x4000</td>
<td>Encrypted</td>
</tr>
</tbody>
</table>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Maximum Number of Versions</p>
<p>Maximum allowed versions for file. Zero means that version
numbering is disabled.</p>
</li>
<li>
<p>Version Number</p>
<p>This file's version (if any). Will be zero if Maximum Number of
Versions is zero.</p>
</li>
<li>
<p>Class Id</p>
<p>Class Id from bidirectional Class Id index.</p>
</li>
<li>
<p>Owner Id</p>
<p>Owner Id of the user owning the file. This Id is a key in the
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$O
and $Q</a> Indexes of the file <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a>. If zero, then
quotas are disabled.</p>
</li>
<li>
<p>Security Id</p>
<p>This should not be confused with a Security Identifier. The
Security Id is a key in the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$SII Index and $SDS Data Stream</a> in
the file <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$Secure</a>.</p>
</li>
<li>
<p>Quota Charged</p>
<p>The number of bytes this file user from the user's quota. This
should be the total data size of all streams. If zero, then quotas
are disabled.</p>
</li>
<li>
<p>Update Sequence Number (USN)</p>
<p>Last Update Sequence Number of the file. This is a direct index
into the file <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl" title="NTFS Files: $UsnJrnl (Any)">$UsnJrnl</a>. If zero, the USN Journal
is disabled.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4753400" id="id4753400"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4753406" id="id4753406"></a>Other
Information</h4>
</div>
</div>
</div>
<p>If a NTFS volume is upgraded from v1.2 to v3.0, then this
attribute won't be upgraded (lengthened) until it is accesssed.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4753418" id="id4753418"></a>Questions</h4>
</div>
</div>
</div>
<p>Are the Version fields and the Class Id ever used?</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_attribute_list" id="attribute_attribute_list"></a>Attribute - $ATTRIBUTE_LIST
(0x20)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4753441" id="id4753441"></a>Overview</h3>
</div>
</div>
</div>
<p>When there are lots of attributes and space in the MFT record is
short, all those attributes that can be made non-resident are moved
out of the MFT. If there is still not enough room, then an
$ATTRIBUTE_LIST attribute is needed. The remaining attributes are
placed in a new MFT record and the $ATTRIBUTE_LIST describes where
to find them. It is very unusual to see this attribute.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4753463" id="id4753463"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<p>After the standard header, this attribute contains a list of
variable length records, describing the type and location (in the
MFT) of all the other attributes belonging to this file. Each
record is aligned on an 8-byte boundary.</p>
<p>The list is sorted by:</p>
<div class="orderedlist">
<ol type="1">
<li>
<p>Attribute type</p>
</li>
<li>
<p>Attribute name (if present)</p>
</li>
<li>
<p>Sequence number</p>
</li>
</ol>
</div>
<p>N.B. It does not list itself.</p>
<div class="table"><a name="id4753512" id="id4753512"></a>
<p class="title"><b>Table&nbsp;2.4.&nbsp;Layout of the
$ATTRIBUTE_LIST (0x20) attribute</b></p>
<table summary="Layout of the $ATTRIBUTE_LIST (0x20) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>4</td>
<td>Type</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Record length</td>
</tr>
<tr>
<td>0x06</td>
<td>1</td>
<td>Name length (N)</td>
</tr>
<tr>
<td>0x07</td>
<td>1</td>
<td>Offset to Name (a)</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>Starting VCN (b)</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>Base File Reference of the attribute</td>
</tr>
<tr>
<td>0x18</td>
<td>2</td>
<td>Attribute Id (c)</td>
</tr>
<tr>
<td>0x1A</td>
<td>2N</td>
<td>Name in Unicode (if N &gt;0)</td>
</tr>
</tbody>
</table>
</div>
<p>(a) If the name doesn't exist, does this point at the attribute
or zero?</p>
<p>(b) Starting VCN, or zero if the attribute is resident</p>
<p>(c) Each attribute has a unique identifier</p>
<pre class="programlisting">(a) it always points to where the name would be (0x1A)
0x04 record allocation (8 byte alignment)
(c) always seems to be zero, check
(c) no it's only shown the first time for a given attribute type
not sure about sorting by sequence number.  VCN definitely
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4753716" id="id4753716"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4753722" id="id4753722"></a> <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a></h4>
</div>
</div>
</div>
<p>It can be either resident or non-resident. This attribute has a
no minimum or maximum size.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4753740" id="id4753740"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The offset at 0x07 is just one byte long, unusual for an
attribute.</p>
<p>If this attribute is non-resident, then the data runs must fit
into one MFT record.</p>
<p>The $ATTRIBUTE_LIST may be needed if the file:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>has a large number of hard links (lots of file name attributes
present).</p>
</li>
<li>
<p>becomes very fragmented, so the data runs overflow the MFT
record.</p>
</li>
<li>
<p>has a complex security descriptor (not applicable to NTFS
v3.0+</p>
</li>
<li>
<p>has many named streams, e.g. data streams.</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4753794" id="id4753794"></a>To Do</h4>
</div>
</div>
</div>
<pre class="programlisting">    8 VCN lowest_vcn;
    Lowest virtual cluster number of this portion of the attribute value. This is usually 0. It
    is non-zero for the case where one attribute does not fit into one mft record and thus
    several mft records are allocated to hold this attribute. In the latter case, each mft
    record holds one extent of the attribute and there is one attribute list entry for each
    extent. NOTE: This is DEFINITELY a signed value! The windows driver uses cmp, followed
    by jg when comparing this, thus it treats it as signed.

    24 __u16 instance;
    If lowest_vcn = 0, the instance of the attribute being referenced; otherwise 0.

    The attribute list is used in case where a file need extension FILE records in the
    MFT to be fully described, in order to find any file attribute of this file.
    This file attribute may be non-resident because its stream is likely to grow.

    The extents of one non-resident attribute (if present) immediately follow
    after the initial extent. They are ordered by lowest_vcn and have their instance set to zero.
                                
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_file_name" id="attribute_file_name"></a>Attribute - $FILE_NAME (0x30)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4753836" id="id4753836"></a>Overview</h3>
</div>
</div>
</div>
<p>This Attribute stores the name of the file attribute anl is
always resident.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a
minimum size of 68 bytes and a maximum of 578 bytes. This equates
to a maximum filename length of 255 Unicode characters.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4753860" id="id4753860"></a>Layout of
the Attribute (Resident)</h3>
</div>
</div>
</div>
<div class="table"><a name="id4753866" id="id4753866"></a>
<p class="title"><b>Table&nbsp;2.5.&nbsp;Layout of the $FILE_NAME
(0x30) attribute</b></p>
<table summary="Layout of the $FILE_NAME (0x30) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>8</td>
<td>File reference to the parent directory.</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>C Time - File Creation</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>A Time - File Altered</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>M Time - MFT Changed</td>
</tr>
<tr>
<td>0x20</td>
<td>8</td>
<td>R Time - File Read</td>
</tr>
<tr>
<td>0x28</td>
<td>8</td>
<td>Allocated size of the file</td>
</tr>
<tr>
<td>0x30</td>
<td>8</td>
<td>Real size of the file</td>
</tr>
<tr>
<td>0x38</td>
<td>4</td>
<td>Flags, e.g. Directory, compressed, hidden</td>
</tr>
<tr>
<td>0x3c</td>
<td>4</td>
<td>Used by EAs and Reparse</td>
</tr>
<tr>
<td>0x40</td>
<td>1</td>
<td>Filename length in characters (L)</td>
</tr>
<tr>
<td>0x41</td>
<td>1</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace" title="Concept - Filename Namespace">Filename namespace</a> 0x42 2L File
name in Unicode (not null terminated)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754097" id="id4754097"></a>File
Reference</h4>
</div>
</div>
</div>
<p>This is a File Reference to the base record of the parent
directory.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754109" id="id4754109"></a>File
Size</h4>
</div>
</div>
</div>
<p>The allocated size of a file is the amount of disk space the
file is taking up. It will be a multiple of the cluster size. The
real size of the file is the size of the unnamed data attribute.
This is the number that will appear in a directory listing.</p>
<p>N.B. The Real Size is only present if the Starting VCN is zero.
See the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a> for more
information.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754135" id="id4754135"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4754141" id="id4754141"></a>
<p class="title"><b>Table&nbsp;2.6.&nbsp;File Flags</b></p>
<table summary="File Flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>Read-Only</td>
</tr>
<tr>
<td>0x0002</td>
<td>Hidden</td>
</tr>
<tr>
<td>0x0004</td>
<td>System</td>
</tr>
<tr>
<td>0x0020</td>
<td>Archive</td>
</tr>
<tr>
<td>0x0040</td>
<td>Device</td>
</tr>
<tr>
<td>0x0080</td>
<td>Normal</td>
</tr>
<tr>
<td>0x0100</td>
<td>Temporary</td>
</tr>
<tr>
<td>0x0200</td>
<td>Sparse File</td>
</tr>
<tr>
<td>0x0400</td>
<td>Reparse Point</td>
</tr>
<tr>
<td>0x0800</td>
<td>Compressed</td>
</tr>
<tr>
<td>0x1000</td>
<td>Offline</td>
</tr>
<tr>
<td>0x2000</td>
<td>Not Content Indexed</td>
</tr>
<tr>
<td>0x4000</td>
<td>Encrypted</td>
</tr>
<tr>
<td>0x10000000</td>
<td>Directory (copy from corresponding bit in MFT record)</td>
</tr>
<tr>
<td>0x20000000</td>
<td>Index View (copy from corresponding bit in MFT record)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754338" id="id4754338"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754344" id="id4754344"></a>Other
Information</h4>
</div>
</div>
</div>
<p>NTFS implements POSIX-style Hard Links by creating a file with
several Filename Attributes. Each Filename Attribute has its own
details and parent. When a Hard Linked file is deleted, its
filename is removed from the MFT Record. When the last link is
removed, then the file is really deleted.</p>
<p>N.B. All fields, except the parent directory, are only updated
when the filename is changed. Until then, they just become out of
date. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION
Attribute</a>, however, will <span class="strong">always</span> be
kept up-to-date.</p>
<p>N.B. If the file has <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">EAs (Extended Attributes)</a>, then the EA
Field will contain the size of buffer needed.</p>
<p>N.B. If the file is a <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">Reparse Point</a>, then the
Reparse Field will give its type.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_object_id" id="attribute_object_id"></a>Attribute - $OBJECT_ID (0x40)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754415" id="id4754415"></a>Overview</h3>
</div>
</div>
</div>
<p>The Object Id was introduced in Windows 2000. Every MFT Record
is assigned a unique GUID. Additionally, a record may have a Birth
Volume Id, a Birth Object Id and a Domain Id, all of which are
GUIDs.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum size but a maximum of 256 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754440" id="id4754440"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<div class="table"><a name="id4754446" id="id4754446"></a>
<p class="title"><b>Table&nbsp;2.7.&nbsp;Layout of the $OBJECT_ID
(0x40) attribute</b></p>
<table summary="Layout of the $OBJECT_ID (0x40) attribute" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td>0x00</td>
<td>16</td>
<td>GUID Object Id</td>
<td>Unique Id assigned to file</td>
</tr>
<tr>
<td>0x10</td>
<td>16</td>
<td>GUID Birth Volume Id</td>
<td>Volume where file was created</td>
</tr>
<tr>
<td>0x20</td>
<td>16</td>
<td>GUID Birth Object Id</td>
<td>Original Object Id of file</td>
</tr>
<tr>
<td>0x30</td>
<td>16</td>
<td>GUID Domain Id</td>
<td>Domain in which object was created</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754600" id="id4754600"></a>Birth
Volume Id</h4>
</div>
</div>
</div>
<p>Birth Volume Id is the Object Id of the Volume on which the
Object Id was allocated. It never changes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754611" id="id4754611"></a>Birth
Object Id</h4>
</div>
</div>
</div>
<p>Birth Object Id is the first Object Id that was ever assigned to
this MFT Record. I.e. If the Object Id is changed for some reason,
this field will reflect the original value of the Object Id.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754625" id="id4754625"></a>Domain
Id</h4>
</div>
</div>
</div>
<p>Domain Id is currently unused but it is intended to be used in a
network environment where the local machine is part of a Windows
2000 Domain. This may be used in a Windows 2000 Advanced Server
managed domain.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754639" id="id4754639"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754645" id="id4754645"></a>Other
Information</h4>
</div>
</div>
</div>
<p>This Attribute may be just 16 bytes long (the size of one
GUID).</p>
<p>Even if the Birth Volume, Birth Object and Domain Ids are not
used, they may be present, but one or more may be zero.</p>
<p>Need examples where all the fields are used.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_security_descriptor" id="attribute_security_descriptor"></a>Attribute -
$SECURITY_DESCRIPTOR (0x50)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754678" id="id4754678"></a>Overview</h3>
</div>
</div>
</div>
<pre class="programlisting">Standard Attribute Header?
</pre>
<p>The security descriptor can be summarised as:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>A header (may be flags), followed by one or two ACLs and two
SIDs.</p>
</li>
<li>
<p>The first ACL contains auditing information and may be
absent.</p>
</li>
<li>
<p>The second ACL contains permissions (who can do what).</p>
</li>
<li>
<p>Each ACL contains one or many ACEs.</p>
</li>
<li>
<p>Each ACE contains a SID.</p>
</li>
<li>
<p>The last two SIDs show the owner of the object (User and
Group)</p>
</li>
</ul>
</div>
<div class="table"><a name="id4754741" id="id4754741"></a>
<p class="title"><b>Table 2.8. Layout of the $SECURITY_DESCRIPTOR
(0x50) attribute</b></p>
<table summary="Layout of the $SECURITY_DESCRIPTOR (0x50) attribute" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th colspan="3">Component</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td colspan="3">Header</td>
<td>Offsets to various structures</td>
</tr>
<tr>
<td>Audit ACL</td>
<td>ACE</td>
<td>SID</td>
<td>ACEs for the Audit ACL</td>
</tr>
<tr>
<td rowspan="3">Permissions ACL</td>
<td>ACE</td>
<td>SID</td>
<td rowspan="3">ACEs for the Permissions ACL</td>
</tr>
<tr>
<td>ACE</td>
<td>SID</td>
</tr>
<tr>
<td>ACE</td>
<td>SID</td>
</tr>
<tr>
<td colspan="3">SID (User)</td>
<td rowspan="2">The owner of this object</td>
</tr>
<tr>
<td colspan="3">SID (Group)</td>
</tr>
</tbody>
</table>
</div>
<p>The security descriptor is necessary to prevent unauthorised
access to files. It stores information about:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>The owner of the file</p>
</li>
<li>
<p>Permissions the owner has granted to other users</p>
</li>
<li>
<p>What actions should be logged (auditing)</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754930" id="id4754930"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754936" id="id4754936"></a>Notes</h4>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4754942" id="id4754942"></a>Size</h5>
</div>
</div>
</div>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum or maximum size.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4754962" id="id4754962"></a>Layout of
the stream</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4754968" id="id4754968"></a>Questions</h4>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>How are the ACEs of directories inherited?</p>
</li>
<li>
<p>How can we fit the ACEs into a normal looking Unix file
system?</p>
</li>
<li>
<p>How can we tie the file permissions into PAM or SMB?</p>
</li>
<li>
<p>Can we use NT authentication, somehow?</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4755008" id="id4755008"></a>To Do</h4>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Decide which Standard, and Specific, Rights relate to which
filesystem activities, e.g. FILE_APPEND_DATA will allow a user to
extend a file, but <span class="strong">not</span> create one.</p>
</li>
<li>
<p>Experiment to see if the zeros we see <span class="strong">are</span> padding and that the flag-like fields are
flags.</p>
</li>
<li>
<p>Experiment with the Generic Read / Write / Execute / All
flags.</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4755054" id="id4755054"></a>Header</h4>
</div>
</div>
</div>
<div class="table"><a name="id4755060" id="id4755060"></a>
<p class="title"><b>Table&nbsp;2.9.&nbsp;Layout of the
$SECURITY_DESCRIPTOR (0x50) attribute header</b></p>
<table summary="Layout of the $SECURITY_DESCRIPTOR (0x50) attribute header" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>1</td>
<td>Revision (a)</td>
</tr>
<tr>
<td>0x01</td>
<td>1</td>
<td>Padding</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>Control Flags (b)</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Offset to User SID</td>
</tr>
<tr>
<td>0x08</td>
<td>4</td>
<td>Offset to Group SID</td>
</tr>
<tr>
<td>0x0C</td>
<td>4</td>
<td>Offset to SACL</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td>Offset to DACL</td>
</tr>
</tbody>
</table>
</div>
<p>(a) 0x1 for now</p>
<p>(b) Usually 0x4 (DACL Present), or 0x14 (DACL Present + SACL
Present). See Flags below.</p>
<p>(c) This refers to the Auditing ACL</p>
<p>(d) This refers to the Permissions ACL</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4755218" id="id4755218"></a>ACL</h3>
</div>
</div>
</div>
<div class="table"><a name="id4755223" id="id4755223"></a>
<p class="title"><b>Table&nbsp;2.10.&nbsp;Layout of an ACL</b></p>
<table summary="Layout of an ACL" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>1</td>
<td>ACL Revision</td>
</tr>
<tr>
<td>0x01</td>
<td>1</td>
<td>Padding (0x00)</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>ACL size</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>ACE count</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Padding (0x0000)</td>
</tr>
</tbody>
</table>
</div>
<p>The Access Control List (ACL) contains one or many ACEs.</p>
<p>The ACL revision is currently 0x02, on my machine.</p>
<p>The Win32 APIs suggest that 0x01 and 0x06 contain padding 0x00's
for alignment purposes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4755350" id="id4755350"></a>ACE</h3>
</div>
</div>
</div>
<div class="table"><a name="id4755355" id="id4755355"></a>
<p class="title"><b>Table&nbsp;2.11.&nbsp;Layout of an ACE</b></p>
<table summary="Layout of an ACE" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>1</td>
<td>Type</td>
</tr>
<tr>
<td>0x01</td>
<td>1</td>
<td>Flags</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>Size</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Access mask</td>
</tr>
<tr>
<td>0x08</td>
<td>V</td>
<td>SID</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4755467" id="id4755467"></a>Types</h4>
</div>
</div>
</div>
<p>The currently implemented (in NT) Types are:</p>
<div class="table"><a name="id4755476" id="id4755476"></a>
<p class="title"><b>Table&nbsp;2.12.&nbsp;ACE types</b></p>
<table summary="ACE types" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>Access Allowed</td>
</tr>
<tr>
<td>0x01</td>
<td>Access Denied</td>
</tr>
<tr>
<td>0x02</td>
<td>System Audit</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4755546" id="id4755546"></a>Flags</h4>
</div>
</div>
</div>
<p>Flags is a bit field. The possible values of Flags depend on the
value of Type. When applied to a directory, Access Allowed or
Access Denied can have flags of</p>
<div class="table"><a name="id4755557" id="id4755557"></a>
<p class="title"><b>Table&nbsp;2.13.&nbsp;ACE flags</b></p>
<table summary="ACE flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>Object inherits ACE</td>
</tr>
<tr>
<td>0x02</td>
<td>Container inherits ACE</td>
</tr>
<tr>
<td>0x04</td>
<td>Don't propagate 'Inherit ACE'</td>
</tr>
<tr>
<td>0x08</td>
<td>Inherit only ACE</td>
</tr>
</tbody>
</table>
</div>
<p>If the Type is System Audit, then the flags can be</p>
<div class="table"><a name="id4755640" id="id4755640"></a>
<p class="title"><b>Table&nbsp;2.14.&nbsp;ACE audit flags</b></p>
<table summary="ACE audit flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x40</td>
<td>Audit on Success</td>
</tr>
<tr>
<td>0x80</td>
<td>Audit on Failure</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4755699" id="id4755699"></a>Access
Mask / Access Rights</h4>
</div>
</div>
</div>
<p>The Access Mask / Rights is a bit field enumerating all the
(dis)allowed actions.</p>
<div class="table"><a name="id4755709" id="id4755709"></a>
<p class="title"><b>Table&nbsp;2.15.&nbsp;ACE access mask</b></p>
<table summary="ACE access mask" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Bit(Range)</th>
<th>Meaning</th>
<th>Description / Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>0 - 15</td>
<td>Object Specific Access Rights</td>
<td>Read data, Execute, Append data</td>
</tr>
<tr>
<td>16 - 22</td>
<td>Standard Access Rights</td>
<td>Delete, Write ACL, Write Owner</td>
</tr>
<tr>
<td>23</td>
<td>Can access security ACL</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>24 - 27</td>
<td>Reserved</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>28</td>
<td>Generic ALL (Read, Write, Execute)</td>
<td>Everything below</td>
</tr>
<tr>
<td>29</td>
<td>Generic Execute</td>
<td>All things necessary to execute a program</td>
</tr>
<tr>
<td>30</td>
<td>Generic Write</td>
<td>All things necessary to write to a file</td>
</tr>
<tr>
<td>31</td>
<td>Generic Read</td>
<td>All things necessary to read a file</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4755872" id="id4755872"></a>SID
(Security Identifier)</h3>
</div>
</div>
</div>
<p>A typical SID looks like:
S-1-5-21-646518322-1873620750-619646970-1110</p>
<p>It's composed of 'S-p-q-r-s-t-u-v'</p>
<div class="table"><a name="id4755886" id="id4755886"></a>
<p class="title"><b>Table&nbsp;2.16.&nbsp;SID contents</b></p>
<table summary="SID contents" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>S</th>
<th>Security</th>
</tr>
</thead>
<tbody>
<tr>
<td>p</td>
<td>Revision number (currently 1)</td>
</tr>
<tr>
<td>q</td>
<td>NT Authority. This number is divided into 6 bytes (48 bit
big-endian number).</td>
</tr>
<tr>
<td>r-v</td>
<td>NT Sub-authorities (there can be many of these)</td>
</tr>
</tbody>
</table>
</div>
<p>On disk the SID is stored as follows:</p>
<p>in dec: S-1-5-21-646518322-1873620750-619646970-1110</p>
<p>in hex: S-1-5-15-26891632-6fad2f0e-24ef0ffa-456 (5
Sub-authorities)</p>
<div class="table"><a name="id4755972" id="id4755972"></a>
<p class="title"><b>Table&nbsp;2.17.&nbsp;SID example</b></p>
<table summary="SID example" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col></colgroup>
<tbody>
<tr>
<td>0x00</td>
<td>01</td>
<td>05</td>
<td>00</td>
<td>00</td>
<td>00</td>
<td>00</td>
<td>00</td>
<td>05</td>
</tr>
<tr>
<td>0x08</td>
<td>15</td>
<td>00</td>
<td>00</td>
<td>00</td>
<td>32</td>
<td>16</td>
<td>89</td>
<td>26</td>
</tr>
<tr>
<td>0x10</td>
<td>0e</td>
<td>2f</td>
<td>ad</td>
<td>6f</td>
<td>fa</td>
<td>0f</td>
<td>ef</td>
<td>24</td>
</tr>
<tr>
<td>0x18</td>
<td>56</td>
<td>04</td>
<td>00</td>
<td>00</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
</tbody>
</table>
</div>
<p>NB This is a variable length structure. The could have been
more, or fewer, sub-authorities making the structure larger, or
smaller.</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4756156" id="id4756156"></a>Security
Descriptor Control Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4756162" id="id4756162"></a>
<p class="title"><b>Table&nbsp;2.18.&nbsp;Security Descriptor
Control Flags</b></p>
<table summary="Security Descriptor Control Flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>Owner Defaulted</td>
</tr>
<tr>
<td>0x0002</td>
<td>Group Defaulted</td>
</tr>
<tr>
<td>0x0004</td>
<td>DACL Present</td>
</tr>
<tr>
<td>0x0008</td>
<td>DACL Defaulted</td>
</tr>
<tr>
<td>0x0010</td>
<td>SACL Present</td>
</tr>
<tr>
<td>0x0020</td>
<td>SACL Defaulted</td>
</tr>
<tr>
<td>0x0100</td>
<td>DACL Auto Inherit Req</td>
</tr>
<tr>
<td>0x0200</td>
<td>SACL Auto Inherit Req</td>
</tr>
<tr>
<td>0x0400</td>
<td>DACL Auto Inherited</td>
</tr>
<tr>
<td>0x0800</td>
<td>SACL Auto Inherited</td>
</tr>
<tr>
<td>0x1000</td>
<td>DACL Protected</td>
</tr>
<tr>
<td>0x2000</td>
<td>SACL Protected</td>
</tr>
<tr>
<td>0x4000</td>
<td>RM Control Valid</td>
</tr>
<tr>
<td>0x8000</td>
<td>Self Relative</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756344" id="id4756344"></a>OWNER
DEFAULTED</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the SID pointed to
by the Owner field was provided by a defaulting mechanism rather
than explicitly provided by the original provider of the security
descriptor. This may affect the treatment of the SID with respect
to inheritence of an owner.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756358" id="id4756358"></a>GROUP
DEFAULTED</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the SID in the Group
field was provided by a defaulting mechanism rather than explicitly
provided by the original provider of the security descriptor. This
may affect the treatment of the SID with respect to inheritence of
a primary group.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756373" id="id4756373"></a>DACL
PRESENT</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the security
descriptor contains a discretionary ACL. If this flag is set and
the Dacl field of the SECURITY DESCRIPTOR is null, then a null ACL
is explicitly being specified.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756387" id="id4756387"></a>DACL
DEFAULTED</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the ACL pointed to
by the Dacl field was provided by a defaulting mechanism rather
than explicitly provided by the original provider of the security
descriptor. This may affect the treatment of the ACL with respect
to inheritence of an ACL. This flag is ignored if the DaclPresent
flag is not set.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756403" id="id4756403"></a>SACL
PRESENT</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the security
descriptor contains a system ACL pointed to by the Sacl field. If
this flag is set and the Sacl field of the SECURITY DESCRIPTOR is
null, then an empty (but present) ACL is being specified.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756417" id="id4756417"></a>SACL
DEFAULTED</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the ACL pointed to
by the Sacl field was provided by a defaulting mechanism rather
than explicitly provided by the original provider of the security
descriptor. This may affect the treatment of the ACL with respect
to inheritence of an ACL. This flag is ignored if the SaclPresent
flag is not set.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4756433" id="id4756433"></a>SELF
RELATIVE</h5>
</div>
</div>
</div>
<p>This boolean flag, when set, indicates that the security
descriptor is in self-relative form. In this form, all fields of
the security descriptor are contiguous in memory and all pointer
fields are expressed as offsets from the beginning of the security
descriptor.</p>
<pre class="programlisting">    The SID structure is a variable-length structure used to uniquely identify
    users or groups. SID stands for security identifier.

    The standard textual representation of the SID is of the form:
        S-R-I-S-S...
    Where:
       - The first "S" is the literal character 'S' identifying the following
        digits as a SID.
       - R is the revision level of the SID expressed as a sequence of digits
     either in decimal or hexadecimal (if the later, prefixed by "0x").
       - I is the 48-bit identifier_authority, expressed as digits as R above.
       - S... is one or more sub_authority values, expressed as digits as above.

    Example SID; the domain-relative SID of the local Administrators group on
    Windows NT/2k:
        S-1-5-32-544

    This translates to a SID with:
        revision = 1,
        sub_authority_count = 2,
        identifier_authority = {0,0,0,0,0,5},   SECURITY_NT_AUTHORITY
        sub_authority[0] = 32,                  SECURITY_BUILTIN_DOMAIN_RID
        sub_authority[1] = 544                  DOMAIN_ALIAS_RID_ADMINS

    ACE Types
    ACCESS_MIN_MS_ACE_TYPE           = 0
    ACCESS_ALLOWED_ACE_TYPE          = 0
    ACCESS_DENIED_ACE_TYPE           = 1
    SYSTEM_AUDIT_ACE_TYPE            = 2
    SYSTEM_ALARM_ACE_TYPE            = 3 Not implemented as of Win2k.
    ACCESS_MAX_MS_V2_ACE_TYPE        = 3

    ACCESS_ALLOWED_COMPOUND_ACE_TYPE = 4
    ACCESS_MAX_MS_V3_ACE_TYPE        = 4

    The following are Win2k only.
    ACCESS_MIN_MS_OBJECT_ACE_TYPE    = 5
    ACCESS_ALLOWED_OBJECT_ACE_TYPE   = 5
    ACCESS_DENIED_OBJECT_ACE_TYPE    = 6
    SYSTEM_AUDIT_OBJECT_ACE_TYPE     = 7
    SYSTEM_ALARM_OBJECT_ACE_TYPE     = 8
    ACCESS_MAX_MS_OBJECT_ACE_TYPE    = 8

    ACCESS_MAX_MS_V4_ACE_TYPE        = 8

    This one is for WinNT&amp;2k.
    ACCESS_MAX_MS_ACE_TYPE           = 8

    The ACE flags (8-bit) for audit and inheritance

    SUCCESSFUL_ACCESS_ACE_FLAG is only used with system audit and alarm ACE
    types to indicate that a message is generated (in Windows!) for successful
    accesses.

    FAILED_ACCESS_ACE_FLAG is only used with system audit and alarm ACE types
    to indicate that a message is generated (in Windows!) for failed accesses.

    The inheritance flags.
    OBJECT_INHERIT_ACE           = 0x01
    CONTAINER_INHERIT_ACE        = 0x02
    NO_PROPAGATE_INHERIT_ACE     = 0x04
    INHERIT_ONLY_ACE             = 0x08
    INHERITED_ACE                = 0x10  Win2k only
    VALID_INHERIT_FLAGS          = 0x1f

    The audit flags.
    SUCCESSFUL_ACCESS_ACE_FLAG   = 0x40
    FAILED_ACCESS_ACE_FLAG       = 0x80

    The access mask defines the access rights.

    The standard rights.
    DELETE                   = 0x00010000
    READ_CONTROL             = 0x00020000
    WRITE_DAC                = 0x00040000
    WRITE_OWNER              = 0x00080000
    SYNCHRONIZE              = 0x00100000

    STANDARD_RIGHTS_REQUIRED = 0x000f0000

    STANDARD_RIGHTS_READ     = 0x00020000
    STANDARD_RIGHTS_WRITE    = 0x00020000
    STANDARD_RIGHTS_EXECUTE  = 0x00020000

    STANDARD_RIGHTS_ALL      = 0x001f0000

    The access system ACL and maximum allowed access types.
    ACCESS_SYSTEM_SECURITY   = 0x01000000
    MAXIMUM_ALLOWED          = 0x02000000

    The generic rights.
    GENERIC_ALL              = 0x10000000
    GENERIC_EXECUTE          = 0x20000000
    GENERIC_WRITE            = 0x40000000
    GENERIC_READ             = 0x80000000

    The object ACE flags (32-bit).
    ACE_OBJECT_TYPE_PRESENT            = 1
    ACE_INHERITED_OBJECT_TYPE_PRESENT  = 2

    ACL_CONSTANTS
    Current revision.
    ACL_REVISION         = 2
    ACL_REVISION_DS      = 4

    History of revisions.
    ACL_REVISION1        = 1
    MIN_ACL_REVISION     = 2
    ACL_REVISION2        = 2
    ACL_REVISION3        = 3
    ACL_REVISION4        = 4
    MAX_ACL_REVISION     = 4

   Absolute security descriptor. Does not contain the owner and group SIDs, nor
   the sacl and dacl ACLs inside the security descriptor. Instead, it contains
   pointers to these structures in memory. Obviously, absolute security
   descriptors are only useful for in memory representations of security
   descriptors. On disk, a self-relative security descriptor is used.

   Attribute: Security descriptor (0x50). A standard self-relative security
   descriptor.

   NOTE: Always resident.
   NOTE: Not used in NTFS 3.0+, as security descriptors are stored centrally
   in FILE_$Secure and the correct descriptor is found using the security_id
   from the standard information attribute.

   On NTFS 3.0+, all security descriptors are stored in FILE_$Secure. Only one
   referenced instance of each unique security descriptor is stored.

   FILE_$Secure contains no unnamed data attribute, i.e. it has zero length. It
   does, however, contain two indexes ($SDH and $SII) as well as a named data
   stream ($SDS).

   Every unique security descriptor is assigned a unique security identifier
   (security_id, not to be confused with a SID). The security_id is unique for
   the NTFS volume and is used as an index into the $SII index, which maps
   security_ids to the security descriptor's storage location within the $SDS
   data attribute. The $SII index is sorted by ascending security_id.

   A simple hash is computed from each security descriptor. This hash is used
   as an index into the $SDH index, which maps security descriptor hashes to
   the security descriptor's storage location within the $SDS data attribute.
   The $SDH index is sorted by security descriptor hash and is stored in a B+
   tree. When searching $SDH (with the intent of determining whether or not a
   new security descriptor is already present in the $SDS data stream), if a
   matching hash is found, but the security descriptors do not match, the
   search in the $SDH index is continued, searching for a next matching hash.

   When a precise match is found, the security_id coresponding to the security
   descriptor in the $SDS attribute is read from the found $SDH index entry and
   is stored in the $STANDARD_INFORMATION attribute of the file/directory to
   which the security descriptor is being applied. The $STANDARD_INFORMATION
   attribute is present in all base mft records (i.e. in all files and
   directories).

   If a match is not found, the security descriptor is assigned a new unique
   security_id and is added to the $SDS data attribute. Then, entries
   referencing the this security descriptor in the $SDS data attribute are
   added to the $SDH and $SII indexes.

   Note: Entries are never deleted from FILE_$Secure, even if nothing
   references an entry any more.

   The $SDS data stream contains the security descriptors, aligned on 16-byte
   boundaries, sorted by security_id in a B+ tree. Security descriptors cannot
   cross 256kib boundaries (this restriction is imposed by the Windows cache
   manager). Each security descriptor is contained in a SDS_ENTRY structure.
   Also, each security descriptor is stored twice in the $SDS stream with a
   fixed offset of 0x40000 bytes (256kib, the Windows cache manager's max size)
   between them; i.e. if a SDS_ENTRY specifies an offset of 0x51d0, then the
   the first copy of the security descriptor will be at offset 0x51d0 in the
   $SDS data stream and the second copy will be at offset 0x451d0.

   $SII index. The collation type is COLLATION_NTOFS_ULONG.
   $SDH index. The collation rule is COLLATION_NTOFS_SECURITY_HASH.
                                        
</pre></div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_volume_name" id="attribute_volume_name"></a>Attribute -
$VOLUME_NAME (0x60)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4756466" id="id4756466"></a>Overview</h3>
</div>
</div>
</div>
<p>This attribute simply contains the name of the volume.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a
minimum size of 2 bytes and a maximum of 256 bytes. This equates to
a maximum volume name length of 127 Unicode characters.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4756490" id="id4756490"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<div class="table"><a name="id4756496" id="id4756496"></a>
<p class="title"><b>Table&nbsp;2.19.&nbsp;Layout of the
$VOLUME_NAME (0x60) attribute</b></p>
<table summary="Layout of the $VOLUME_NAME (0x60) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>&nbsp;</td>
<td>Unicode name</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4756829" id="id4756829"></a>Notes</h3>
</div>
</div>
</div>
<p>The Volume Name is <span class="strong">not</span> terminated
with a Unicode NULL. Its name's length is the size of the attribute
as stored in the header.</p>
<p>A Volume's Serial Number is stored in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a>.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_volume_information" id="attribute_volume_information"></a>Attribute - $VOLUME_INFORMATION
(0x70)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4756871" id="id4756871"></a>Overview</h3>
</div>
</div>
</div>
<p>Indicates the version and the state of the volume.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a
minimum and a maximum size of 12 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4756893" id="id4756893"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<div class="table"><a name="id4756898" id="id4756898"></a>
<p class="title"><b>Table&nbsp;2.20.&nbsp;Layout of the
$VOLUME_INFORMATION (0x70) attribute</b></p>
<table summary="Layout of the $VOLUME_INFORMATION (0x70) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>8</td>
<td>Always zero?</td>
</tr>
<tr>
<td>0x08</td>
<td>1</td>
<td>Major version number</td>
</tr>
<tr>
<td>0x09</td>
<td>1</td>
<td>Minor version number</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0C</td>
<td>4</td>
<td>Always zero?</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757032" id="id4757032"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4757038" id="id4757038"></a>
<p class="title"><b>Table&nbsp;2.21.&nbsp;Volume Flags</b></p>
<table summary="Volume Flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>Dirty</td>
</tr>
<tr>
<td>0x0002</td>
<td>Resize LogFile</td>
</tr>
<tr>
<td>0x0004</td>
<td>Upgrade on Mount</td>
</tr>
<tr>
<td>0x0008</td>
<td>Mounted on NT4</td>
</tr>
<tr>
<td>0x0010</td>
<td>Delete USN underway</td>
</tr>
<tr>
<td>0x0020</td>
<td>Repair Object Ids</td>
</tr>
<tr>
<td>0x8000</td>
<td>Modified by chkdsk</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4757149" id="id4757149"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757154" id="id4757154"></a>Dirty
Flag</h4>
</div>
</div>
</div>
<p>When the Dirty Flag is set, Windows NT must perform the chkdsk/F
command on the volume when it next boots.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757166" id="id4757166"></a>Version
numbers</h4>
</div>
</div>
</div>
<div class="table"><a name="id4757172" id="id4757172"></a>
<p class="title"><b>Table&nbsp;2.22.&nbsp;Volume Version
Numbers</b></p>
<table summary="Volume Version Numbers" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Operating System</th>
<th>Version</th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows NT</td>
<td>1.2</td>
</tr>
<tr>
<td>Windows 2000</td>
<td>3.0</td>
</tr>
<tr>
<td>Windows XP</td>
<td>3.1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757240" id="id4757240"></a>Other
Information</h4>
</div>
</div>
</div>
<p>A Volume's Serial Number is stored in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a>.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_data" id="attribute_data"></a>Attribute - $DATA (0x80)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4757270" id="id4757270"></a>Overview</h3>
</div>
</div>
</div>
<p>This Attribute contains the file's data. A file's size is the
size of its unnamed Data Stream.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum or maximum size.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4757293" id="id4757293"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<div class="table"><a name="id4757298" id="id4757298"></a>
<p class="title"><b>Table&nbsp;2.23.&nbsp;Layout of the $DATA
(0x80) attribute</b></p>
<table summary="Layout of the $DATA (0x80) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>&nbsp;</td>
<td>Any data</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4757378" id="id4757378"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757383" id="id4757383"></a>Common
Data Stream Used By Windows</h4>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_data" title="Data">[Unnamed]</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_summary_information" title="Summary Information">{4c8cc155-6c1e-11d1-8e41-00c04fb9386d}</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_summary_information" title="Summary Information">^EDocumentSummaryInformation</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_summary_information" title="Summary Information">^ESebiesnrMkudrfcoIaamtykdDa</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_summary_information" title="Summary Information">^ESummaryInformation</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_dot_mountmgrdatabase" title="$MountMgrDatabase Data Stream">$MountMgrDatabase</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_badclus_bad" title="$Bad Data Stream">$Bad</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure_sds" title="$SDS Data Stream">$SDS</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl_j" title="$J Data Stream">$J</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl_max" title="$Max Data Stream">$Max</a></p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757538" id="id4757538"></a>Other
Information</h4>
</div>
</div>
</div>
<p>Usually, a directory has no Data Attribute, and the Data
Attribute of a file has no name.</p>
<pre class="programlisting">    must have (at least empty) unnamed data attr
                                
</pre>
<p>NTFS has an advantage: as you can have several data attributes
for a file, you can easily implement HFS whose files are made of
two parts (also called forks in the HFS terminology): a resource
part and a data part. For the data part, you use default unnamed
data attribute, and for the resource part, you use a data attribute
named e.g. 'resource'.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_index_root" id="attribute_index_root"></a>Attribute -
$INDEX_ROOT (0x90)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4757577" id="id4757577"></a>Overview</h3>
</div>
</div>
</div>
<p>This is the root node of the B+ tree that implements an index
(e.g. a directory). This file attribute is always resident.</p>
<pre class="programlisting">    Always resident.
                        
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4757595" id="id4757595"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<pre class="programlisting">    link up below
                        
</pre>
<p>$INDEX_ROOT</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Standard Attribute Header</p>
</li>
<li>
<p>Index Root</p>
</li>
<li>
<p>Index Header</p>
</li>
<li>
<p>Index Entry</p>
</li>
<li>
<p>Index Entry</p>
</li>
<li>
<p>...</p>
</li>
</ul>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757654" id="id4757654"></a>Index
Root</h4>
</div>
</div>
</div>
<div class="table"><a name="id4757659" id="id4757659"></a>
<p class="title"><b>Table 2.24. Layout of the $INDEX_ROOT (0x90)
attribute: an Index Root</b></p>
<table summary="Layout of the $INDEX_ROOT (0x90) attribute: an Index Root" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>4</td>
<td>Attribute Type</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Collation Rule</td>
</tr>
<tr>
<td>0x08</td>
<td>4</td>
<td>Size of Index Allocation Entry (bytes)</td>
</tr>
<tr>
<td>0x0C</td>
<td>1</td>
<td>Clusters per Index Record</td>
</tr>
<tr>
<td>0x0D</td>
<td>3</td>
<td>Padding (Align to 8 bytes)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757802" id="id4757802"></a>Index
Header</h4>
</div>
</div>
</div>
<div class="table"><a name="id4757808" id="id4757808"></a>
<p class="title"><b>Table 2.25. Layout of the $INDEX_ROOT (0x90)
attribute: an Index Header</b></p>
<table summary="Layout of the $INDEX_ROOT (0x90) attribute: an Index Header" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>Offset to first Index Entry</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Total size of the Index Entries</td>
</tr>
<tr>
<td>0x08</td>
<td>4</td>
<td>Allocated size of the Index Entries</td>
</tr>
<tr>
<td>0x0C</td>
<td>1</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0D</td>
<td>3</td>
<td>Padding (align to 8 bytes)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4757929" id="id4757929"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4757934" id="id4757934"></a>
<p class="title"><b>Table 2.26. Index flags</b></p>
<table summary="Index flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>Small Index (fits in Index Root)</td>
</tr>
<tr>
<td>0x01</td>
<td>Large index (Index Allocation needed)</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">    silly to have a flag of 0x00, remove
                                
</pre>
<p>The large index flag indicates whether the file attributes index
allocation and bitmap are present (when the index is small enough
to be stored completely in the root node, these two file attributes
are missing).</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4758008" id="id4758008"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4758014" id="id4758014"></a>Size</h4>
</div>
</div>
</div>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum or maximum size.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4758032" id="id4758032"></a>Sequence
of index entries</h4>
</div>
</div>
</div>
<p>This is a sequence of index entries that has a variable length.
The sequence is terminated with a special index entry whose last
entry flag is set.</p>
<pre class="programlisting">    This is the header for indexes, describing the INDEX_ENTRY records, which
    follow the INDEX_HEADER. Together the index header and the index entries
    make up a complete index.

    This is followed by a sequence of index entries (INDEX_ENTRY structures)
    as described by the index header.

    When a directory is small enough to fit inside the index root then this
    is the only attribute describing the directory. When the directory is too
    large to fit in the index root, on the other hand, two aditional attributes
    are present: an index allocation attribute, containing sub-nodes of the B+
    directory tree (see below), and a bitmap attribute, describing which virtual
    cluster numbers (vcns) in the index allocation attribute are in use by an
    index block.

    NOTE: The root directory (FILE_$root) contains an entry for itself.

    struct {
            ATTR_TYPES type;
            Type of the indexed attribute. Is $FILENAME for directories, zero
            for view indexes. No other values allowed.
            COLLATION_RULES collation_rule;        Collation rule used to sort the
            index entries. If type is $FILENAME, this must be COLLATION_FILENAME.

            __u32 bytes_per_index_block;
            Byte size of each index block (in the index allocation attribute).

            __u8 clusters_per_index_block;
            Cluster size of each index block (in the index allocation attribute), when
            an index block is &gt;= than a cluster, otherwise this will be the log of
            the size (like how the encoding of the mft record size and the index
            record size found in the boot sector work). Has to be a power of 2.
    }  INDEX_ROOT;
                                
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4758101" id="id4758101"></a>List of
Common Indexes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4758107" id="id4758107"></a>
<p class="title"><b>Table&nbsp;2.27.&nbsp;Common Indexes</b></p>
<table summary="Common Indexes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Name</th>
<th>Index Of</th>
<th>Used By</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_i30">$I30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">Filenames</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">Directories</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sdh">$SDH</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">Security
Descriptors</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$Secure</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sii">$SII</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">Security
Ids</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$Secure</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_o">$O</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">Object
Ids</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">$ObjId</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_o">$O</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">Owner Ids</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_q">$Q</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">Quotas</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_r">$R</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">Reparse Points</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse" title="NTFS Files: $Reparse (Any)">$Reparse</a></td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">    which elements are shared between indexes?
    not relevant for index root
                        
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_index_allocation" id="attribute_index_allocation"></a>Attribute - $INDEX_ALLOCATION
(0xA0)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4758414" id="id4758414"></a>Overview</h3>
</div>
</div>
</div>
<p>This is the basic component of an index (e.g. a directory). This
is the storage location for all sub-nodes of the B+ tree that
implements an index (e.g. a directory). This file attribute is
always non-resident.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum or maximum size.</p>
<pre class="programlisting">    this attribute is never resident - would use index root instead
                        
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4758445" id="id4758445"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<p>It is simply a sequence of all index buffers that belong to the
index.</p>
<div class="table"><a name="id4758456" id="id4758456"></a>
<p class="title"><b>Table&nbsp;2.28.&nbsp;Layout of the
$INDEX_ALLOCATION (0xA0) attribute</b></p>
<table summary="Layout of the $INDEX_ALLOCATION (0xA0) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>...</td>
<td>Data runs</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4758535" id="id4758535"></a>Index
Entry</h4>
</div>
</div>
</div>
<pre class="programlisting">    split into two tables, at least
                                
</pre>
<div class="table"><a name="id4758547" id="id4758547"></a>
<p class="title"><b>Table 2.29. Layout of a data entry in the
$INDEX_ALLOCATION (0xA0) attribute</b></p>
<table summary="Layout of a data entry in the $INDEX_ALLOCATION (0xA0) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td colspan="3">The next field is only valid when the last entry
flag is not set</td>
</tr>
<tr>
<td>0x00</td>
<td>8</td>
<td>File reference</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>L = Length of the index entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>M = Length of the stream</td>
</tr>
<tr>
<td>0x0C</td>
<td>1</td>
<td>Flags</td>
</tr>
<tr>
<td colspan="3">The next field is only present when the last entry
flag is not set</td>
</tr>
<tr>
<td>0x10</td>
<td>M</td>
<td>Stream</td>
</tr>
<tr>
<td colspan="3">The next field is only present when the sub-node
flag is set</td>
</tr>
<tr>
<td>L - 8</td>
<td>8</td>
<td>VCN of the sub-node in the index allocation attribute</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4758740" id="id4758740"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4758745" id="id4758745"></a>
<p class="title"><b>Table&nbsp;2.30.&nbsp;Data entry flags</b></p>
<table summary="Data entry flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>Index entry points to a sub-node</td>
</tr>
<tr>
<td>0x02</td>
<td>Last index entry in the node</td>
</tr>
</tbody>
</table>
</div>
<p>The last entry flag is used to indicate the end of a sequence of
index entries. Although it does not represent a valid file, it can
point to a sub-node.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4758812" id="id4758812"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4758817" id="id4758817"></a>Length of
the stream</h4>
</div>
</div>
</div>
<p>A copy of the field at offset 10 in the header part of the
resident file attribute indexed by the index entry. But why the
hell haven't these 2 fields the same size?</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4758830" id="id4758830"></a>Stream</h4>
</div>
</div>
</div>
<p>A copy of the stream of the resident file attribute indexed by
the index entry (e.g. for a directory, the file name
attribute).</p>
<pre class="programlisting">    Always non-resident (doesn't make sense to be resident anyway!).

    This is an array of index blocks. Each index block starts with an
    INDEX_BLOCK structure containing an index header, followed by a sequence of
    index entries (INDEX_ENTRY structures), as described by the INDEX_HEADER.

    When creating the index block, we place the update sequence array at this
    offset, i.e. before we start with the index entries. This also makes sense,
    otherwise we could run into problems with the update sequence array
    containing in itself the last two bytes of a sector which would mean that
    multi sector transfer protection wouldn't work. As you can't protect data
    by overwriting it since you then can't get it back...
    When reading use the data from the ntfs record header.
                                
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_bitmap" id="attribute_bitmap"></a>Attribute - $BITMAP (0xB0)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4751993" id="id4751993"></a>Overview</h3>
</div>
</div>
</div>
<p>This file attribute is a sequence of bits, each of which
represents the status of an entity.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum or maximum size.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4752016" id="id4752016"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<p>This attribute is currently used in two places: indexes (e.g.
directories), $MFT. N.B. The index entries and the FILE records
also have flags in them to show if they are in use or not.</p>
<p>In an index, the bit field shows which index entries are in use.
Each bit represents one VCN of the index allocation.</p>
<p>In the $MFT, the bit field shows which FILE records are in
use.</p>
<div class="table"><a name="id4752038" id="id4752038"></a>
<p class="title"><b>Table&nbsp;2.31.&nbsp;Layout of the $BITMAP
(0xB0) attribute</b></p>
<table summary="Layout of the $BITMAP (0xB0) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>&nbsp;</td>
<td>Bit field</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_reparse_point" id="attribute_reparse_point"></a>Attribute - $REPARSE_POINT
(0xC0)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4759145" id="id4759145"></a>Overview</h3>
</div>
</div>
</div>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum size but a maximum of 16384 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4759164" id="id4759164"></a>Layout of
the Attribute (Microsoft Reparse Point)</h3>
</div>
</div>
</div>
<div class="table"><a name="id4759170" id="id4759170"></a>
<p class="title"><b>Table&nbsp;2.32.&nbsp;Layout of the
$REPARSE_POINT (0xC0) attribute (Microsoft Reparse Point)</b></p>
<table summary="Layout of the $REPARSE_POINT (0xC0) attribute (Microsoft Reparse Point)" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>4</td>
<td>Reparse Type (and Flags)</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Reparse Data Length</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Padding (align to 8 bytes)</td>
</tr>
<tr>
<td>0x08</td>
<td>V</td>
<td>Reparse Data (a)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4759291" id="id4759291"></a>Layout of
the Attribute (Third-Party Reparse Point)</h3>
</div>
</div>
</div>
<div class="table"><a name="id4759298" id="id4759298"></a>
<p class="title"><b>Table&nbsp;2.33.&nbsp;Layout of the
$REPARSE_POINT (0xC0) attribute (Third-Party Reparse Point)</b></p>
<table summary="Layout of the $REPARSE_POINT (0xC0) attribute (Third-Party Reparse Point)" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>4</td>
<td>Reparse Type (and Flags)</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Reparse Data Length</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Padding (align to 8 bytes)</td>
</tr>
<tr>
<td>0x08</td>
<td>16</td>
<td>Reparse GUID</td>
</tr>
<tr>
<td>0x18</td>
<td>V</td>
<td>Reparse Data (a)</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">(a) The structure of the Reparse Data depends on the Reparse Type. There are
    three defined Reparse Data (SymLinks, VolLinks and RSS) + the Generic Reparse. 
</pre>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4759440" id="id4759440"></a>Symbolic
Link Reparse Data</h4>
</div>
</div>
</div>
<div class="table"><a name="id4759446" id="id4759446"></a>
<p class="title"><b>Table 2.34. Symbolic Link Reparse Data</b></p>
<table summary="Symbolic Link Reparse Data" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>2</td>
<td>Substitute Name Offset</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>Substitute Name Length</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Print Name Offset</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>Print Name Length</td>
</tr>
<tr>
<td>0x10</td>
<td>V</td>
<td>Path Buffer</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4759560" id="id4759560"></a>Volume
Link Reparse Data</h4>
</div>
</div>
</div>
<div class="table"><a name="id4759566" id="id4759566"></a>
<p class="title"><b>Table 2.35. Volume Link Reparse Data</b></p>
<table summary="Volume Link Reparse Data" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>2</td>
<td>Substitute Name Offset</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>Substitute Name Length</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Print Name Offset</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>Print Name Length</td>
</tr>
<tr>
<td>0x10</td>
<td>V</td>
<td>Path Buffer</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4759680" id="id4759680"></a>Reparse
Tag Flags</h4>
</div>
</div>
</div>
<pre class="programlisting">These are just the predefined reparse flags
</pre>
<div class="table"><a name="id4759692" id="id4759692"></a>
<p class="title"><b>Table 2.36. Reparse Tag Flags</b></p>
<table summary="Reparse Tag Flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x20000000</td>
<td>Is alias</td>
</tr>
<tr>
<td>0x40000000</td>
<td>Is high latency</td>
</tr>
<tr>
<td>0x80000000</td>
<td>Is Microsoft</td>
</tr>
<tr>
<td>0x68000005</td>
<td>NSS</td>
</tr>
<tr>
<td>0x68000006</td>
<td>NSS recover</td>
</tr>
<tr>
<td>0x68000007</td>
<td>SIS</td>
</tr>
<tr>
<td>0x68000008</td>
<td>DFS</td>
</tr>
<tr>
<td>0x88000003</td>
<td>Mount point</td>
</tr>
<tr>
<td>0xA8000004</td>
<td>HSM</td>
</tr>
<tr>
<td>0xE8000000</td>
<td>Symbolic link</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4759833" id="id4759833"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4759839" id="id4759839"></a>Other
Information</h4>
</div>
</div>
</div>
<pre class="programlisting">    The reparse point tag defines the type of the reparse point. It also
    includes several flags, which further describe the reparse point.

    The reparse point tag is an unsigned 32-bit value divided in three parts:

    1. The least significant 16 bits (i.e. bits 0 to 15) specifiy the type of
       the reparse point.
    2. The 13 bits after this (i.e. bits 16 to 28) are reserved for future use.
    3. The most significant three bits are flags describing the reparse point.
       They are defined as follows:
         bit 29: Name surrogate bit. If set, the filename is an alias for
                 another object in the system.
         bit 30: High-latecny bit. If set, accessing the first byte of data will
                 be slow. (E.g. the data is stored on a tape drive.)
         bit 31: Microsoft bit. If set, the tag is owned by Microsoft. User
                 defined tags have to use zero here.

    The system file FILE_$Extend/$Reparse contains an index named $R listing
    all reparse points on the volume. The index entry keys are as defined
    below. Note, that there is no index data associated with the index entries.

    The index entries are sorted by the index key file_id. The collation rule is
    COLLATION_NTOFS_ULONGS. FIXME: Verify whether the reparse_tag is not the
    primary key / is not a key at all. (AIA)
                                
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_ea_information" id="attribute_ea_information"></a>Attribute - $EA_INFORMATION
(0xD0)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4759886" id="id4759886"></a>Overview</h3>
</div>
</div>
</div>
<p>Used to implement under NTFS the HPFS extended attributes used
by the information subsystem of OS/2 and OS/2 clients of Windows NT
servers. This file attribute may be non-resident because its stream
is likely to grow.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a
minimum and a maximum size of 8 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4759911" id="id4759911"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<div class="table"><a name="id4759917" id="id4759917"></a>
<p class="title"><b>Table&nbsp;2.37.&nbsp;Layout of the
$EA_INFORMATION (0xD0) attribute</b></p>
<table summary="Layout of the $EA_INFORMATION (0xD0) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>Size of the packed Extended Attributes</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>Number of Extended Attributes which have NEED_EA set</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Size of the unpacked Extended Attributes</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_ea" id="attribute_ea"></a>Attribute - $EA (0xE0)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4760042" id="id4760042"></a>Overview</h3>
</div>
</div>
</div>
<p>Used to implement the HPFS extended attribute under NTFS. This
file attribute may be non-resident because its stream is likely to
grow.</p>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum size but a maximum of 65536 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4760066" id="id4760066"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<p>The Extended Attribute is a collection of name, value pairs.</p>
<div class="table"><a name="id4760077" id="id4760077"></a>
<p class="title"><b>Table&nbsp;2.38.&nbsp;Layout of the $EA (0xE0)
attribute</b></p>
<table summary="Layout of the $EA (0xE0) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>4</td>
<td>Offset to next Extended Attribute</td>
</tr>
<tr>
<td>0x04</td>
<td>1</td>
<td>Flags</td>
</tr>
<tr>
<td>0x05</td>
<td>1</td>
<td>Name Length (N)</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Value Length (V)</td>
</tr>
<tr>
<td>0x08</td>
<td>N</td>
<td>Name</td>
</tr>
<tr>
<td>N+0x08</td>
<td>V</td>
<td>Value</td>
</tr>
</tbody>
</table>
</div>
<p>Conversely, the <span class="emphasis"><em>Offset to next
EA</em></span> is the size of this EA.</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4760237" id="id4760237"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4760243" id="id4760243"></a>
<p class="title"><b>Table&nbsp;2.39.&nbsp;EA flags</b></p>
<table summary="EA flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x80</td>
<td>Need EA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4760292" id="id4760292"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4760298" id="id4760298"></a>Other
Information</h4>
</div>
</div>
</div>
<p>What is the role and the layout of the stream of this file
attribute? It could be valuable to have a look at HPFS
documentation.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4760310" id="id4760310"></a>Questions</h4>
</div>
</div>
</div>
<p>Is it true that the EA name is not unicode?</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="attribute_logged_utility_stream" id="attribute_logged_utility_stream"></a>Attribute -
$LOGGED_UTILITY_STREAM (0x100)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4760334" id="id4760334"></a>Overview</h3>
</div>
</div>
</div>
<p>As defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a>, this attribute has a no
minimum size but a maximum of 65536 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4760352" id="id4760352"></a>Layout of
the Attribute</h3>
</div>
</div>
</div>
<pre class="programlisting">As an attribute it's no different to a named data attribute
Contents depend on the name of the $DATA stream
</pre>
<div class="table"><a name="id4760365" id="id4760365"></a>
<p class="title"><b>Table 2.40. Layout of the
$LOGGED_UTILITY_STREAM (0x100) attribute</b></p>
<table summary="Layout of the $LOGGED_UTILITY_STREAM (0x100) attribute" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td> </td>
<td>Any data</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4760444" id="id4760444"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4760450" id="id4760450"></a>Other
Information</h4>
</div>
</div>
</div>
<p>Information needed</p>
<pre class="programlisting">    Operations on this attribute are logged to the journal ($LogFile) like
    normal metadata changes.

    Used by the Encrypting File System (EFS). All encrypted files have this
    attribute with the name $EFS.

    Can be anything the creator chooses.
    EFS uses it as follows:
    FIXME: Type this info, verifying it along the way. (AIA)
                                
</pre></div>
</div>
</div>
</div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="files" id="files"></a>Chapter&nbsp;3.&nbsp;NTFS Files</h2>
</div>
</div>
</div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768976">Overview</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768332">Layout of the
Volume</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769527">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft">NTFS Files: $MFT
(0)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769595">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769613">$MFT
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769779">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4769977">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mftmirr">NTFS Files:
$MFTMirr (1)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770031">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770062">$MFTMirr
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770201">Layout of the
File</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile">NTFS Files:
$LogFile (2)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770384">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770392">$LogFile
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770532">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4770550">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_volume">NTFS Files:
$Volume (3)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768858">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4768869">$Volume
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771319">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771337">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef">NTFS Files:
$AttrDef (4)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771385">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771403">$AttrDef
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771569">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771938">Notes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4771992">Examples</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_dot">NTFS Files: . (Root
Directory) (5)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773289">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773317">Dot (.)
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773566">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773714">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_bitmap">NTFS Files:
$Bitmap (6)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773749">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773761">$Bitmap
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4773900">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774003">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot">NTFS Files: $Boot
(7)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774062">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774086">$Boot
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774252">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774573"></a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774598">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_badclus">NTFS Files:
$BadClus (8)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774641">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774661">$BadClus
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774827">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774861">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure">NTFS Files:
$Secure (9)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4774978">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775032">$Secure
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4775336">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776249">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_upcase">NTFS Files:
$UpCase (10)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776291">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776310">$UpCase
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776449">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776549">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_extend">NTFS Files:
$Extend (11)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776577">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776621">$Extend
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776761">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776779">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid">NTFS Files: $ObjId
(Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776808">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4776834">$ObjId
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777028">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777438">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota">NTFS Files: $Quota
(NT:9, 2K:Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777512">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777528">$Quota
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4777803">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778691">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse">NTFS Files:
$Reparse (Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778764">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778775">$Reparse
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4778969">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779240">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl">NTFS Files:
$UsnJrnl (Any)</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779267">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779278">$UsnJrnl
Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779444">Layout of the
File</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779720"></a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4779848">Notes</a></span></dt>
</dl>
</dd>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="id4768976" id="id4768976"></a>Overview</h2>
</div>
</div>
</div>
<p>Everything on an NTFS volume is a file. There are two
categories: Metadata and Normal. The Metadata files contain
information about the volume and the Normal files contain your
data.</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4768332" id="id4768332"></a>Layout of
the Volume</h3>
</div>
</div>
</div>
<p>Below is a table of files found on a Win2K volume <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#prologue_tables_legend" title="Tables Legend">(Key)</a>.</p>
<div class="table"><a name="id4768350" id="id4768350"></a>
<p class="title"><b>Table&nbsp;3.1.&nbsp;Layout of files on the
Volume</b></p>
<table summary="Layout of files on the Volume" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Inode</th>
<th>Filename</th>
<th>OS</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft" title="NTFS Files: $MFT (0)">$MFT</a></td>
<td>&nbsp;</td>
<td>Master File Table - An index of every file</td>
</tr>
<tr>
<td>1</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mftmirr" title="NTFS Files: $MFTMirr (1)">$MFTMirr</a></td>
<td>&nbsp;</td>
<td>A backup copy of the first 4 records of the MFT</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile" title="NTFS Files: $LogFile (2)">$LogFile</a></td>
<td>&nbsp;</td>
<td>Transactional logging file</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_volume" title="NTFS Files: $Volume (3)">$Volume</a></td>
<td>&nbsp;</td>
<td>Serial number, creation time, dirty flag</td>
</tr>
<tr>
<td>4</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">$AttrDef</a></td>
<td>&nbsp;</td>
<td>Attribute definitions</td>
</tr>
<tr>
<td>5</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_dot" title="NTFS Files: . (Root Directory) (5)">. (dot)</a></td>
<td>&nbsp;</td>
<td>Root directory of the disk</td>
</tr>
<tr>
<td>6</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_bitmap" title="NTFS Files: $Bitmap (6)">$Bitmap</a></td>
<td>&nbsp;</td>
<td>Contains volume's cluster map (in-use vs. free)</td>
</tr>
<tr>
<td>7</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a></td>
<td>&nbsp;</td>
<td>Boot record of the volume</td>
</tr>
<tr>
<td>8</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_badclus" title="NTFS Files: $BadClus (8)">$BadClus</a></td>
<td>&nbsp;</td>
<td>Lists bad clusters on the volume</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a></td>
<td>NT</td>
<td>Quota information</td>
</tr>
<tr>
<td>9</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$Secure</a></td>
<td>2K</td>
<td>Security descriptors used by the volume</td>
</tr>
<tr>
<td>10</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_upcase" title="NTFS Files: $UpCase (10)">$UpCase</a></td>
<td>&nbsp;</td>
<td>Table of uppercase characters used for collating</td>
</tr>
<tr>
<td>11</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_extend" title="NTFS Files: $Extend (11)">$Extend</a></td>
<td>2K</td>
<td>A directory: $ObjId, $Quota, $Reparse, $UsnJrnl</td>
</tr>
<tr>
<td>12-15</td>
<td>&lt;Unused&gt;</td>
<td>&nbsp;</td>
<td>Marked as in use but empty</td>
</tr>
<tr>
<td>16-23</td>
<td>&lt;Unused&gt;</td>
<td>&nbsp;</td>
<td>Marked as unused</td>
</tr>
<tr>
<td>Any</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">$ObjId</a></td>
<td>2K</td>
<td>Unique Ids given to every file</td>
</tr>
<tr>
<td>Any</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a></td>
<td>2K</td>
<td>Quota information</td>
</tr>
<tr>
<td>Any</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse" title="NTFS Files: $Reparse (Any)">$Reparse</a></td>
<td>2K</td>
<td>Reparse point information</td>
</tr>
<tr>
<td>Any</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl" title="NTFS Files: $UsnJrnl (Any)">$UsnJrnl</a></td>
<td>2K</td>
<td>Journalling of Encryption</td>
</tr>
<tr>
<td>&gt;24</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file" title="Concept - File">A_File</a></td>
<td>&nbsp;</td>
<td>An ordinary file</td>
</tr>
<tr>
<td>&gt;24</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">A_Dir</a></td>
<td>&nbsp;</td>
<td>An ordinary directory</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>&nbsp;</td>
<td>...</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4769527" id="id4769527"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4769533" id="id4769533"></a>Unused
Inodes</h4>
</div>
</div>
</div>
<p>On a freshly formatted volume, inodes 0x0B to 0x0F are marked as
in use, but empty. Inodes 0x10 to 0x17 are marked as free and not
used. This doesn't change until the volume is under a lot of
stress.</p>
<p>When the $MFT becomes very fragmented it won't fit into one FILE
Record and an extension record is needed. If a new record was
simply allocated at the end of the $MFT then we encounter a
problem. The $DATA Attribute describing the location of the new
record is in the new record.</p>
<p>The new records are therefore allocated from inode 0x0F,
onwards. The $MFT is always a minimum of 16 FILE Records long,
therefore always exists. After inodes 0x0F to 0x17 are used up,
higher, unreserved, inodes are used.</p>
<p>This effect may not be limited to the $MFT, but more evidence is
needed.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4769566" id="id4769566"></a>Other
Information</h4>
</div>
</div>
</div>
<p>For some reason $ObjId, $Quota, $Reparse and $UsnJrnl don't have
inode numbers below 24, like the rest of the Metadata files.</p>
<p>Also, the sequence number for each of the system files is always
equal to their mft record number and it is never modified.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_mft" id="file_mft"></a>NTFS Files: $MFT (0)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4769595" id="id4769595"></a>Overview</h3>
</div>
</div>
</div>
<p>In NTFS, everything on disk is a file. Even the metadata is
stored as a set of files.</p>
<p>The Master File Table (MFT) is an index of every file on the
volume. For each file, the MFT keeps a set of records called
attributes and each attribute stores a different type of
information.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4769613" id="id4769613"></a>$MFT
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4769618" id="id4769618"></a>
<p class="title"><b>Table&nbsp;3.2.&nbsp;$MFT Attributes</b></p>
<table summary="$MFT Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$MFT</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4769779" id="id4769779"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4769785" id="id4769785"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>The description of each file is packed into <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">FILE
records</a>.</p>
<p>If one record is not large enough (this is unusual), then an
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">$ATTRIBUTE_LIST</a> attribute
is needed.</p>
<p>The first 24 FILE records are reserved for the system files. For
a full list see the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#files" title="Chapter3.NTFS Files">Files page</a>.</p>
<div class="table"><a name="id4769827" id="id4769827"></a>
<p class="title"><b>Table&nbsp;3.3.&nbsp;Sample records from the
beginning of $MFT</b></p>
<table summary="Sample records from the beginning of $MFT" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Inode</th>
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft" title="NTFS Files: $MFT (0)">$MFT</a></td>
<td>Master File Table - An index of every file</td>
</tr>
<tr>
<td>1</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mftmirr" title="NTFS Files: $MFTMirr (1)">$MFTMirr</a></td>
<td>A backup copy of the first 4 records of the MFT</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile" title="NTFS Files: $LogFile (2)">$LogFile</a></td>
<td>Transactional logging file</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_volume" title="NTFS Files: $Volume (3)">$Volume</a></td>
<td>Serial number, creation time, dirty flag</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4769977" id="id4769977"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4769982" id="id4769982"></a>MFT
Zone</h4>
</div>
</div>
</div>
<p>To prevent the MFT becoming fragmented, Windows maintains a
buffer around it. No new files will be created in this buffer
region until the other disk space is used up. The buffer size is
configurable and can be 12.5%, 25%, 37.5% or 50% of the disk. Each
time the rest of the disk becomes full, the buffer size is
halved.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4769998" id="id4769998"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The MFT is self-referencing.</p>
<p>The MFT has some space reserved for future expansion. MFT
records 12 - 15 are marked as in use, but are empty. MFT records 16
- 23 are marked as not in use, however they are never used.</p>
<p>Under Windows, the MFT cannot shrink whilst the system is
running.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_mftmirr" id="file_mftmirr"></a>NTFS Files: $MFTMirr (1)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770031" id="id4770031"></a>Overview</h3>
</div>
</div>
</div>
<p>This is a system file that duplicates at least the first four
FILE records of the MFT for recovery purposes.</p>
<p>If the cluster size of the volume is less than or equal to four
times the mft record size, i.e. usually the cluster size is less
than or equal to 4096 bytes, then the first four MFT records are
stored in the $MFTMirr.</p>
<p>If the cluster size is greater than four times the mft record
size, then the size of $MFTMirr is one cluster and as many MFT
records are stored in it as fit inside a cluster.</p>
<p>For example given an MFT record size of 1024 bytes and a cluster
size of 8192 bytes the $MFTMirr would be 8192 bytes long and it
would contain the first eight FILE records of the MFT.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770062" id="id4770062"></a>$MFTMirr
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4770068" id="id4770068"></a>
<p class="title"><b>Table&nbsp;3.4.&nbsp;$MFTMirr
Attributes</b></p>
<table summary="$MFTMirr Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$MFTMirr</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770201" id="id4770201"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4770207" id="id4770207"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>A copy of at least the first four FILE records of the $MFT.</p>
<div class="table"><a name="id4770217" id="id4770217"></a>
<p class="title"><b>Table&nbsp;3.5.&nbsp;Layout of $MFTMirr</b></p>
<table summary="Layout of $MFTMirr" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Inode</th>
<th>Filename</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft" title="NTFS Files: $MFT (0)">$MFT</a></td>
<td>Master File Table - An index of every file</td>
</tr>
<tr>
<td>1</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mftmirr" title="NTFS Files: $MFTMirr (1)">$MFTMirr</a></td>
<td>A backup copy of the first 4 records of the MFT</td>
</tr>
<tr>
<td>2</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile" title="NTFS Files: $LogFile (2)">$Logfile</a></td>
<td>Transactional logging file</td>
</tr>
<tr>
<td>3</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_volume" title="NTFS Files: $Volume (3)">$Volume</a></td>
<td>Serial number, creation time, dirty flag</td>
</tr>
<tr>
<td>4</td>
<td>...</td>
<td>If present, further FILE records from the MFT (see <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft" title="NTFS Files: $MFT (0)">$MFT</a>)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_logfile" id="file_logfile"></a>NTFS Files: $LogFile (2)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770384" id="id4770384"></a>Overview</h3>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770392" id="id4770392"></a>$LogFile
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4770398" id="id4770398"></a>
<p class="title"><b>Table&nbsp;3.6.&nbsp;$LogFile
Attributes</b></p>
<table summary="$LogFile Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$LogFile</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770532" id="id4770532"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4770538" id="id4770538"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>Little is known about the LogFile's structure.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4770550" id="id4770550"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4770555" id="id4770555"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The logging area consists of a sequence of 4KB log records.</p>
<p>Each logrecord is structured as follows:</p>
<pre class="programlisting">  offset(length)   contents
  0(4)             Magic number 'RCRD'
  1E(12)           Fixup
                                
</pre>
<p>The logrecord supposedly contains a sequence of variable sized
records. The structuring of those is not clear. File 2 is $LogFile,
which contains transaction records to guarantee data integrity in
case of a system failure. As pp. 37 describe, it consists of 2
copies of the restart area, and the 'infinite' logging area.</p>
<p>When you want to write a file on a storage unit, you have to
update the file itself plus some tables of the filesystem (say as
an example the date of the file). At this point, you need a
transaction made of 2 operations (update the file itself, update
the date of the file).</p>
<p>If the transaction is realized, you are sure that your file is
written on the storage unit, and that the filesystem has been left
in a defined state.</p>
<p>If the transaction is not realized (in case of e.g. power
failure, or system failure in general), the filesystem is in an
undefined state. The only way for you to put it back in a defined
(and sane) state (this operation is called a roll-back) is to log
in a special file, the log file, which operations of the
transaction have been successfully completed.</p>
<p>At the first access to the disk after a system failure, the
system read the log file and rolls back all the operations to the
beginning of the last transaction.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>When the system writes to the log file, the operation must be
atomic and immediate.</p>
</li>
<li>
<p>You can put back your volume in sane state in a short time which
is not related to the size of your disk but only to the complexity
of the transaction that failed. Note: This operation is not
performed by the Windows NT chkdsk utility, but by the system: this
normal and reliable operation is a feature of NTFS.</p>
</li>
<li>
<p>If your hardware is reliable, you are sure that you always have
access to all the files of your volume, because it is consistent.
But you can't restore eventual data losses.</p>
</li>
</ul>
</div>
<p>Log file organization:</p>
<p>Two restart areas present in the first two pages (restart
pages). When the volume is unmounted they should be identical.</p>
<p>These are followed by log records organized in pages headed by a
record header going up to log file size.</p>
<p>Not all pages contain log records when a volume is first
formatted, but as the volume ages, all records will be used.</p>
<p>When the log file fills up, the records at the beginning are
purged (by modifying the oldest_lsn to a higher value presumably)
and writing begins at the beginning of the file. Effectively, the
log file is viewed as a circular entity.</p>
<p>Log file restart page header (begins the restart area):</p>
<pre class="programlisting">  struct {
    NTFS_RECORD;              The magic is "RSTR".
    __u64 chkdsk_lsn;         The check disk log file sequence 
                              number for this restart page. 
                              Only used when the magic is changed 
                              to "CHKD". = 0
    __u32 system_page_size;   Byte size of system pages, has to be
                                        &gt;= 512 and a power of 2. Use this
                              to calculate the required size of the
                              usa and add this to the
                              ntfs.usa_offset value. Then verify
                              that the result is less than the 
                              value of the restart_offset. = 0x1000
    __u32 log_page_size;      Byte size of log file records, 
                              has to be &gt;= 512 and a power of 2.
                              = 0x1000
    __u16 restart_offset;     Byte offset from the start of the
                              record to the restart record. 
                              Value has to be aligned to 8-byte
                              boundary. = 0x30
    __s16 minor_ver;          Log file minor version. Only check if
                              major version is 1. (=1 but &gt;=1 is
                              treated the same and &lt;=0 is also
                              ok)
    __u16 major_ver;          Log file major version (=1 but =0 is
                              ok)
  } RESTART_PAGE_HEADER;
                                
</pre>
<p>Log file restart area record:</p>
<p>The offset of this record is found by adding the offset of the
RESTART_PAGE_HEADER to the restart_offset value found in it.</p>
<pre class="programlisting">  struct {
    __u64 current_lsn;        Log file record. = 0x700000, 0x700808
    __u16 log_clients;        Number of log client records 
                              following the restart_area. = 1
    __u16 client_free_list;   How many clients are free(?). If !=
                              0xffff, check that log_clients &gt;
                              client_free_list. = 0xffff
    __u16 client_in_use_list; How many clients are in use(?). 
                              If != 0xffff check that log_clients
                                        &gt; client_in_use_list. = 0
    __u16 flags;              ??? = 0
    __u32 seq_number_bits;    ??? = 0x2c or 0x2d
    __u16 restart_area_length;Length of the restart area. 
                              Following checks required if version
                              matches. Otherwise, skip them.
                              restart_offset + restart_area_length
                              has to be &lt;lt;= system_page_size.
                              Also, restart_area_length has to be
                                        &gt;= client_array_offset +
                              (log_clients * 0xa0). = 0xd0
    __u16 client_array_offset;Offset from the start of this record
                              to the first client record if versions
                              are matched. The offset is otherwise
                              assumed to be (sizeof(RESTART_AREA) +
                              7) &amp; ~7, i.e. rounded up to first
                              8-byte boundary. Either way, the
                              offset to the client array has to be
                              aligned to an 8-byte boundary. Also,
                              restart_offset + offset to the client
                              array have to be &lt;lt;= 510. Also,
                              the offset to the client array +
                              (log_clients * 0xa0) have to be
                                        &lt;lt;= SystemPageSize. = 0x30
    __u64 file_size;          Byte size of the log file. If the
                              restart_offset + the offset of the
                              file_size are &gt; 510 then corruption
                              has occured. This is the very first
                              check when starting with the
                              restart_area as if it fails it means
                              that some of the above values will be
                              corrupted by the multi sector transfer
                              protection! If the structure is
                              deprotected then these checks are
                              futile of course.
                              Calculate the file_size bits and check
                              that seq_number_bits == 0x43 -
                              file_size bits. = 0x400000
    __u32 last_lsn_data_length;??? = 0, 0x40
    __u16 record_length;       Byte size of this record. If the
                               version matches then check that the
                               value of record_length is a multiple
                               of 8, i.e. (record_length + 7) &amp;
                               ~7 == record_length. = 0x30
    __u16 log_page_data_offset;??? = 0x40
  }  RESTART_AREA;
                                
</pre>
<p>Log file client record:</p>
<p>Starts at 0x58 even though AFAIU the above it should start at
0x60. Something fishy is going on. /-:</p>
<pre class="programlisting">  struct {
    __u64 oldest_lsn;          Oldest log file sequence number for
                               this client record. = 0xbd16951d
    __u64 client_restart_lsn;  ??? = 0x700000, 0x700827, 0x700d07
    __u16 prev_client;         ??? = 0x808, 0xd07, 0xd5d
    __u16 next_client;         ??? = 0x70
    __u16 seq_number;          ??? = 0, 4 size uncertain, Regis
                               calls this "volume clear flag" and
                               gives a size of one byte.
    __u16 client_name;         ??? = empty string??? size uncertain
  }  RESTART_CLIENT;
                                
</pre>
<p>NOTE: Above client record is followed by 0xffffffff probably to
indicate the end of the restart area. Then there are 8 bytes = 0,
then one __u32 = 8, followed by the Unicode string "NTFS" and then
zeroes till the end of the page. Is this important at all?</p>
<p>Log page record page header:</p>
<p>Each log page begins with this header and is followed by several
LOG_RECORD structures.</p>
<pre class="programlisting">   struct {
      NTFS_RECORD;                        The magic is "RCRD".
      union {
         __u64 last_lsn;
         __u32 file_offset;
      }  copy;
      __u32 flags;
      __u16 page_count;
      __u16 page_position;
      union {
         struct {
            __u64 next_record_offset;
            __u64 last_end_lsn;
         }  packed;
      }  header;
   }  RECORD_PAGE_HEADER;
                                
</pre>
<p>Possible flags for log records:</p>
<pre class="programlisting">   enum {
      LOG_RECORD_MULTI_PAGE = 1,        ???
      LOG_RECORD_SIZE_PLACE_HOLDER = 0xffff,
            This has nothing to do with the log record. 
            It is only so gcc knows to make the flags 16-bit.
   }  LOG_RECORD_FLAGS;
                                
</pre>
<p>Log record header:</p>
<pre class="programlisting">   struct {
      __u64 this_lsn;
      __u64 client_previous_lsn;
      __u64 client_undo_next_lsn;
      __u32 client_data_length;
      struct {
         __u16 seq_number;
         __u16 client_index;
      }  client_id;
      __u32 record_type;
      __u32 transaction_id;
      LOG_RECORD_FLAGS flags;
      __u16 reserved_or_alignment[3];
  *** Now are at ofs 0x30 into struct. ***
      __u16 redo_operation;
      __u16 undo_operation;
      __u16 redo_offset;
      __u16 redo_length;
      __u16 undo_offset;
      __u16 undo_length;
      __u16 target_attribute;
      __u16 lcns_to_follow;             Number of lcn_list entries
                                        following this entry.
      __u16 record_offset;
      __u16 attribute_offset;
      __u32 alignment_or_reserved;
      __u32 target_vcn;
      __u32 alignment_or_reserved1;
      struct {              Only present if lcns_to_follow is not 0.
         __u32 lcn;
         __u32 alignment_or_reserved;
      }  lcn_list[0];
   }  LOG_RECORD;
                                
</pre>
<p>The restart area (supposedly) has a pointer into the log area,
such as the first and last log records written and the last
checkpoint record written. If the restart area is screwed, recovery
will be very hard - therefore you have two copies of the restart
areas.</p>
<p>Individual log records are identified by logical sequence
numbers (LSNs). The log area wraps around, but the LSNs don't (at
least not anytime soon), so they are used for identifying log
records instead of the offset in the log file.</p>
<p>Any modification of meta data (such as updating the time stamp
that the file system was opened) will result in log file actions,
which in turn result in restart area changes. It might well be that
the dirty bit is implicit rather than explicit: The file system is
clean if the last log record says that there are no pending
transactions.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_volume" id="file_volume"></a>NTFS Files: $Volume (3)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4768858" id="id4768858"></a>Overview</h3>
</div>
</div>
</div>
<p>This is a system file containing information about the
volume.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4768869" id="id4768869"></a>$Volume
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4768875" id="id4768875"></a>
<p class="title"><b>Table&nbsp;3.7.&nbsp;$Volume Attributes</b></p>
<table summary="$Volume Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Volume</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">0x60</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">$VOLUME_NAME</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">0x70</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">$VOLUME_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771319" id="id4771319"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771325" id="id4771325"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>The $DATA attribute has zero length.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771337" id="id4771337"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771342" id="id4771342"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The Serial Number of a <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">volume</a> is
stored in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a>.</p>
<p>This is the only Metadata File that uses the $VOLUME_NAME and
$VOLUME_INFORMATION file attributes.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_attrdef" id="file_attrdef"></a>NTFS Files: $AttrDef (4)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771385" id="id4771385"></a>Overview</h3>
</div>
</div>
</div>
<p>This is a system file containing information about all the file
attributes usable in a volume.</p>
<pre class="programlisting">Attribute end marker 0xFFFFFFFF
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771403" id="id4771403"></a>$AttrDef
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4771408" id="id4771408"></a>
<p class="title"><b>Table&nbsp;3.8.&nbsp;$AttrDef
Attributes</b></p>
<table summary="$AttrDef Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$AttrDef</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771569" id="id4771569"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771575" id="id4771575"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>Its layout is a sequence of records. Each record defines one
file attribute, and its layout is:</p>
<div class="table"><a name="id4771586" id="id4771586"></a>
<p class="title"><b>Table&nbsp;3.9.&nbsp;Layout of $AttrDef</b></p>
<table summary="Layout of $AttrDef" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>128</td>
<td>Label in Unicode</td>
</tr>
<tr>
<td>0x80</td>
<td>4</td>
<td>Type</td>
</tr>
<tr>
<td>0x84</td>
<td>4</td>
<td>Display rule</td>
</tr>
<tr>
<td>0x88</td>
<td>4</td>
<td>Collation rule</td>
</tr>
<tr>
<td>0x8C</td>
<td>4</td>
<td>Flags</td>
</tr>
<tr>
<td>0x90</td>
<td>8</td>
<td>Minimum size</td>
</tr>
<tr>
<td>0x98</td>
<td>8</td>
<td>Maximum size</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771726" id="id4771726"></a>Display
Rule</h4>
</div>
</div>
</div>
<p>At the moment this is always zero</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771737" id="id4771737"></a>Collation
Rule</h4>
</div>
</div>
</div>
<p>At the moment this is always zero, but the possible values
are:</p>
<div class="table"><a name="id4771747" id="id4771747"></a>
<p class="title"><b>Table&nbsp;3.10.&nbsp;$AttrDef Collation
Rules</b></p>
<table summary="$AttrDef Collation Rules" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>Binary</td>
</tr>
<tr>
<td>0x01</td>
<td>Filename</td>
</tr>
<tr>
<td>0x02</td>
<td>Unicode String</td>
</tr>
<tr>
<td>0x10</td>
<td>Unsigned Long</td>
</tr>
<tr>
<td>0x11</td>
<td>SID</td>
</tr>
<tr>
<td>0x12</td>
<td>Security Hash</td>
</tr>
<tr>
<td>0x13</td>
<td>Multiple Unsigned Longs</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771857" id="id4771857"></a>Flags</h4>
</div>
</div>
</div>
<p>We've only witnessed three flags: 0x02, 0x40 and 0x80. It seems
that 0x40 and 0x80 are never seen together. Therefore, the guess is
that:</p>
<div class="table"><a name="id4771868" id="id4771868"></a>
<p class="title"><b>Table&nbsp;3.11.&nbsp;$AttrDef Flags</b></p>
<table summary="$AttrDef Flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x02</td>
<td>Indexed</td>
</tr>
<tr>
<td>0x40</td>
<td>Resident (always)</td>
</tr>
<tr>
<td>0x80</td>
<td>Non-Resident (allowed to be)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771938" id="id4771938"></a>Notes</h3>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>$PROPERTY_SET existed, briefly, in NTFS v3.0. It was intended to
support Native Structure Storage (NSS).</p>
</li>
<li>
<p><a name="file_attrdef_obsolete" id="file_attrdef_obsolete"></a>obsolete: $VOLUME_VERSION and
$SYMBOLIC_LINK appeared in WinNT but weren't used. They don't
appear in either Win2K or WinXP.</p>
</li>
</ul>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771969" id="id4771969"></a>Other
Information</h4>
</div>
</div>
</div>
<p>It should be possible to add user-defined attributes to this
file.</p>
<p>$AttrDef has big WAS it? 36K?</p>
<p>yep in nt4 = 36K mostly blank</p>
<p>now 2560 = 15attrs + 1 blank (2.5K)</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4771992" id="id4771992"></a>Examples</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4771998" id="id4771998"></a>Windows NT
Example</h4>
</div>
</div>
</div>
<div class="table"><a name="id4772004" id="id4772004"></a>
<p class="title"><b>Table&nbsp;3.12.&nbsp;$AttrDef example from
Windows NT</b></p>
<table summary="$AttrDef example from Windows NT" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Name</th>
<th>Flags</th>
<th>IRN</th>
<th>Min Size</th>
<th>Max Size</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>0x40</td>
<td>R</td>
<td>0x30</td>
<td>0x30</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">0x20</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">$ATTRIBUTE_LIST</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>0x42</td>
<td>IR</td>
<td>0x44</td>
<td>0x242</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef_obsolete">0x40</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef_obsolete">$VOLUME_VERSION</a></td>
<td>0x40</td>
<td>R</td>
<td>0x8</td>
<td>0x8</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">0x60</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">$VOLUME_NAME</a></td>
<td>0x40</td>
<td>R</td>
<td>0x2</td>
<td>0x100</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">0x70</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">$VOLUME_INFORMATION</a></td>
<td>0x40</td>
<td>R</td>
<td>0xC</td>
<td>0xC</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>0x00</td>
<td>&nbsp;</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>0x40</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef_obsolete">0xC0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef_obsolete">$SYMBOLIC_LINK</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">0xD0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">$EA_INFORMATION</a></td>
<td>0x40</td>
<td>R</td>
<td>0x8</td>
<td>0x8</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">0xE0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">$EA</a></td>
<td>0x00</td>
<td>&nbsp;</td>
<td>-</td>
<td>0x10000</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4772608" id="id4772608"></a>Windows
2000 and Windows XP Example</h4>
</div>
</div>
</div>
<div class="table"><a name="id4772614" id="id4772614"></a>
<p class="title"><b>Table&nbsp;3.13.&nbsp;$AttrDef example from
Windows 2000/XP</b></p>
<table summary="$AttrDef example from Windows 2000/XP" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Name</th>
<th>Flags</th>
<th>IRN</th>
<th>Min Size</th>
<th>Max Size</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>0x40</td>
<td>R</td>
<td>0x30</td>
<td>0x48</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">0x20</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">$ATTRIBUTE_LIST</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>0x42</td>
<td>IR</td>
<td>0x44</td>
<td>0x242</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">0x40</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">$OBJECT_ID</a></td>
<td>0x40</td>
<td>R</td>
<td>-</td>
<td>0x100</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">0x60</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">$VOLUME_NAME</a></td>
<td>0x40</td>
<td>R</td>
<td>0x2</td>
<td>0x100</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">0x70</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">$VOLUME_INFORMATION</a></td>
<td>0x40</td>
<td>R</td>
<td>0xC</td>
<td>0xC</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>0x00</td>
<td>&nbsp;</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>0x40</td>
<td>R</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">0xC0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">$REPARSE_POINT</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>0x4000</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">0xD0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">$EA_INFORMATION</a></td>
<td>0x40</td>
<td>R</td>
<td>0x8</td>
<td>0x8</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">0xE0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">$EA</a></td>
<td>0x00</td>
<td>&nbsp;</td>
<td>-</td>
<td>0x10000</td>
</tr>
<tr>
<td>0xF0</td>
<td>$PROPERTY_SET</td>
<td>?</td>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream" title="Attribute - $LOGGED_UTILITY_STREAM (0x100)">0x100</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream" title="Attribute - $LOGGED_UTILITY_STREAM (0x100)">$LOGGED_UTILITY_STREAM</a></td>
<td>0x80</td>
<td>N</td>
<td>-</td>
<td>0x10000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_dot" id="file_dot"></a>NTFS Files: . (Root Directory) (5)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773289" id="id4773289"></a>Overview</h3>
</div>
</div>
</div>
<p>The Root Directory of an NTFS, called <span class="emphasis"><em>.</em></span> (dot) is an ordinary directory. If the
volume has Reparse Points then the directory will have a Named Data
Stream called <span class="emphasis"><em>$MountMgrDatabase</em></span>. See the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">Directory Page</a>
for more information.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773317" id="id4773317"></a>Dot (.)
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4773323" id="id4773323"></a>
<p class="title"><b>Table&nbsp;3.14.&nbsp;Dot (.)
Attributes</b></p>
<table summary="Dot (.) Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>.</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>$MountMgrDatabase</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$I30</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$I30</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$I30</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773566" id="id4773566"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file_dot_mountmgrdatabase" id="file_dot_mountmgrdatabase"></a>$MountMgrDatabase Data Stream</h4>
</div>
</div>
</div>
<p>This Data Stream only exists when there are Reparse Points on
the Volume. It consists of repeating groups of:</p>
<div class="table"><a name="id4773587" id="id4773587"></a>
<p class="title"><b>Table&nbsp;3.15.&nbsp;Layout of Dot (.)</b></p>
<table summary="Layout of Dot (.)" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>Size of entry</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Flags? (bitfield?)</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>Offset to UNC Path</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>Size of UNC Path</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>Offset to data</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>Size of data</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773714" id="id4773714"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4773720" id="id4773720"></a>Other
Information</h4>
</div>
</div>
</div>
<p>See the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">Directory Page</a> for more information.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_bitmap" id="file_bitmap"></a>NTFS Files: $Bitmap (6)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773749" id="id4773749"></a>Overview</h3>
</div>
</div>
</div>
<p>This file lists which clusters are in use. Each bit in this file
represents one LCN.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773761" id="id4773761"></a>$Bitmap
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4773766" id="id4773766"></a>
<p class="title"><b>Table&nbsp;3.16.&nbsp;$Bitmap
Attributes</b></p>
<table summary="$Bitmap Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Bitmap</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4773900" id="id4773900"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4773906" id="id4773906"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>The lowest bit represents the lowest numbered LCN. Thus:</p>
<div class="table"><a name="id4773916" id="id4773916"></a>
<p class="title"><b>Table&nbsp;3.17.&nbsp;Layout of $Bitmap</b></p>
<table summary="Layout of $Bitmap" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Bit</th>
<th>LCN</th>
</tr>
</thead>
<tbody>
<tr>
<td>00000001 <sub>2</sub></td>
<td>0</td>
</tr>
<tr>
<td>00000010 <sub>2</sub></td>
<td>1</td>
</tr>
<tr>
<td>00000100 <sub>2</sub></td>
<td>2</td>
</tr>
<tr>
<td>...</td>
<td>etc</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774003" id="id4774003"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4774009" id="id4774009"></a>MFT
Zone</h4>
</div>
</div>
</div>
<p>To prevent the MFT becoming fragmented, Windows maintains a
buffer around it. No new files will be created in this buffer
region until the other disk space is used up.</p>
<p>The buffer size is configurable and can be 12.5%, 25%, 37.5% or
50% of the disk. Each time the rest of the disk becomes full, the
buffer size is halved.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4774028" id="id4774028"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The size of this file is always a multiple of 8 bytes (64
clusters). Because of this rounding-up, the $Bitmap will represent
slightly more clusters than the disk has. These bit are always set
to 1.</p>
<p>The backup copy of the boot sector lies in this no-mans-land the
cluster is hence marked as in use.</p>
<p>In theory, on very small volume, this attribute could be
resident. In practice, Windows crashes.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_boot" id="file_boot"></a>NTFS Files: $Boot (7)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774062" id="id4774062"></a>Overview</h3>
</div>
</div>
</div>
<p>This is the system file that allows the system to boot.</p>
<p>This metadata file points at the boot sector of the volume.</p>
<p>It contains information about the size of the volume, clusters
and the MFT.</p>
<p>It is the only file that cannot be relocated.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774086" id="id4774086"></a>$Boot
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4774092" id="id4774092"></a>
<p class="title"><b>Table&nbsp;3.18.&nbsp;$Boot Attributes</b></p>
<table summary="$Boot Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Boot</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774252" id="id4774252"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4774258" id="id4774258"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<div class="table"><a name="id4774264" id="id4774264"></a>
<p class="title"><b>Table&nbsp;3.19.&nbsp;Layout of $Boot</b></p>
<table summary="Layout of $Boot" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0000</td>
<td>3</td>
<td>Jump to the boot loader routine</td>
</tr>
<tr>
<td>0x0003</td>
<td>8</td>
<td>System Id: "NTFS "</td>
</tr>
<tr>
<td>0x000B</td>
<td>2</td>
<td>Bytes per sector</td>
</tr>
<tr>
<td>0x000D</td>
<td>1</td>
<td>Sectors per cluster</td>
</tr>
<tr>
<td>0x000E</td>
<td>7</td>
<td>Unused</td>
</tr>
<tr>
<td>0x0015</td>
<td>1</td>
<td>Media descriptor (a)</td>
</tr>
<tr>
<td>0x0016</td>
<td>2</td>
<td>Unused</td>
</tr>
<tr>
<td>0x0018</td>
<td>2</td>
<td>Sectors per track</td>
</tr>
<tr>
<td>0x001A</td>
<td>2</td>
<td>Number of heads</td>
</tr>
<tr>
<td>0x001C</td>
<td>8</td>
<td>Unused</td>
</tr>
<tr>
<td>0x0024</td>
<td>4</td>
<td>Usually 80 00 80 00 (b)</td>
</tr>
<tr>
<td>0x0028</td>
<td>8</td>
<td>Number of sectors in the volume</td>
</tr>
<tr>
<td>0x0030</td>
<td>8</td>
<td>LCN of VCN 0 of the $MFT</td>
</tr>
<tr>
<td>0x0038</td>
<td>8</td>
<td>LCN of VCN 0 of the $MFTMirr</td>
</tr>
<tr>
<td>0x0040</td>
<td>4</td>
<td>Clusters per MFT Record (c)</td>
</tr>
<tr>
<td>0x0044</td>
<td>4</td>
<td>Clusters per Index Record (c)</td>
</tr>
<tr>
<td>0x0048</td>
<td>8</td>
<td>Volume serial number</td>
</tr>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
</tr>
<tr>
<td>0x0200</td>
<td>&nbsp;</td>
<td>Windows NT Loader</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774573" id="id4774573"></a></h3>
</div>
</div>
</div>
<p>(a) A media descriptor of 0xF8 means a hard disk.</p>
<p>(b) A value of 80 00 00 00 has been seen on a USB thumb drive
which is formatted with NTFS under Windows XP. Note this is
removable media and is not partitioned, the drive as a whole is
NTFS formatted.</p>
<p>(c) This can be negative, which means that the size of the
MFT/Index record is smaller than a cluster. In this case the size
of the MFT/Index record in bytes is equal to 2^(-1 * Clusters per
MFT/Index record). So for example if Clusters per MFT Record is
0xF6 (-10 in decimal), the MFT record size is 2^(-1 * -10) = 2^10 =
1024 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774598" id="id4774598"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4774603" id="id4774603"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The first 40 bytes are the same as for FAT boot sectors, except
that unused fields are zeroed.</p>
<p>Because this file begins with a boot sector, it must start at
physical cluster 0 (this is the only cluster that NTFS can not
move). This forces the data attribute of this file to be
non-resident. Consequently, the copy of the boot sector (critical
data) can be located anywhere on the volume.</p>
<p>For crash recovery purposes Windows NT 3.51 saves a copy of the
boot sector and puts it in the logical middle of the volume.
Windows NT and later put it at the end of the volume.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_badclus" id="file_badclus"></a>NTFS Files: $BadClus (8)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774641" id="id4774641"></a>Overview</h3>
</div>
</div>
</div>
<p>This Metadata file contains a list of all the bad clusters on
the volume.</p>
<p>The file is sparse, with the only data runs pointing at bad
clusters.</p>
<p>Naturally the file cannot be read.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774661" id="id4774661"></a>$BadClus
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4774666" id="id4774666"></a>
<p class="title"><b>Table&nbsp;3.20.&nbsp;$BadClus
Attributes</b></p>
<table summary="$BadClus Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$BadClus</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>$Bad</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774827" id="id4774827"></a>Layout</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4774833" id="id4774833"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<p>This is always zero length.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file_badclus_bad" id="file_badclus_bad"></a>$Bad Data Stream</h4>
</div>
</div>
</div>
<p>It is a file the size of the volume. Any cluster that is OK, is
represented by a sparse (zero) cluster. Any bad cluster points to
that cluster on disk.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774861" id="id4774861"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4774866" id="id4774866"></a>Other
Information</h4>
</div>
</div>
</div>
<p>A cluster is bad if it contains at least one bad sector.</p>
<p>Because this system file works as any other file, all the bad
clusters are marked as used in the $Bitmap system file, so they can
never ever be used by any other file.</p>
<p>NTFS support hot-fixing: no more FAT's "Abort, Retry, Fail?". If
a new bad cluster is found while the system is running, it is
silently added to this file. If the cluster was on a fault tolerant
volume, ftdisk (the fault tolerant volume driver) reconstitutes the
data and NTFS stores them in another free cluster.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Has an empty unnamed data stream.</p>
</li>
<li>
<p>Has a named ($Bad) data stream, the size of the volume
(sparse)</p>
</li>
<li>
<p>entire volume of clusters (VCN)</p>
</li>
<li>
<p>allocated size = volume size (bytes)</p>
</li>
<li>
<p>attribute size = volume size (bytes)</p>
</li>
<li>
<p>initialised size = 0 (or is one of above, redundant)</p>
</li>
<li>
<p>runs imply sparse file size of volume</p>
</li>
<li>
<p>initialised = 0 implies completely sparse</p>
</li>
</ul>
</div>
<p>This file deals with <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Clusters</a>
not sectors. The Cluster is the smallest unit of disk space that
NTFS will use.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_secure" id="file_secure"></a>NTFS Files: $Secure (9)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4774978" id="id4774978"></a>Overview</h3>
</div>
</div>
</div>
<p>In NTFS v1.2, every file had a <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR
Attribute</a>. It was inefficient to read and check these for every
file access and most of them were the same.</p>
<p>NTFS v3.0 introduced a new Metadata File $Secure.</p>
<p>A new field in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a>,
the Security Id, is a index into $Secure.</p>
<p>There is a Data Stream, $SDS, and two indexes $SII and $SDH.</p>
<p>The Data Stream has a copy of every <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR
Attribute</a> on the volume, and the indexes cross-reference
everything.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4775032" id="id4775032"></a>$Secure
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4775038" id="id4775038"></a>
<p class="title"><b>Table&nbsp;3.21.&nbsp;$Secure
Attributes</b></p>
<table summary="$Secure Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Secure</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>$SDS</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$SDH</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$SII</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$SDH</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$SII</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$SDH</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$SII</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4775336" id="id4775336"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file_secure_sds" id="file_secure_sds"></a>$SDS Data Stream</h4>
</div>
</div>
</div>
<p>The Security Descriptor Stream ($SDS) contains a list of all the
Security Descriptors on the volume.</p>
<p>Each entry is padded to a 16 byte boundary and has a hash for
indexing purposes.</p>
<div class="table"><a name="id4775361" id="id4775361"></a>
<p class="title"><b>Table&nbsp;3.22.&nbsp;Layout of
$Secure:$SDS</b></p>
<table summary="Layout of $Secure:$SDS" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>Hash of Security Descriptor</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>Security Id</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>Offset of this entry in this file</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td>Size of this entry</td>
</tr>
<tr>
<td>0x04</td>
<td>V</td>
<td>Self-relative Security Descriptor</td>
</tr>
<tr>
<td>V+0x04</td>
<td>P16</td>
<td>Padding</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">  sorted by security id
  Self-relative? == has 2 * SID
  generally a large file, not all used
  there may be missing entries - test
  large block of ids at start, then junk, then another block at 256KB
                                
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4775504" id="id4775504"></a>$SDH
Index</h4>
</div>
</div>
</div>
<p>The Security Descriptor Hash ($SDH) Index</p>
<div class="table"><a name="id4775513" id="id4775513"></a>
<p class="title"><b>Table&nbsp;3.23.&nbsp;Layout of
$Secure:$SDH</b></p>
<table summary="Layout of $Secure:$SDH" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
<td colspan="2"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>0x18</td>
<td colspan="2">Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>0x14</td>
<td colspan="2">Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>0x30</td>
<td colspan="2">Size of Index Entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x08</td>
<td colspan="2">Size of Index Key</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>&nbsp;</td>
<td colspan="2">Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td>&nbsp;</td>
<td>Key</td>
<td>Hash of Security Descriptor</td>
</tr>
<tr>
<td>0x14</td>
<td>4</td>
<td>&nbsp;</td>
<td>Key</td>
<td>Security Id</td>
</tr>
<tr>
<td>0x18</td>
<td>4</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Hash of Security Descriptor</td>
</tr>
<tr>
<td>0x1C</td>
<td>4</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Security Id</td>
</tr>
<tr>
<td>0x20</td>
<td>8</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Offset to Security Descriptor (in $SDS)</td>
</tr>
<tr>
<td>0x28</td>
<td>4</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Size of Security Descriptor (in $SDS)</td>
</tr>
<tr>
<td>0x2C</td>
<td>P8</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Padding</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">  Last padding is always 4 bytes and always appears to be the Unicode string "II".
                                
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4775894" id="id4775894"></a>$SII
Index</h4>
</div>
</div>
</div>
<pre class="programlisting">  The Security Id Index ($SII)
                                
</pre>
<div class="table"><a name="id4775906" id="id4775906"></a>
<p class="title"><b>Table 3.24. Layout of $Secure:$SII</b></p>
<table summary="Layout of $Secure:$SII" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
<td colspan="2"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>0x14</td>
<td colspan="2">Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>0x14</td>
<td colspan="2">Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>0x28</td>
<td colspan="2">Size of Index Entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x04</td>
<td colspan="2">Size of Index Key</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td> </td>
<td colspan="2">Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td> </td>
<td>Key</td>
<td>Security Id</td>
</tr>
<tr>
<td>0x14</td>
<td>4</td>
<td> </td>
<td>Data</td>
<td>Hash of Security Descriptor</td>
</tr>
<tr>
<td>0x18</td>
<td>4</td>
<td> </td>
<td>Data</td>
<td>Security Id</td>
</tr>
<tr>
<td>0x1C</td>
<td>8</td>
<td> </td>
<td>Data</td>
<td>Offset to Security Descriptor (in $SDS)</td>
</tr>
<tr>
<td>0x24</td>
<td>4</td>
<td> </td>
<td>Data</td>
<td>Size of Security Descriptor (in $SDS)</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">  This file is sorted by the hash.
  The security descriptors are stored in the $SDS data stream.
  surprisingly the offset (64 bit isn't 8 byte aligned)
                                
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776249" id="id4776249"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4776255" id="id4776255"></a>Questions</h4>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Why do some files still have a $SECURITY_DESCRIPTOR
Attribute?</p>
</li>
<li>
<p>How is the Security Hash generated?</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_upcase" id="file_upcase"></a>NTFS Files: $UpCase (10)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776291" id="id4776291"></a>Overview</h3>
</div>
</div>
</div>
<p>This is a 128KB file full of capital letters.</p>
<p>For each character in the Unicode alphabet, there is an entry in
this file.</p>
<p>It is used to compare and sort filenames.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776310" id="id4776310"></a>$UpCase
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4776316" id="id4776316"></a>
<p class="title"><b>Table&nbsp;3.25.&nbsp;$UpCase
Attributes</b></p>
<table summary="$UpCase Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$UpCase</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776449" id="id4776449"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4776455" id="id4776455"></a>Unnamed
Data Stream</h4>
</div>
</div>
</div>
<div class="table"><a name="id4776461" id="id4776461"></a>
<p class="title"><b>Table&nbsp;3.26.&nbsp;Layout of $UpCase</b></p>
<table summary="Layout of $UpCase" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Character</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
</tr>
<tr>
<td>0x82</td>
<td>A</td>
</tr>
<tr>
<td>0x84</td>
<td>B</td>
</tr>
<tr>
<td>0x86</td>
<td>C</td>
</tr>
<tr>
<td>~</td>
<td>~</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776549" id="id4776549"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4776555" id="id4776555"></a>Other
Information</h4>
</div>
</div>
</div>
<p>This file allows the system to compare filenames independently
of their code page.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_extend" id="file_extend"></a>NTFS Files: $Extend (11)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776577" id="id4776577"></a>Overview</h3>
</div>
</div>
</div>
<p>Windows 2K has introduced a new directory for metadata
files.</p>
<p>This is a directory containing the Metadata files: <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">$ObjId</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse" title="NTFS Files: $Reparse (Any)">$Reparse</a> and <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl" title="NTFS Files: $UsnJrnl (Any)">$UsnJrnl</a>.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776621" id="id4776621"></a>$Extend
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4776627" id="id4776627"></a>
<p class="title"><b>Table&nbsp;3.27.&nbsp;$Extend
Attributes</b></p>
<table summary="$Extend Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Extend</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$I30</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776761" id="id4776761"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4776766" id="id4776766"></a>$I30
Index</h4>
</div>
</div>
</div>
<p>This is an ordinary directory. There is no data stream for this
file.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776779" id="id4776779"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4776784" id="id4776784"></a>Other
Information</h4>
</div>
</div>
</div>
<p>Because there are only up to four files in this directory,
there's never any need for an $INDEX_ALLOCATION and a $BITMAP.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_objid" id="file_objid"></a>NTFS Files: $ObjId (Any)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776808" id="id4776808"></a>Overview</h3>
</div>
</div>
</div>
<p>This system file is an index of all the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">$OBJECT_ID Attributes</a> in use on
the volume. See the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">$OBJECT_ID</a> page for more
details.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4776834" id="id4776834"></a>$ObjId
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4776840" id="id4776840"></a>
<p class="title"><b>Table&nbsp;3.28.&nbsp;$ObjId Attributes</b></p>
<table summary="$ObjId Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$ObjId</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$O</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$O</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$O</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4777028" id="id4777028"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4777033" id="id4777033"></a>$O
Index</h4>
</div>
</div>
</div>
<div class="table"><a name="id4777039" id="id4777039"></a>
<p class="title"><b>Table&nbsp;3.29.&nbsp;Layout of
$ObjId:$O</b></p>
<table summary="Layout of $ObjId:$O" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
<td colspan="2"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>0x20</td>
<td colspan="2">Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>0x38</td>
<td colspan="2">Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>0x58</td>
<td colspan="2">Size of Index Entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x10</td>
<td colspan="2">Size of Index Key</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>&nbsp;</td>
<td colspan="2">Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x10</td>
<td>16</td>
<td>&nbsp;</td>
<td>Key</td>
<td>GUID Object Id</td>
</tr>
<tr>
<td>0x20</td>
<td>8</td>
<td>&nbsp;</td>
<td>Data</td>
<td>MFT Reference</td>
</tr>
<tr>
<td>0x28</td>
<td>16</td>
<td>&nbsp;</td>
<td>Data</td>
<td>GUID Birth Volume Id</td>
</tr>
<tr>
<td>0x38</td>
<td>16</td>
<td>&nbsp;</td>
<td>Data</td>
<td>GUID Birth Object Id</td>
</tr>
<tr>
<td>0x48</td>
<td>16</td>
<td>&nbsp;</td>
<td>Data</td>
<td>GUID Domain Id</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4777372" id="id4777372"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4777378" id="id4777378"></a>
<p class="title"><b>Table&nbsp;3.30.&nbsp;$ObjId flags</b></p>
<table summary="$ObjId flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>Entry has subnodes</td>
</tr>
<tr>
<td>0x02</td>
<td>Last Entry</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4777438" id="id4777438"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4777444" id="id4777444"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The index is called <span class="emphasis"><em>$O</em></span>.
This is an index of Object Ids. It should not be confused with the
index of the same name, used by the Metadata File <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a>.</p>
<p>The index, $O, is sorted by GUID (0x13). This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_collation" title="Concept - Collation">Collation Rule</a>
is specified in the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">Index Root</a>.</p>
<p>A file's <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">$OBJECT_ID Attribute</a> has a GUID
that can be found in this Index. The Index's data provides an MFT
reference back to the file.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_quota" id="file_quota"></a>NTFS Files: $Quota (NT:9, 2K:Any)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4777512" id="id4777512"></a>Overview</h3>
</div>
</div>
</div>
<p>This file first appeared in Window NT, but wan't used. In
Windows 2000, and later, it keeps track of file quotas.</p>
<p>Quotas are kept per person and per volume.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4777528" id="id4777528"></a>$Quota
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4777533" id="id4777533"></a>
<p class="title"><b>Table&nbsp;3.31.&nbsp;$Quota Attributes</b></p>
<table summary="$Quota Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Quota</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$O</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$Q</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$O</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$Q</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$O</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$Q</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4777803" id="id4777803"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4777809" id="id4777809"></a>$O
Index</h4>
</div>
</div>
</div>
<div class="table"><a name="id4777814" id="id4777814"></a>
<p class="title"><b>Table&nbsp;3.32.&nbsp;Layout of
$Quota:$O</b></p>
<table summary="Layout of $Quota:$O" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
<td colspan="2"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>0x1C</td>
<td colspan="2">Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>0x04</td>
<td colspan="2">Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>0x20</td>
<td colspan="2">Size of Index Entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x0C</td>
<td colspan="2">Size of Index Key (K)</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>&nbsp;</td>
<td colspan="2">Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x10</td>
<td>K</td>
<td>&nbsp;</td>
<td>Key</td>
<td>SID</td>
</tr>
<tr>
<td>K+0x10</td>
<td>4</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Owner Id</td>
</tr>
<tr>
<td>K+0x14</td>
<td>P</td>
<td>&nbsp;</td>
<td>Data</td>
<td>Padding8</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">Flags?
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4778105" id="id4778105"></a>$Q
Index</h4>
</div>
</div>
</div>
<pre class="programlisting">header &amp; repeating group
</pre>
<div class="table"><a name="id4778117" id="id4778117"></a>
<p class="title"><b>Table 3.33. Layout of $Quota:$Q</b></p>
<table summary="Layout of $Quota:$Q" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th colspan="2">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
<td colspan="2"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>0x14</td>
<td colspan="2">Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td> </td>
<td colspan="2">Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td> </td>
<td colspan="2">Size of Index Entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x04</td>
<td colspan="2">Size of Index Key</td>
</tr>
<tr>
<td>0x0C</td>
<td>4</td>
<td>0x00</td>
<td colspan="2">Padding</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td> </td>
<td>Key</td>
<td>Owner Id</td>
</tr>
<tr>
<td>0x14</td>
<td>4</td>
<td>0x02</td>
<td>Data</td>
<td>Version</td>
</tr>
<tr>
<td>0x18</td>
<td>4</td>
<td> </td>
<td>Data</td>
<td>Flags</td>
</tr>
<tr>
<td>0x1C</td>
<td>8</td>
<td> </td>
<td>Data</td>
<td>Bytes Used</td>
</tr>
<tr>
<td>0x24</td>
<td>8</td>
<td> </td>
<td>Data</td>
<td>Change Time</td>
</tr>
<tr>
<td>0x2C</td>
<td>8</td>
<td> </td>
<td>Data</td>
<td>Warning Limit</td>
</tr>
<tr>
<td>0x34</td>
<td>8</td>
<td> </td>
<td>Data</td>
<td>Hard Limit</td>
</tr>
<tr>
<td>0x3C</td>
<td>8</td>
<td> </td>
<td>Data</td>
<td>Exceeded Time</td>
</tr>
<tr>
<td>0x44</td>
<td>V</td>
<td> </td>
<td>Data</td>
<td>SID</td>
</tr>
<tr>
<td>V+0x44</td>
<td>P</td>
<td>0x00</td>
<td>Data</td>
<td>Padding8</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">  sid may be missing (quota flags = default limit =&gt; no SID, just padding)
  padding may not be necessary
  index key - xref to which index?
  change time - date/time
  exceeded time - 10/4/01 (not +5 days)
  in the last (null) entry, the padding at 0x0C = 0x02
                                
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4778534" id="id4778534"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4778539" id="id4778539"></a>
<p class="title"><b>Table&nbsp;3.34.&nbsp;$Quota flags</b></p>
<table summary="$Quota flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>Default Limits</td>
</tr>
<tr>
<td>0x0002</td>
<td>Limit Reached</td>
</tr>
<tr>
<td>0x0004</td>
<td>Id Deleted</td>
</tr>
<tr>
<td>0x0010</td>
<td>Tracking Enabled</td>
</tr>
<tr>
<td>0x0020</td>
<td>Enforcement Enabled</td>
</tr>
<tr>
<td>0x0040</td>
<td>Tracking Requested</td>
</tr>
<tr>
<td>0x0080</td>
<td>Log Threshold</td>
</tr>
<tr>
<td>0x0100</td>
<td>Log Limit</td>
</tr>
<tr>
<td>0x0200</td>
<td>Out Of Date</td>
</tr>
<tr>
<td>0x0400</td>
<td>Corrupt</td>
</tr>
<tr>
<td>0x0800</td>
<td>Pending Deletes</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4778691" id="id4778691"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4778696" id="id4778696"></a>Other
Information</h4>
</div>
</div>
</div>
<p>The index is called <span class="emphasis"><em>$O</em></span>.
This is an index of Owner Ids. It should not be confused with the
index of the same name, used by the Metadata File <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">$ObjId</a>.</p>
<p>A file's Owner Id is stored in the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION
Attribute</a>. The Owner Id can be looked up in $O, to give a
Security Id (SID) or looked up in $Q to provide quota
information.</p>
<pre class="programlisting">  The $Q index contains one entry for each existing user_id on the
  volume. The index key is the user_id of the user/group owning this
  quota control entry, i.e. the key is the owner_id. The user_id of
  the owner of a file, i.e. the owner_id, is found in the standard
  information attribute. The collation rule for $Q is
  COLLATION_NTOFS_ULONG.

  The $O index contains one entry for each user/group who has been
  assigned a quota on that volume. The index key holds the SID of
  the user_id the entry belongs to, i.e. the owner_id. The collation
  rule for $O is COLLATION_NTOFS_SID.

  The $O index entry data is the user_id of the user corresponding
  to the SID.
  This user_id is used as an index into $Q to find the quota control
  entry associated with the SID.
                                
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_reparse" id="file_reparse"></a>NTFS Files: $Reparse (Any)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4778764" id="id4778764"></a>Overview</h3>
</div>
</div>
</div>
<p>Win2K can mount volumes and shares on top of existing
directories. This is managed part in software and part by the
volume itself.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4778775" id="id4778775"></a>$Reparse
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4778781" id="id4778781"></a>
<p class="title"><b>Table&nbsp;3.35.&nbsp;$Reparse
Attributes</b></p>
<table summary="$Reparse Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$Reparse</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$R</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$R</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$R</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4778969" id="id4778969"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4778975" id="id4778975"></a>$R
Index</h4>
</div>
</div>
</div>
<div class="table"><a name="id4778981" id="id4778981"></a>
<p class="title"><b>Table&nbsp;3.36.&nbsp;Layout of
$Reparse:$R</b></p>
<table summary="Layout of $Reparse:$R" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>2</td>
<td>0x1C</td>
<td>Offset to data</td>
</tr>
<tr>
<td>0x02</td>
<td>2</td>
<td>0x00</td>
<td>Size of data</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>0x00</td>
<td>Padding</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>0x20</td>
<td>Size of Index Entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x0C</td>
<td>Size of Index Key</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>&nbsp;</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>0x00</td>
<td>Padding</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td>&nbsp;</td>
<td>Key Reparse Tag (and Flags)</td>
</tr>
<tr>
<td>0x14</td>
<td>8</td>
<td>&nbsp;</td>
<td>Key MFT Reference of Reparse Point</td>
</tr>
<tr>
<td>0x1C</td>
<td>4</td>
<td>0x00</td>
<td>Key Padding (align to 8 bytes)</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">0xA000003 flags - see $REPARSE_POINT
No data!
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4779240" id="id4779240"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4779245" id="id4779245"></a>Other
Information</h4>
</div>
</div>
</div>
<p>More information needed.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="file_usnjrnl" id="file_usnjrnl"></a>NTFS Files: $UsnJrnl (Any)</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4779267" id="id4779267"></a>Overview</h3>
</div>
</div>
</div>
<p>A user-readable equivalent of the LogFile.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4779278" id="id4779278"></a>$UsnJrnl
Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4779284" id="id4779284"></a>
<p class="title"><b>Table&nbsp;3.37.&nbsp;$UsnJrnl
Attributes</b></p>
<table summary="$UsnJrnl Attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>$UsnJrnl</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>$J</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>$Max</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4779444" id="id4779444"></a>Layout of
the File</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file_usnjrnl_j" id="file_usnjrnl_j"></a>$J Data Stream</h4>
</div>
</div>
</div>
<pre class="programlisting">repeating group
</pre>
<div class="table"><a name="id4779465" id="id4779465"></a>
<p class="title"><b>Table 3.38. Layout of $UsnJrnl:$J</b></p>
<table summary="Layout of $UsnJrnl:$J" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>Size of entry</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Major Version</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Minor Version</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>MFT Reference</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>Parent MFT Reference</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>Offset of this entry in $J</td>
</tr>
<tr>
<td>0x20</td>
<td>8</td>
<td>Timestamp</td>
</tr>
<tr>
<td>0x28</td>
<td>4</td>
<td>Reason</td>
</tr>
<tr>
<td>0x2B</td>
<td>4</td>
<td>SourceInfo</td>
</tr>
<tr>
<td>0x30</td>
<td>4</td>
<td>SecurityID</td>
</tr>
<tr>
<td>0x34</td>
<td>4</td>
<td>FileAttributes</td>
</tr>
<tr>
<td>0x38</td>
<td>2</td>
<td>Size of filename (in bytes)</td>
</tr>
<tr>
<td>0x3A</td>
<td>2</td>
<td>Offset to filename</td>
</tr>
<tr>
<td>0x3C</td>
<td>V</td>
<td>Filename</td>
</tr>
<tr>
<td>V+0x3C</td>
<td>P</td>
<td>Padding (align to 8 bytes)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4779720" id="id4779720"></a></h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="file_usnjrnl_max" id="file_usnjrnl_max"></a>$Max Data Stream</h4>
</div>
</div>
</div>
<div class="table"><a name="id4779734" id="id4779734"></a>
<p class="title"><b>Table&nbsp;3.39.&nbsp;Layout of
$UsnJrnl:$Max</b></p>
<table summary="Layout of $UsnJrnl:$Max" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>8</td>
<td>Maximum Size</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>Allocation Delta</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>USN ID (a)</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>Lowest Valid USN</td>
</tr>
</tbody>
</table>
</div>
<p>(a) In version 2.0 of the USN Journal, Microsoft uses a FILETIME
64-bit value to randomize the USN ID. However, future versions
might use another way to generate the ID, so it is not safe to
assume this to be the time of the journals creation.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4779848" id="id4779848"></a>Notes</h3>
</div>
</div>
</div>
<p>Version Number</p>
<p>The current version number is 2.0 (Major = 2, Minor = 0).</p>
<p>Reason Flags</p>
<div class="table"><a name="id4779865" id="id4779865"></a>
<p class="title"><b>Table&nbsp;3.40.&nbsp;$UsnJrnl reason
flags</b></p>
<table summary="$UsnJrnl reason flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>Data in one or more named data streams for the file was
overwritten.</td>
</tr>
<tr>
<td>0x02</td>
<td>The file or directory was added to. 0x04 The file or directory
was truncated.</td>
</tr>
<tr>
<td>0x10</td>
<td>Data in one or more named data streams for the file was
overwritten.</td>
</tr>
<tr>
<td>0x20</td>
<td>One or more named data streams for the file were added to.</td>
</tr>
<tr>
<td>0x40</td>
<td>One or more named data streams for the file was truncated.</td>
</tr>
<tr>
<td>0x100</td>
<td>The file or directory was created for the first time.</td>
</tr>
<tr>
<td>0x200</td>
<td>The file or directory was deleted.</td>
</tr>
<tr>
<td>0x400</td>
<td>The user made a change to the file's or directory's extended
attributes. These NTFS attributes are not accessible to
Windows-based applications.</td>
</tr>
<tr>
<td>0x800</td>
<td>A change was made in the access rights to the file or
directory.</td>
</tr>
<tr>
<td>0x1000</td>
<td>The file or directory was renamed, and the file name in this
structure is the previous name.</td>
</tr>
<tr>
<td>0x2000</td>
<td>The file or directory was renamed, and the file name in this
structure is the new name.</td>
</tr>
<tr>
<td>0x4000</td>
<td>A user changed the FILE_ATTRIBUTE_NOT_CONTENT_INDEXED
attribute. That is, the user changed the file or directory from one
that can be content indexed to one that cannot, or vice versa.</td>
</tr>
<tr>
<td>0x8000</td>
<td>A user has either changed one or more file or directory
attributes or one or more time stamps.</td>
</tr>
<tr>
<td>0x10000</td>
<td>An NTFS hard link was added to or removed from the file or
directory.</td>
</tr>
<tr>
<td>0x20000</td>
<td>The compression state of the file or directory was changed from
or to compressed.</td>
</tr>
<tr>
<td>0x40000</td>
<td>The file or directory was encrypted or decrypted.</td>
</tr>
<tr>
<td>0x80000</td>
<td>The object identifier of the file or directory was
changed.</td>
</tr>
<tr>
<td>0x100000</td>
<td>The reparse point contained in the file or directory was
changed, or a reparse point was added to or deleted from the file
or directory.</td>
</tr>
<tr>
<td>0x200000</td>
<td>A named stream has been added to or removed from the file, or a
named stream has been renamed.</td>
</tr>
<tr>
<td>0x80000000</td>
<td>The file or directory was closed.</td>
</tr>
</tbody>
</table>
</div>
<p>Source Info Flags</p>
<div class="table"><a name="id4780137" id="id4780137"></a>
<p class="title"><b>Table&nbsp;3.41.&nbsp;$UsnJrnl source info
flags</b></p>
<table summary="$UsnJrnl source info flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>The operation provides information about a change to the file
or directory made by the operating system. A typical use is when
the Remote Storage system moves data from external to local
storage. Remote Storage is the hierarchical storage management
software. Such a move usually at a minimum adds the
USN_REASON_DATA_OVERWRITE (0x01) flag to a USN record.</td>
</tr>
<tr>
<td>0x02</td>
<td>The operation adds a private data stream to a file or
directory. An example might be a virus detector adding checksum
information. As the virus detector modifies the item, the system
generates USN records. USN_SOURCE_AUXILIARY_DATA (0x02) indicates
that the modifications did not change the application data.</td>
</tr>
<tr>
<td>0x04</td>
<td>The operation creates or updates the contents of a replicated
file. For example, the file replication service sets this flag when
it creates or updates a file in a replicated directory.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="concepts" id="concepts"></a>Chapter&nbsp;4.&nbsp;NTFS Concepts</h2>
</div>
</div>
</div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4791956">Overview</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4791310">Index</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header">Concept - Attribute
Header</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4792461">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4792481">Standard Attribute
Header</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793838">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_id">Concept -
Attribute Id</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793888">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_btree">Concept -
B*Trees</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793959">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4793976">Basic
Terminology</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794114">NTFS
Trees</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794140">Discussion</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794156">References</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_clusters">Concept -
Clusters</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794403">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794468">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_collation">Concept -
Collation</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794615">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794770">Usage</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794861">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_compression">Concept -
Compression</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4794896">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_data_runs">Concept -
Data Runs</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795373">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795405">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795619">data
runs</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4795857">Examples</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory">Concept -
Directory</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797230">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797241">Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797536">Definition</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797549">Properties</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797600">Interest</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file">Concept -
File</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797646">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797657">Attributes</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4797920">Named Data
Streams</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_summary_information">Summary
Information</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record">Concept -
File Record</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798573">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4798661">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799178">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_reference">Concept
- File Reference</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799297">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799307">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799386">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace">Concept - Filename
Namespace</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799428">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799448">Possible
Namespaces</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_fixup">Concept -
Fixup</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799585">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799697">What Does It
Do?</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4799717">Example</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4800988">The
Details</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header">Concept -
Index Header</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801118">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801141">Layout</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801378">Notes</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_record">Concept -
Index Record</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801694">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801710">Definition</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4801723">Layout</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_links">Concept -
Links</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802132">Overview</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802140">Interest</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802155">Questions</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_restart">Concept -
Restart</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802186">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sid">Concept -
SID</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4802224">Overview</a></span></dt>
</dl>
</dd>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sparse">Concept -
Sparse</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4803518">Overview</a></span></dt>
</dl>
</dd>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="id4791956" id="id4791956"></a>Overview</h2>
</div>
</div>
</div>
<p>When a few lines in the glossary aren't enough.</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4791310" id="id4791310"></a>Index</h3>
</div>
</div>
</div>
<div class="table"><a name="id4791315" id="id4791315"></a>
<p class="title"><b>Table&nbsp;4.1.&nbsp;NTFS Concepts</b></p>
<table summary="NTFS Concepts" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Concept</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Attribute Header</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_id" title="Concept - Attribute Id">Attribute Id</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_id" title="Concept - Attribute Id">Attribute Ids used in the MFT FILE
Record</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_btree" title="Concept - B*Trees">B*Tree</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_btree" title="Concept - B*Trees">Balanced
tree data structure, holds the NTFS directory tree</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_clusters" title="Concept - Clusters">Clusters</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_clusters" title="Concept - Clusters">LCNs,
VCNs, sizes</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_collation" title="Concept - Collation">Collation</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_collation" title="Concept - Collation">Sorting and searching</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_compression" title="Concept - Compression">Compression</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_compression" title="Concept - Compression">File and directory level
compression</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_data_runs" title="Concept - Data Runs">Data
Runs</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_data_runs" title="Concept - Data Runs">Data
runs</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">Directory</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">A
typical directory on NTFS</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file" title="Concept - File">File</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file" title="Concept - File">A typical file
on NTFS</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">FILE Record</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">An
MFT File Record</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace" title="Concept - Filename Namespace">Filename Namespace</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace" title="Concept - Filename Namespace">Allowable filenames</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_reference" title="Concept - File Reference">FileRef</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_reference" title="Concept - File Reference">File References</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_fixup" title="Concept - Fixup">Fixup</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_fixup" title="Concept - Fixup">Sector
fixups</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Index Header</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_record" title="Concept - Index Record">INDX Record</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_record" title="Concept - Index Record">A directory index</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_links" title="Concept - Links">Links</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_links" title="Concept - Links">Hard and
Symbolic links</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_restart" title="Concept - Restart">Restart</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_restart" title="Concept - Restart">LogFile
Restart Area</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sid" title="Concept - SID">SID</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sid" title="Concept - SID">Built-in Security
Identifiers</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sparse" title="Concept - Sparse">Sparse</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_sparse" title="Concept - Sparse">Sparse
files</a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_attribute_header" id="concept_attribute_header"></a>Concept - Attribute Header</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4792461" id="id4792461"></a>Overview</h3>
</div>
</div>
</div>
<p>Every attribute in every MFT record has a standard header. The
header stores information about the attribute's type, size, name
(optional) and whether it is resident, or not.</p>
<p>The size of the attribute depends on two things. Does it have a
name? Is it resident? To simplify the tables, all four
possibilities will be shown in full (with some values already
filled in).</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4792481" id="id4792481"></a>Standard
Attribute Header</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4792487" id="id4792487"></a>Resident,
No Name</h4>
</div>
</div>
</div>
<div class="table"><a name="id4792492" id="id4792492"></a>
<p class="title"><b>Table&nbsp;4.2.&nbsp;Layout of a resident
unnamed attribute header</b></p>
<table summary="Layout of a resident unnamed attribute header" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>&nbsp;</td>
<td>Attribute Type (e.g. 0x10, 0x60)</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>&nbsp;</td>
<td>Length (including this header)</td>
</tr>
<tr>
<td>0x08</td>
<td>1</td>
<td>0x00</td>
<td>Non-resident flag</td>
</tr>
<tr>
<td>0x09</td>
<td>1</td>
<td>0x00</td>
<td>Name length</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x00</td>
<td>Offset to the Name</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>0x00</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>&nbsp;</td>
<td>Attribute Id (a)</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td>L</td>
<td>Length of the Attribute</td>
</tr>
<tr>
<td>0x14</td>
<td>2</td>
<td>0x18</td>
<td>Offset to the Attribute</td>
</tr>
<tr>
<td>0x16</td>
<td>1</td>
<td>&nbsp;</td>
<td>Indexed flag</td>
</tr>
<tr>
<td>0x17</td>
<td>1</td>
<td>0x00</td>
<td>Padding</td>
</tr>
<tr>
<td>0x18</td>
<td>L</td>
<td>&nbsp;</td>
<td>The Attribute</td>
</tr>
</tbody>
</table>
</div>
<p>(a) Each attribute has a unique identifier</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4792756" id="id4792756"></a>Resident,
Named</h4>
</div>
</div>
</div>
<div class="table"><a name="id4792762" id="id4792762"></a>
<p class="title"><b>Table&nbsp;4.3.&nbsp;Layout of a resident named
attribute header</b></p>
<table summary="Layout of a resident named attribute header" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>&nbsp;</td>
<td>Attribute Type (e.g. 0x90, 0xB0)</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>&nbsp;</td>
<td>Length (including this header)</td>
</tr>
<tr>
<td>0x08</td>
<td>1</td>
<td>0x00</td>
<td>Non-resident flag</td>
</tr>
<tr>
<td>0x09</td>
<td>1</td>
<td>N</td>
<td>Name length</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x18</td>
<td>Offset to the Name</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>0x00</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>&nbsp;</td>
<td>Attribute Id (a)</td>
</tr>
<tr>
<td>0x10</td>
<td>4</td>
<td>L</td>
<td>Length of the Attribute</td>
</tr>
<tr>
<td>0x14</td>
<td>2</td>
<td>2N+0x18</td>
<td>Offset to the Attribute (b)</td>
</tr>
<tr>
<td>0x16</td>
<td>1</td>
<td>&nbsp;</td>
<td>Indexed flag</td>
</tr>
<tr>
<td>0x17</td>
<td>1</td>
<td>0x00</td>
<td>Padding</td>
</tr>
<tr>
<td>0x18</td>
<td>2N</td>
<td>Unicode</td>
<td>The Attribute's Name</td>
</tr>
<tr>
<td>2N+0x18</td>
<td>L</td>
<td>&nbsp;</td>
<td>The Attribute (c)</td>
</tr>
</tbody>
</table>
</div>
<p>(a) Resident attributes cannot be compressed.</p>
<p>(b) Each attribute has a unique identifier.</p>
<p>(c) Rounded up to a multiple of 4 bytes.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4793050" id="id4793050"></a>Non-Resident, No Name</h4>
</div>
</div>
</div>
<div class="table"><a name="id4793056" id="id4793056"></a>
<p class="title"><b>Table&nbsp;4.4.&nbsp;Layout of a non-resident
unnamed attribute header</b></p>
<table summary="Layout of a non-resident unnamed attribute header" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>&nbsp;</td>
<td>Attribute Type (e.g. 0x20, 0x80)</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>&nbsp;</td>
<td>Length (including this header)</td>
</tr>
<tr>
<td>0x08</td>
<td>1</td>
<td>0x01</td>
<td>Non-resident flag</td>
</tr>
<tr>
<td>0x09</td>
<td>1</td>
<td>0x00</td>
<td>Name length</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x00</td>
<td>Offset to the Name</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>&nbsp;</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>&nbsp;</td>
<td>Attribute Id (a)</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>&nbsp;</td>
<td>Starting VCN</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>&nbsp;</td>
<td>Last VCN</td>
</tr>
<tr>
<td>0x20</td>
<td>2</td>
<td>0x40</td>
<td>Offset to the Data Runs</td>
</tr>
<tr>
<td>0x22</td>
<td>2</td>
<td>&nbsp;</td>
<td>Compression Unit Size (b)</td>
</tr>
<tr>
<td>0x24</td>
<td>4</td>
<td>0x00</td>
<td>Padding</td>
</tr>
<tr>
<td>0x28</td>
<td>8</td>
<td>&nbsp;</td>
<td>Allocated size of the attribute (c)</td>
</tr>
<tr>
<td>0x30</td>
<td>8</td>
<td>&nbsp;</td>
<td>Real size of the attribute</td>
</tr>
<tr>
<td>0x38</td>
<td>8</td>
<td>&nbsp;</td>
<td>Initialized data size of the stream (d)</td>
</tr>
<tr>
<td>0x40</td>
<td>...</td>
<td>&nbsp;</td>
<td>Data Runs</td>
</tr>
</tbody>
</table>
</div>
<p>(a) Each attribute has a unique identifier</p>
<p>(b) Compression unit size = 2 <sup>x</sup> clusters. 0 implies
uncompressed</p>
<p>(c) This is the attribute size rounded up to the cluster
size</p>
<p>(d) When is this not equal to the allocated size?</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4793396" id="id4793396"></a>Non-Resident, Named</h4>
</div>
</div>
</div>
<div class="table"><a name="id4793402" id="id4793402"></a>
<p class="title"><b>Table&nbsp;4.5.&nbsp;Layout of a non-resident
named attribute header</b></p>
<table summary="Layout of a non-resident named attribute header" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>&nbsp;</td>
<td>Attribute Type (e.g. 0x80, 0xA0)</td>
</tr>
<tr>
<td>0x04</td>
<td>4</td>
<td>&nbsp;</td>
<td>Length (including this header)</td>
</tr>
<tr>
<td>0x08</td>
<td>1</td>
<td>0x01</td>
<td>Non-resident flag</td>
</tr>
<tr>
<td>0x09</td>
<td>1</td>
<td>N</td>
<td>Name length</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>0x40</td>
<td>Offset to the Name</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>&nbsp;</td>
<td>Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>&nbsp;</td>
<td>Attribute Id (a)</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>&nbsp;</td>
<td>Starting VCN</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>&nbsp;</td>
<td>Last VCN</td>
</tr>
<tr>
<td>0x20</td>
<td>2</td>
<td>2N+0x40</td>
<td>Offset to the Data Runs (b)</td>
</tr>
<tr>
<td>0x22</td>
<td>2</td>
<td>&nbsp;</td>
<td>Compression Unit Size (c)</td>
</tr>
<tr>
<td>0x24</td>
<td>4</td>
<td>0x00</td>
<td>Padding</td>
</tr>
<tr>
<td>0x28</td>
<td>8</td>
<td>&nbsp;</td>
<td>Allocated size of the attribute (d)</td>
</tr>
<tr>
<td>0x30</td>
<td>8</td>
<td>&nbsp;</td>
<td>Real size of the attribute</td>
</tr>
<tr>
<td>0x38</td>
<td>8</td>
<td>&nbsp;</td>
<td>Initialized data size of the stream (e)</td>
</tr>
<tr>
<td>0x40</td>
<td>2N</td>
<td>Unicode</td>
<td>The Attribute's Name</td>
</tr>
<tr>
<td>2N+0x40</td>
<td>...</td>
<td>&nbsp;</td>
<td>Data Runs (b)</td>
</tr>
</tbody>
</table>
</div>
<p>(a) Each attribute has a unique identifier</p>
<p>(b) Rounded up to a multiple of 4 bytes</p>
<p>(c) Compression unit size = 2 <sup>x</sup> clusters. 0 implies
uncompressed</p>
<p>(d) This is the attribute size rounded up to the cluster
size</p>
<p>(e) When is this not equal to the allocated size?</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4793763" id="id4793763"></a>Flags</h4>
</div>
</div>
</div>
<div class="table"><a name="id4793768" id="id4793768"></a>
<p class="title"><b>Table&nbsp;4.6.&nbsp;Attribute flags</b></p>
<table summary="Attribute flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x0001</td>
<td>Compressed</td>
</tr>
<tr>
<td>0x4000</td>
<td>Encrypted</td>
</tr>
<tr>
<td>0x8000</td>
<td>Sparse</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4793838" id="id4793838"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4793844" id="id4793844"></a>Other
Information</h4>
</div>
</div>
</div>
<p>Only the data attribute can be compressed, or sparse, and only
when it is non-resident.</p>
<p>Although the compression flag is stored in the header, it does
not affect the size of the header.</p>
<pre class="programlisting">    name isn't null terminated
    

    FIXME
    0x40 __s64 compressed_size;
    Byte size of the attribute value after compression.
    Only present when compressed. Always is a multiple of the cluster
    size. Represents the actual amount of disk space being used on the disk.
                                
</pre>
<p>FIXME: The indexed flag only appears in the resident attributes.
Does this mean you can only index resident attributes?</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_attribute_id" id="concept_attribute_id"></a>Concept -
Attribute Id</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4793888" id="id4793888"></a>Overview</h3>
</div>
</div>
</div>
<p>Every <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attributes" title="Chapter2.NTFS Attributes">Attribute</a> in every
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">FILE
Record</a> has an Attribute Id. This Id is unique within the
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">FILE
Record</a> and is used to maintain data integrity.</p>
<p>link to file record a field of the FILE Record each attribute
has an id reused when zero skipped</p>
<p>Next Attribute Id</p>
<p>The Attribute Id that will be assigned to the next Attribute
added to this MFT Record.</p>
<p>N.B. Incremented each time it is used.</p>
<p>N.B. Every time the MFT Record is reused this Id is set to
zero.</p>
<p>N.B. The first instance number is always 0.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_btree" id="concept_btree"></a>Concept - B*Trees</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4793959" id="id4793959"></a>Overview</h3>
</div>
</div>
</div>
<p>B+Trees</p>
<pre class="programlisting">  fixed order
  height balanced
  during add/remove of keys
  minimal disturbance
  pointers downwards only
                        
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4793976" id="id4793976"></a>Basic
Terminology</h3>
</div>
</div>
</div>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Key</p>
<p>An object bearing data</p>
</li>
<li>
<p>Leaf</p>
<p>A key with no children</p>
</li>
<li>
<p>Node</p>
<p>A collection of keys</p>
</li>
<li>
<p>Order</p>
<p>A node of order n, has a maximum of n-1 keys</p>
</li>
<li>
<p>Tree</p>
<p>An ordered data structure</p>
</li>
<li>
<p>Root Node</p>
<p>A node with no parent</p>
</li>
<li>
<p>Median</p>
<p>The ceil((n-1)/2)th key in a node</p>
</li>
<li>
<p>Siblings</p>
<p>Two keys in the same node, or two nodes with the same parent</p>
</li>
<li>
<p>Depth</p>
<p>The number of layers in the tree. Grandparent, parents, children
= 3</p>
</li>
<li>
<p>b-tree</p>
<p>A balanced tree</p>
</li>
<li>
<p>b+tree</p>
<p>A balanced tree whose nodes are at least 1/2 full</p>
</li>
<li>
<p>b*tree</p>
<p>A balanced tree whose nodes are at least 2/3 full</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794114" id="id4794114"></a>NTFS
Trees</h3>
</div>
</div>
</div>
<pre class="programlisting">      index root
      index allocation
      dummy keys
      data in non-leaf keys
      on-disk pointer only point down

  What we have so far

      ...

  Overview

      ...

  Add Rules

      Find the first key that is larger than the new key
      (this will be a necessarily be a leaf)
      Insert the new key before this key (in the same node)
      While the node is full
          Split the current node in two
          Promote the median key to the parent
          Now consider the parent
      End
    
  Delete Rules

      Delete the key
      If the key had children
          Find the successor and move it to this node
          Now consider the successor's old node
      End
      While the node isn't full enough
          If a sibling has enough keys
            steal one
          Else
            Combine with one of the sibling
          End
      End
                        
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794140" id="id4794140"></a>Discussion</h3>
</div>
</div>
</div>
<p>A discussion log from #ntfs on IRC.</p>
<pre class="programlisting">  flatcap :     hi _Oracle_
  _Oracle_:     hi there
  flatcap :     anything I can do for you?
  _Oracle_:     I was wondering about the B+ trees of ntfs
  _Oracle_:     they seem to be a bit awkward, or at least - not what I expected :)
  flatcap :     they _do_ seem strange, but they are perfect for filesystems
  _Oracle_:     no, i meant their on-disk representation
  _Oracle_:     they have a dummy node of sorts?
  flatcap :     the trees in ntfs aren't proper b+trees
  flatcap :     a dummy key
  _Oracle_:     that's exactly what I was hoping to hear!
  flatcap :     (thinking is still a bit hard this morning, bear with me :-)
  _Oracle_:     no problem ;-)
  flatcap :     the trees consist of a node, which contains keys
  flatcap :     the keys in a real (ideal world) b+tree are just separators, and the data is only stored in the leaves
  _Oracle_:     right
  _Oracle_:     btw - how big is a node under ntfs? i mean, how many keys fit in there?
  flatcap :     the INDX record is 4k, an you can get 10's of filenames in it
  flatcap :     but..., that depends on the lengths of the filenames
  _Oracle_:     i thought the number of keys in a node was a fixed property of a b+ tree?
  flatcap :     hehe, usually, yes
  flatcap :     the keys of ntfs actually contain data and also a pointer to their children
  _Oracle_:     so i noticed
  AntonA  :     one should add that INDX records of 2k size have also been seen in the wild - by me (-:
  _Oracle_:     really? 
  _Oracle_:     what OS?
  AntonA  :     NT4
  flatcap :     because there's one more child than key, there has to be a dummy key (no data, but has children)
  _Oracle_:     interesting...
  AntonA  :     some of my directories (e.g. c:\winnt and c:\program files) have 2k INDX size while other dirs have 4k.
  _Oracle_:     so the dummy key is always the "largest"?
  flatcap :     yes
  _Oracle_:     i see...
  _Oracle_:     so if the non-leaf nodes have data of themselves, wouldn't that make the tree a b-tree?
  flatcap :     I've just written a test program to help me understand the trees, which is on bitkeeper
  _Oracle_:     I'd love to see that
  flatcap :     I read a lots of webpages and I think that the nearest term is a b*tree
  _Oracle_:     and how is it different from a b-tree?
  flatcap :     a b-tree maintains a minimum of 1/2 full nodes (except for the root node)
  flatcap :     a b*tree changes the rules slightly and maintains 2/3 full
  _Oracle_:     so it just changes the rules of combining two nodes to one and such?
  flatcap :     exactly
  _Oracle_:     hmmm...
  _Oracle_:     let me think about that for a moment :)
  flatcap :     in a true b+tree, the data keys (leaves) should also have pointers to the next (for quick sequential accesses), but that's probably just maintained in memory
  flatcap :     I'm going to write up everything I know about ntfs trees soon
  _Oracle_:     let me see if i got that...
  _Oracle_:     the index root points to the root INDX record
  flatcap :     you can see my test prog at:  http://linux-ntfs.bkbits.net:8080/tng-support/src/tree
  _Oracle_:     each INDX record contains keys that have pointers to the files themselves and to the keys with lower values
  flatcap :     yes
  _Oracle_:     I see
  flatcap :     the index root lives in the MFT record
  _Oracle_:     Yeah, this I managed to discover :)
  flatcap :     all the rest (index allocations) are non-res
  _Oracle_:     and the number of keys in a single INDX record is completely flexible?
  AntonA  :     yes
  flatcap :     yes, but there's a minimum
  AntonA  :     a minimum?
  flatcap :     yes, that's part of the tree algorithm
  AntonA  :     surely the minimum is a non-data containing terminator entry?
  _Oracle_:     what's the minimum?
  flatcap :     the minimum for a b+tree is 1/2 full, b* 2/3 full
  flatcap :     only the root node may contain fewer
  _Oracle_:     oh.
  _Oracle_:     yeah
  AntonA  :     and the last node...
  flatcap :     the keys are moved about to keep this true
  flatcap :     even the last node will have the "right number" in it
  AntonA  :     that would mean that in a really large directory deleting one file could take hours?
  flatcap :     no, you might think that, but the balancing doesn't affect many other nodes
  flatcap :     if the tree is 4 deep (NTFS equiv say 10^5 files), you'd only be altering 4 index records
  flatcap :     I'll draw lots of pictures when I have a moment (probably tomorrow)
  _Oracle_:     that should be interesting to read!
  flatcap :     are you on our dev mailing list, _Oracle_
  _Oracle_:     What mailing list? (er... no.)
  AntonA  :     the major question that springs to my mind is what would windows ntfs do if it saw an imbalanced tree (because we messed up or because we simply chose to ignore balancing)
  flatcap :     hehe, I hate to think :-)
  _Oracle_:     I wouldn't want to be there, that's for sure
  flatcap :     chkdsk would probably try and rebalance it and you might find that ntfs.sys would just balance it out as files were created/deleted
  _Oracle_:     how do i join the list?
  flatcap :     http://lists.sourceforge.net/lists/listinfo/linux-ntfs-dev
  AntonA  :     um, it would be a lot easier to get directory operations working while ignoring the existence of the tree (obviously operating on them correctly so we don't kill the fs)
  flatcap :     I'll mail the list and answer questions there
  AntonA  :     if windows is able to pickup the pieces without complaint / failure, it would be worth considering as a first pass of implementation at least.
  flatcap :     yes possibly, but I think I know enough now to build something close enough
  flatcap :     (I just wanted a big project where I could start without tripping over you :-)
  AntonA  :     cool
  _Oracle_:     I've got a few more questions if you have the time
  AntonA  :     As I said before. I am not going anywhere near directories. (-:
  flatcap :     sure
  _Oracle_:     Smaller ones, though
                        
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794156" id="id4794156"></a>References</h3>
</div>
</div>
</div>
<p>Here are some sites that I found helpful whilst writing the
B-Tree code.</p>
<div class="literallayout">
<p><br>
<a href="http://tide.it.bond.edu.au/inft320/003/lectures/physical.htm" target="_top">http://tide.it.bond.edu.au/inft320/003/lectures/physical.htm</a><br>

<a href="http://cis.stvincent.edu/carlsond/swdesign/btree/btree.html" target="_top">http://cis.stvincent.edu/carlsond/swdesign/btree/btree.html</a><br>

<a href="http://www.fit.qut.edu.au/~maire/baobab/baobab.html" target="_top">http://www.fit.qut.edu.au/~maire/baobab/baobab.html</a><br>
<a href="http://www.fit.qut.edu.au/~maire/baobab/lecture/index.htm" target="_top">http://www.fit.qut.edu.au/~maire/baobab/lecture/index.htm</a><br>
</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_clusters" id="concept_clusters"></a>Concept - Clusters</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794403" id="id4794403"></a>Overview</h3>
</div>
</div>
</div>
<p>In NTFS, the Cluster is the fundamental unit of disk usage. The
number of sectors that make up a cluster is always a power of 2,
and the number is fixed when the volume is formatted. This number
is called the Cluster Factor and is usually quoted in bytes, e.g.
8KB, 2KB. NTFS addresses everything by its Logical Cluster
Number.</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4794417" id="id4794417"></a>Logical
Cluster Number (LCN)</h4>
</div>
</div>
</div>
<p>Each cluster in a volume is given a sequential number. This is
its Logical Cluster Number. LCN 0 (zero) refers to the first
cluster in the volume (the boot sector).</p>
<p>To convert from an LCN to a physical offset in the volume,
multiply the LCN by the Cluster Size.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4794435" id="id4794435"></a>Virtual
Cluster Number (VCN)</h4>
</div>
</div>
</div>
<p>Each cluster of a non-resident stream is given a sequential
number. This is its Virtual Cluster Number. VCN 0 (zero) refers to
the first cluster of the stream.</p>
<p>To locate the stream on disk, it's necessary to convert from a
VCN to an LCN. This is done with the help of data runs.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4794454" id="id4794454"></a>Data
Runs</h4>
</div>
</div>
</div>
<p>Each contiguous block of LCNs is given a Data Run, which
contains a VCN, an LCN and a length. When NTFS needs to to find an
object on disk, it looks up the VCN in the Data Runs to get the
LCN.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794468" id="id4794468"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4794474" id="id4794474"></a>Other
information</h4>
</div>
</div>
</div>
<p>The Cluster Size can be chosen when the volume is formatted.</p>
<p>The Cluster Size for a volume is stored in $Boot. Also defined
there is the size, in clusters, of an MFT File Record and an Index
Record.</p>
<p>By using Cluster Numbers, NTFS can address larger disks than if
sectors numbers were used.</p>
<p>A list of allowed and default cluster sizes is shown below.</p>
<p>Windows NT</p>
<p>512bytes, 1KB, 2KB or 4KB</p>
<p>Windows 2000, Windows XP</p>
<p>512bytes, 1KB, 2KB, 4KB, 8KB, 16KB, 32KB or 64KB</p>
<div class="table"><a name="id4794514" id="id4794514"></a>
<p class="title"><b>Table&nbsp;4.7.&nbsp;Default cluster
size</b></p>
<table summary="Default cluster size" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Volume Size</th>
<th>Default Cluster Size</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;512MB</td>
<td>Sector size</td>
</tr>
<tr>
<td>&lt;1GB</td>
<td>1KB</td>
</tr>
<tr>
<td>&lt;2GB</td>
<td>2KB</td>
</tr>
<tr>
<td>&gt;2GB</td>
<td>4KB</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4794592" id="id4794592"></a>Questions</h4>
</div>
</div>
</div>
<p>Why does NTFS use Virtual Cluster Numbers?</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_collation" id="concept_collation"></a>Concept - Collation</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794615" id="id4794615"></a>Overview</h3>
</div>
</div>
</div>
<p>To be able to search and sort objects under NTFS</p>
<div class="table"><a name="id4794625" id="id4794625"></a>
<p class="title"><b>Table&nbsp;4.8.&nbsp;Collation types</b></p>
<table summary="Collation types" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Value</th>
<th>Name</th>
<th>Compare the Values as:</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>Binary</td>
<td>Binary, where the first byte is most significant</td>
</tr>
<tr>
<td>0x01</td>
<td>Filename</td>
<td>Unicode strings</td>
</tr>
<tr>
<td>0x02</td>
<td>Unicode</td>
<td>Unicode strings, except that upper case letters should come
first</td>
</tr>
<tr>
<td>0x10</td>
<td>ULONG</td>
<td>An unsigned long (32 bits, little-endian)</td>
</tr>
<tr>
<td>0x11</td>
<td>SID</td>
<td>A security identifier</td>
</tr>
<tr>
<td>0x12</td>
<td>Security Hash</td>
<td>First compare by the Security Hash, then by Security
Identifier</td>
</tr>
<tr>
<td>0x13</td>
<td>ULONGS</td>
<td>A set of unsiged longs (32 bits, little-endian)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794770" id="id4794770"></a>Usage</h3>
</div>
</div>
</div>
<p>Here are some examples of where various collation rules are
used.</p>
<div class="table"><a name="id4794780" id="id4794780"></a>
<p class="title"><b>Table&nbsp;4.9.&nbsp;Default collations types
for standard indexes</b></p>
<table summary="Default collations types for standard indexes" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Name</th>
<th>Used By</th>
</tr>
</thead>
<tbody>
<tr>
<td>ULONG</td>
<td>$SII in file $Secure</td>
</tr>
<tr>
<td>SID</td>
<td>$O in file $Extend/$Quota</td>
</tr>
<tr>
<td>Security Hash</td>
<td>$SDH in file $Secure</td>
</tr>
<tr>
<td>ULONGS</td>
<td>$O in file $Extend/$ObjId</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794861" id="id4794861"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4794866" id="id4794866"></a>Questions</h4>
</div>
</div>
</div>
<p>When comparing by ULONGS, where is the maximum length specified?
Or, can two objects never have identical ULONGS?</p>
<pre class="programlisting">    0x13 ULONGS refers to GUIDs TEST
                                
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_compression" id="concept_compression"></a>Concept - Compression</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4794896" id="id4794896"></a>Overview</h3>
</div>
</div>
</div>
<p>here's a short summary of the mechanism: data. These are
compressed using a modified LZ77 algorithm. The basic idea is that
substrings of the block which have been seen before are compressed
by referencing the string rather than mentioning it again. For
example, Consider the Plain text</p>
<pre class="programlisting">    #include &lt;ntfs.h&gt;\n
    #include &lt;stdio.h&gt;\n
                        
</pre>
<p>This is compressed to #include &lt;ntfs.h&gt;\n
(-18,10)stdio(-17,4)</p>
<p>So the algorithm recognizes that -18 bytes from the current
position, it has already seen the text '#include &lt;'. Then, stdio
is new, but '.h&gt;\n' has been seen before.</p>
<p>The interesting details are in the question? How to encode the
pair (-18,10), and how to mix this with plain-text strings. The
first thing to understand is that such a pair is recorded in two
bytes. Because a back-reference takes two bytes, there is no point
in back-referencing one- or two-byte substrings. This means the
shortest possible substring is 3. This means that length values of
0, 1, and 2 are not possible. So you can subtract 3 of the length
before encoding it. Also, the references are always backward, and
never 0. So you can store them as positive numbers, and subtract
one. The first back-reference is stored as (17,7), and the second
one as (16,1).</p>
<p>Given that a block is 4096 in size, you might need 12 bits to
encode the back reference. This means that you have only for bits
left to encode the length, allowing for a maximum length of 19.
This is not desirable as it limits to compression ratio to 1:19.
OTOH, if the current offset is, say, 123, a back reference of -512
is not possible. Some clever MS engineer decided to dynamically
allocate more bits for the back-reference and less for the length.
The exact split can be written as a table, or as</p>
<pre class="programlisting">    for(i=clear_pos-1,lmask=0xFFF,dshift=12;i&gt;=0x10;i&gt;&gt;=1){
            lmask &gt;&gt;= 1; /* bit mask for length */
            dshift;    /* shift width for delta */
    }
                        
</pre>
<p>Now that we can encode a (offset,length) pair as two bytes, we
still have to know whether a token is a back-reference, or
plain-text. This is one bit per token. Eight tokens are grouped
together and preceded with the tags byte. So the group</p>
<pre class="programlisting">                                &gt;\n(18,10)stdio
                        
</pre>
<p>would be encoded as</p>
<pre class="programlisting">    00000100 &gt; \n 0A 90 s t d i o
                        
</pre>
<p>(the 1 bit indicates the back reference). As an extreme case, a
block of all space (' ') is compressed as</p>
<pre class="programlisting">    00000010 ' ' FC 0F
                        
</pre>
<p>or ' ' (-1,4095). This works because you always read data you
just stored. As a compression unit consists of 16 clusters, it
usually contains more than one of these blocks. If you want to
access the second block, it would be a waste of time to decompress
the first one. Instead, each block is preceded by a 2-byte length.
The lower twelve bits are the length, the higher 4 bits are of
unknown purpose.</p>
<pre class="programlisting">    FIXME: Compression unit's size 2^4 in attribute header.
    The compression method is based on independently compressing blocks of X
    clusters, where X is determined from the compression_unit value found in the
    non-resident attribute record header (more precisely: X = 2^compression_unit
    clusters). On Windows NT/2k, X always is 16 clusters (compression_unit = 4).

      1) The data in the block is all zero (a sparse block):
        This is stored as a sparse block in the run list, i.e. the run list
        entry has length = X and lcn = -1. The mapping pairs array actually
        uses a delta_lcn value length of 0, i.e. delta_lcn is not present at
        all, which is then interpreted by the driver as lcn = -1.
        NOTE: Even uncompressed files can be sparse on NTFS 3.0 volumes, then
        the same principles apply as above, except that the length is not
        restricted to being any particular value.

      2) The data in the block is not compressed:
        This happens when compression doesn't reduce the size of the block
        in clusters. I.e. if compression has a small effect so that the
        compressed data still occupies X clusters, then the uncompressed data
        is stored in the block.
        This case is recognised by the fact that the run list entry has
        length = X and lcn &gt;= 0. The mapping pairs array stores this as
        normal with a run length of X and some specific delta_lcn, i.e.
        delta_lcn has to be present.

      3) The data in the block is compressed:
        The common case. This case is recognised by the fact that the run
        list entry has length L &lt; X and lcn &gt;= 0. The mapping pairs array
        stores this as normal with a run length of X and some specific
        delta_lcn, i.e. delta_lcn has to be present. This run list entry is
        immediately followed by a sparse entry with length = X - L and
        lcn = -1. The latter entry is to make up the vcn counting to the
        full compression block size X.

    In fact, life is more complicated because adjacent entries of the same type
    can be coalesced. This means that one has to keep track of the number of
    clusters handled and work on a basis of X clusters at a time being one
    block. An example: if length L &gt; X this means that this particular run list
    entry contains a block of length X and part of one or more blocks of length
    L - X. Another example: if length L &lt; X, this does not necessarily mean that
    the block is compressed as it might be that the lcn changes inside the block
    and hence the following run list entry describes the continuation of the
    potentially compressed block. The block would be compressed if the
    following run list entry describes at least X - L sparse clusters, thus
    making up the compression block length as described in point 3 above. (Of
    course, there can be several run list entries with small lengths so that the
    sparse entry does not follow the first data containing entry with
    length &lt; X.)

    NOTE: At the end of the compressed attribute value, there most likely is not
    just the right amount of data to make up a compression block, thus this data
    is not even attempted to be compressed. It is just stored as is.

                        
</pre>
<p>If you look at the algorithm, you will notice that it will not
always reduce the data size. If there are no back references, each
byte plain-text will remain as-is. However, every 8 bytes, a tag
bit is inserted, which then will be zero. So, in the worst case, a
block might grow to 4610 bytes (counting the length of the block).
If the block grows in size, it will be stored uncompressed. A
length of exactly 4095 is used to indicate this case. It might be
still possible that the following block will compress well,
reducing the total size of the chunk. If it doesn't, the entire
chunk is stored uncompressed, which is indicated in the run
list.</p>
<p>&gt; each block is preceded by a 2-byte length. The lower twelve
bits are the &gt;length, the higher 4 bits are of unknown
purpose.#</p>
<p>Bit 0x8000 is the flag specifying that the block is compressed.
The compression code OR's in the value 0xB000 (if its compressed),
but the decompression code only looks at bit 0x8000.</p>
<p>Also, the length is actually stored as (n-3) in the low 12 bits.
Actually, (n-1) if you don't count the two bytes used to store the
length itself. So for an uncompressed block the length is stored as
0xFFF, meaning the length is 4096 + 2 more bytes holding the length
itself.</p>
<p>A 0x1000 length block compressed to length 0x500 would require
0x502 bytes, and have an advertised length of 0x4FF.</p>
<p>What I don't know is whether a 16 cluster file that doesn't
compress at all requires 17 clusters to store, in order to
accommodate the extra 2 bytes per block.</p>
<p>I believe it will take only 16 clusters. The fact that it is not
compressed will be expressed in the run list. For example, the
compressed file will look like</p>
<pre class="programlisting">    (1000 A) (0 6)       //(rel.VCN length)
                        
</pre>
<p>whereas the uncompressable file will look like</p>
<pre class="programlisting">    (1000 10)
                        
</pre>
<p>or</p>
<pre class="programlisting">    (1000 A) (1040 6)
                        
</pre>
<p>IOW, if you don't have any runs with VCN==0 in the 16 clusters,
the chunk is entirely uncompressed and plain. Given the compression
algorithm, it is fairly easy to create such a file:</p>
<pre class="programlisting">    s=""
    for i in range(0,16):   #adjust to clusters &gt;512 if necessary

    s=s+chr(i)+chr(j)
    open("uncompressable","w").write(s)
                        
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_data_runs" id="concept_data_runs"></a>Concept - Data Runs</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4795373" id="id4795373"></a>Overview</h3>
</div>
</div>
</div>
<p>Non-resident attributes are stored in intervals of clusters
called runs. Each run is represented by its starting cluster and
its length. The starting cluster of a run is coded as an offset to
the starting cluster of the previous run.</p>
<p>Normal, compressed and sparse files are all defined by runs.</p>
<p>The examples start simple, then quickly get complicated.</p>
<p>This is a table written in the content part of a non-resident
file attribute, which allows to have access to its stream.</p>
<p>NB Assume a 1KB cluster size, throughout. And little endian disk
storage.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4795405" id="id4795405"></a>Layout</h3>
</div>
</div>
</div>
<p>The runlist is a sequence of elements: each element stores an
offset to the starting LCN of the previous element and the length
in clusters of a run.</p>
<p>To save space, Offset and Length are variable size fields
(probably up to 8 bytes), and an element is written in this
crunched format:</p>
<div class="table"><a name="id4795422" id="id4795422"></a>
<p class="title"><b>Table&nbsp;4.10.&nbsp;Layout of a data
run</b></p>
<table summary="Layout of a data run" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset in nibble to the beginning of the element</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>1</td>
<td>F=Size of the Offset field</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>L=Size of the Length field</td>
</tr>
<tr>
<td>2</td>
<td>2*L</td>
<td>Length of the run</td>
</tr>
<tr>
<td>2+2*L</td>
<td>2*F</td>
<td>Offset to the starting LCN of the previous element</td>
</tr>
</tbody>
</table>
</div>
<p>Offset to the starting LCN of the previous element</p>
<p>This is a signed value. For the first element, consider the
offset as relative to the LCN 0, the beginning of the volume.</p>
<p>The layout of the runlist must take account of the data
compression: the set of VCNs containing the stream of a compressed
file attribute is divided in compression units (also called chunks)
of 16 clusters: VCNs 0 to 15 constitutes the 1st compression unit,
VCNs 16 to 31 the 2nd one, and so on... For each compression
unit,</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>The alpha stage of compression is very simple and is independent
of the compression engine used to compress the file attribute: if
all the 16 clusters of a compression unit are full of zeroes, this
compression unit is called a sparse unit and is not physically
stored. Instead, an element with no Offset field (F=0, the Offset
is assumed to be 0 too) and a Length of 16 clusters is put in the
runlist.</p>
</li>
<li>
<p>Else, the beta stage of compression is done by the compression
engine used to compress the file attribute: if the compression of
the unit is possible, N (&lt; 16) clusters are physically stored,
and an element with a Length of N is put in the runlist, followed
by another element with no Offset field (F=0, the Offset is assumed
to be 0 too) and a Length of 16 - N.</p>
</li>
<li>
<p>Else, the unit is not compressed, 16 clusters are physically
stored, and an element with a Length of 16 is put in the
runlist.</p>
</li>
</ul>
</div>
<p>In practice, this is a bit more complicated because some of the
element can be gathered. But let's take an ...</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4795602" id="id4795602"></a>...Example</h4>
</div>
</div>
</div>
<p>We have to decode the following runlist:</p>
<pre class="programlisting">Runlist:
    21 14 00 01 11 10 18 11 05 15 01 27 11 20 05

Decode
    0x14   at   0x100   21 0x100, 0x14
    0x10   at  + 0x18   11  0x18, 0x10
    0x05   at  + 0x15   11  0x15, 0x05
    0x27   at  + none   01  0x27, none
    0x20   at  + 0x05   11  0x05, 0x20

Absolute LCNs
    0x14   at   0x100
    0x10   at   0x118
    0x05   at   0x12D
    0x27   at   none
    0x20   at   0x132

Regroup
    0x10   at   0x100

    0x04   at   0x110
    0x0C   at   0x118

    0x04   at   0x118
    0x05   at   0x12D
    0x07   at   none

    0x10   at   none

    0x10   at   none

    0x10   at   0x132

    0x10   at   0x142

Compression unit beginning at VCN 0x0
 0x10 clusters at LCN 0x100
 Unit not compressed

Compression unit beginning at VCN 0x10
 0x4 clusters at LCN 0x110
 0xC clusters at LCN 0x118
 Unit not compressed

Compression unit beginning at VCN 0x20
 0x4 clusters at LCN 0x124
 0x5 clusters at LCN 0x12D
 0x7 unused clusters: compressed unit

Compression unit beginning at VCN 0x30
 0x10 zeroed clusters: sparse unit

Compression unit beginning at VCN 0x40
 0x10 zeroed clusters: sparse unit

Compression unit beginning at VCN 0x50
 0x10 clusters at LCN 0x132
 Unit not compressed

Compression unit beginning at VCN 0x60
 0x10 clusters at LCN 0x142
 Unit not compressed

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

file.txt 31KB bytes (disk has a 1KB cluster size)

it's stored at clusters 10-26, 45-49, 100-108

17 clusters at LCN 10
5  clusters at LCN 45
9  clusters at LCN 100

next make the offsets relative

17 clusters at LCN 10
5  clusters at LCN 45
9  clusters at LCN 100

is encoded as

11

working in unit of 16 clusters
relative offsets (including -ve)
compressed sparse
variable length structures
stored as:
save space implies wherever MFT places
data it's best not to spread it too far.

-ve implies an offset of +129 would have to use two bytes
therefore -10 = 0xF6
0x80 = -128
0XFF7F = -129

21 14 00 01 11 10 18 11 05 15 01 27 11 20 05
                                
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4795619" id="id4795619"></a>data
runs</h3>
</div>
</div>
</div>
<p>Length and starting cluster are variable size fields. The first
byte of a run indicates the size of both. The size of the offset is
stored in the high nibble, and the size of the length in the low
nibble.</p>
<p>For compressed or sparse runs, the offset is 0, and the size of
the offset is also 0. Each compression unit starts at a multiple of
16 clusters. If compression is possible, at the VCN of a unit will
be one or more data runs followed by an empty run. If there are
data runs for more than 16 clusters, the unit was not compressible.
If there is no data run at all (only a large empty run), the unit
Consists of All zeroes.</p>
<pre class="programlisting">    Example: 21 20 ED 05 22 48 07 48 22 21 28 C8 DB
    First run: 20 clusters starting from 5ED (5ED to 60D)
    2nd run: 748 clusters starting from 5ED+2248 (2835 to 2F7D)
    3rd run: 28 clusters starting from 2835+DBC8 (3FD to 425)
                        
</pre>
<p>Note that the offset is interpreted as signed value.</p>
<p>Take a file of size 0x80 clusters (anywhere on disk). This is
represented by VCN (virtual cluster numbers) 0x00 to 0x7F. These
VCNs are mapper to LCN (logical cluster numbers) in runs (or
extents), eg 21 80 30 60 00.</p>
<p>These runs are variable length, terminated with a zero. The low
nibble of the first byte determines the length of the next number
(1 byte) namely 80. The high nibble determines the length of the
following number (2 bytes) namely 6030.</p>
<p>Outcome: 80 clusters, starting at cluster 6030.</p>
<p>The "sizes" are stored in one byte. The length is unsigned. The
offset is signed and relative to the previous offset.</p>
<p>11 30 60 - 21 10 00 01 - 11 20 E0 - 00</p>
<pre class="programlisting">    Run 1 length 30 offset 60 (first run relative to 0)
    Run 2 length 10 offset 100 + 60
    Run 3 length 20 offset 160 - 20 (EO == -20)
                 ==
                 80
                        
</pre>
<p>Files are represented by a set of VCNs. Sparse files, simply,
have VCNs missing, eg</p>
<pre class="programlisting">    21 09 F5 47  9 clusters from 47F5
    01 07        7 clusters from nowhere (0)
    11 07 09     7 clusters from 47F5 + 9
      ====
      0x17

    123456789ABCDEFG1234... VCN
    RRRRRRRRRZZZZZZZRRRR... Real/Zero
                        
</pre>
<p>Compresses files are first broken into blocks of 16 (0x10)
clusters. Imagine:</p>
<pre class="programlisting">    VCN0123...
       XXXXXXXXXXOOOOO  X=DATA O=SPACE
                        
</pre>
<p>The data is compressed, here, into just ten clusters (If we
can't save 1 cluster in 16, we don't bother) The above is coded
as:</p>
<pre class="programlisting">    21 0A 10 F6   10 clusters of compressed data at F610
    01 06         6 clusters of nothing to round up this block to 16
                        
</pre>
<p>The 6 extra clusters aren't actually taking up any disk space.
The VCNs are bunched into 16s. {{ If a block cannot be compressed,
it would be represented by:</p>
<pre class="programlisting">    21 10 10 F6   16 clusters of compressed data at F610
    

    FIXME:
    In fact, life is more complicated because adjacent entries of the same type
    can be coalesced. This means that one has to keep track of the number of
    clusters handled and work on a basis of X clusters at a time being one
    block. An example: if length L &gt; X this means that this particular run list
    entry contains a block of length X and part of one or more blocks of length
    L - X. Another example: if length L &gt; X, this does not necessarily mean that
    the block is compressed as it might be that the lcn changes inside the block
    and hence the following run list entry describes the continuation of the
    potentially compressed block. The block would be compressed if the
    following run list entry describes at least X - L sparse clusters, thus
    making up the compression block length as described in point 3 above. (Of
    course, there can be several run list entries with small lengths so that the
    sparse entry does not follow the first data containing entry with
    length &lt; X.)

    NOTE: At the end of the compressed attribute value, there most likely is not
    just the right amount of data to make up a compression block, thus this data
    is not even attempted to be compressed. It is just stored as is.
                        
</pre>
<p>Compressed and sparse runs can be intermixed. All this to save
space.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4795857" id="id4795857"></a>Examples</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4795862" id="id4795862"></a>Example 1
- Normal, Unfragmented File</h4>
</div>
</div>
</div>
<p>Data runs: 21 18 34 56 00</p>
<p>Regrouped: 21 18 34 56 - 00</p>
<div class="table"><a name="id4795876" id="id4795876"></a>
<p class="title"><b>Table&nbsp;4.11.&nbsp;Parsed data runs: Example
1 - Normal, Unfragmented File</b></p>
<table summary="Parsed data runs: Example 1 - Normal, Unfragmented File" border="1">
<colgroup>
<col align="center">
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th rowspan="2" align="center">Num</th>
<th rowspan="2">Group</th>
<th colspan="2">Header</th>
<th colspan="2">Data</th>
</tr>
<tr>
<th>Length size</th>
<th>Offset size</th>
<th>Length</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td>21 18 34 56</td>
<td>1 byte</td>
<td>2 bytes</td>
<td>0x18 (1 byte)</td>
<td>0x5634 (2 bytes)</td>
</tr>
<tr>
<td align="center">2</td>
<td>00</td>
<td colspan="4" align="center">End</td>
</tr>
</tbody>
</table>
</div>
<p>Summary:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>0x18 Clusters @ LCN 0x5634</p>
</li>
</ul>
</div>
<p>Therefore, Data1 is a unfragmented file, of size 0x18 clusters,
starting at LCN 0x5634.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4796066" id="id4796066"></a>Example 2
- Normal, Fragmented File</h4>
</div>
</div>
</div>
<p>Data runs: 31 38 73 25 34 32 14 01 E5 11 02 31 42 AA 00 03
00</p>
<p>Regrouped: 31 38 73 25 34 - 32 14 01 E5 11 02 - 31 42 AA 00 03 -
00</p>
<div class="table"><a name="id4796081" id="id4796081"></a>
<p class="title"><b>Table&nbsp;4.12.&nbsp;Parsed data runs: Example
2 - Normal, Fragmented File</b></p>
<table summary="Parsed data runs: Example 2 - Normal, Fragmented File" border="1">
<colgroup>
<col align="center">
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th rowspan="2" align="center">Num</th>
<th rowspan="2">Group</th>
<th colspan="2">Header</th>
<th colspan="2">Data</th>
</tr>
<tr>
<th>Length size</th>
<th>Offset size</th>
<th>Length</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td>31 38 73 25 34</td>
<td>1 byte</td>
<td>3 bytes</td>
<td>0x38</td>
<td>0x342573 (3 bytes)</td>
</tr>
<tr>
<td align="center">2</td>
<td>32 14 01 E5 11 02</td>
<td>2 bytes</td>
<td>3 bytes</td>
<td>0x114</td>
<td>0x363758 (0x211E5 relative to 0x342573)</td>
</tr>
<tr>
<td align="center">3</td>
<td>31 42 AA 00 03</td>
<td>1 byte</td>
<td>3 bytes</td>
<td>0x42</td>
<td>0x393802 (0x300AA relative to 0x363758)</td>
</tr>
<tr>
<td align="center">4</td>
<td>00</td>
<td colspan="4" align="center">End</td>
</tr>
</tbody>
</table>
</div>
<p>Summary:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>0x38 Clusters @ LCN 0x342573</p>
</li>
<li>
<p>0x114 Clusters @ LCN 0x363758</p>
</li>
<li>
<p>0x42 Clusters @ LCN 0x393802</p>
</li>
</ul>
</div>
<p>Therefore, Data2 is a fragmented file, of size 0x18E clusters,
with data blocks at LCNs 0x342573, 0x363758 and 0x393802.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4796334" id="id4796334"></a>Example 3
- Normal, Scrambled File</h4>
</div>
</div>
</div>
<p>Data runs: 11 30 60 21 10 00 01 11 20 E0 00</p>
<p>Regrouped: 11 30 60 - 21 10 00 01 - 11 20 E0 - 00</p>
<div class="table"><a name="id4796348" id="id4796348"></a>
<p class="title"><b>Table&nbsp;4.13.&nbsp;Parsed data runs: Example
3 - Normal, Scrambled File</b></p>
<table summary="Parsed data runs: Example 3 - Normal, Scrambled File" border="1">
<colgroup>
<col align="center">
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th rowspan="2" align="center">Num</th>
<th rowspan="2">Group</th>
<th colspan="2">Header</th>
<th colspan="2">Data</th>
</tr>
<tr>
<th>Length size</th>
<th>Offset size</th>
<th>Length</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td>11 30 60</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x30 (1 byte)</td>
<td>0x60 (1 byte)</td>
</tr>
<tr>
<td align="center">2</td>
<td>21 10 00 01</td>
<td>1 byte</td>
<td>2 bytes</td>
<td>0x10</td>
<td>0x160 (0x100 relative to 0x60)</td>
</tr>
<tr>
<td align="center">3</td>
<td>11 20 E0</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x20</td>
<td>0x140 (-0x20 relative to 0x160)</td>
</tr>
<tr>
<td align="center">4</td>
<td>00</td>
<td colspan="4" align="center">End</td>
</tr>
</tbody>
</table>
</div>
<p>Summary:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>0x30 Clusters @ LCN 0x60</p>
</li>
<li>
<p>0x10 Clusters @ LCN 0x160</p>
</li>
<li>
<p>0x20 Clusters @ LCN 0x140</p>
</li>
</ul>
</div>
<p>Therefore, Data3 is a badly fragmented file of size 0x60
clusters, with data blocks at LCNs 0x60, 0x160 and 0x140.
Furthermore, the third block of data is physically located between
the first and second blocks. (The third run has a negative offset,
placing it before the previous run).</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4796603" id="id4796603"></a>Example 4
- Sparse, Unfragmented File</h4>
</div>
</div>
</div>
<p>Data runs: 11 30 20 01 60 11 10 30 00</p>
<p>Regrouped: 11 30 20 - 01 60 - 11 10 30 - 00</p>
<div class="table"><a name="id4796617" id="id4796617"></a>
<p class="title"><b>Table&nbsp;4.14.&nbsp;Parsed data runs: Example
4 - Sparse, Unfragmented File</b></p>
<table summary="Parsed data runs: Example 4 - Sparse, Unfragmented File" border="1">
<colgroup>
<col align="center">
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th rowspan="2" align="center">Num</th>
<th rowspan="2">Group</th>
<th colspan="2">Header</th>
<th colspan="2">Data</th>
</tr>
<tr>
<th>Length size</th>
<th>Offset size</th>
<th>Length</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td>11 30 20</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x30 (1 byte)</td>
<td>0x20 (1 byte)</td>
</tr>
<tr>
<td align="center">2</td>
<td>01 60</td>
<td>1 byte</td>
<td>0 bytes</td>
<td>0x60</td>
<td>N/A</td>
</tr>
<tr>
<td align="center">3</td>
<td>11 10 30</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x10</td>
<td>0x50 (0x30 relative to 0x20)</td>
</tr>
<tr>
<td align="center">4</td>
<td>00</td>
<td colspan="4" align="center">End</td>
</tr>
</tbody>
</table>
</div>
<p>Summary:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>0x30 Clusters @ LCN 0x20</p>
</li>
<li>
<p>0x60 Clusters (sparse)</p>
</li>
<li>
<p>0x10 Clusters @ LCN 0x50</p>
</li>
</ul>
</div>
<p>Therefore, Data4 is a sparse, unfragmented file, of size 0xA0
clusters, with data blocks at LCNs 0x20 and 0x50.</p>
<p>This file has a sparse part in the middle of size 0x60 clusters.
It takes up no space on disk, but it it represented by 0x60
VCNs.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4796874" id="id4796874"></a>Example 5
- Compressed, Unfragmented File</h4>
</div>
</div>
</div>
<p>Data runs: 11 08 40 01 08 11 10 08 11 0C 10 01 04 00</p>
<p>Regrouped: 11 08 40 - 01 08 - 11 10 08 - 11 0C 10 - 01 04 -
00</p>
<div class="table"><a name="id4796889" id="id4796889"></a>
<p class="title"><b>Table&nbsp;4.15.&nbsp;Parsed data runs: Example
5 - Compressed, Unfragmented File</b></p>
<table summary="Parsed data runs: Example 5 - Compressed, Unfragmented File" border="1">
<colgroup>
<col align="center">
<col>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th rowspan="2" align="center">Num</th>
<th rowspan="2">Group</th>
<th colspan="2">Header</th>
<th colspan="2">Data</th>
</tr>
<tr>
<th>Length size</th>
<th>Offset size</th>
<th>Length</th>
<th>Offset</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td>11 08 40</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x08 (1 byte)</td>
<td>0x40 (1 byte)</td>
</tr>
<tr>
<td align="center">2</td>
<td>01 08</td>
<td>1 byte</td>
<td>0 bytes</td>
<td>0x08</td>
<td>N/A</td>
</tr>
<tr>
<td align="center">3</td>
<td>11 10 08</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x10</td>
<td>0x48 (0x08 relative to 0x40)</td>
</tr>
<tr>
<td align="center">4</td>
<td>11 0C 10</td>
<td>1 byte</td>
<td>1 byte</td>
<td>0x0C</td>
<td>0x58 (0x10 relative to 0x48)</td>
</tr>
<tr>
<td align="center">5</td>
<td>01 04</td>
<td>1 byte</td>
<td>0 bytes</td>
<td>0x04</td>
<td>N/A</td>
</tr>
<tr>
<td align="center">6</td>
<td>00</td>
<td colspan="4" align="center">End</td>
</tr>
</tbody>
</table>
</div>
<p>Summary:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>0x08 Clusters @ LCN 0x40</p>
</li>
<li>
<p>0x08 Clusters (sparse)</p>
</li>
<li>
<p>0x10 Clusters @ LCN 0x48</p>
</li>
<li>
<p>0x0C Clusters @ LCN 0x58</p>
</li>
<li>
<p>0x04 Clusters (sparse)</p>
</li>
</ul>
</div>
<p>Therefore, Data5 is a compressed, unfragmented, file of length
0x30, with data blocks at LCNs 0x40, 0x48 and 0x58.</p>
<p>The data, as stored on disk, is contiguous. The sparse runs pad
out the compression units to blocks of 16 clusters (0x10).</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4797207" id="id4797207"></a>Example 6
- Compressed, Sparse, Fragmented File</h4>
</div>
</div>
</div>
<p>brain damaged file</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_directory" id="concept_directory"></a>Concept - Directory</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797230" id="id4797230"></a>Overview</h3>
</div>
</div>
</div>
<p>Under NTFS every object on the volume is a file, even
directories. A directory is an index of filenames.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797241" id="id4797241"></a>Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4797247" id="id4797247"></a>
<p class="title"><b>Table&nbsp;4.16.&nbsp;A directory record
attributes</b></p>
<table summary="A directory record attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Type</td>
<td>Description</td>
<td>Name</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>dirname</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">0x90</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">$INDEX_ROOT</a></td>
<td>$I30</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">0xA0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">$INDEX_ALLOCATION</a></td>
<td>$I30</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">0xB0</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">$BITMAP</a></td>
<td>$I30</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4797476" id="id4797476"></a></h4>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4797480" id="id4797480"></a>Index
Entry</h5>
</div>
</div>
</div>
<p>An index is a list of index entries. Each entry contains the
name of the file, the standard information and a pointer to the
security information. The correct starting place is the Index
Entry.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4797493" id="id4797493"></a>Index
Root</h5>
</div>
</div>
</div>
<p>This attribute, which is always resident, holds several index
entries. It forms the root of the index tree.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4797505" id="id4797505"></a>Index
Allocation</h5>
</div>
</div>
</div>
<p>A set of runs telling the system where the other indexes are.
(preposition!)</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h5 class="title"><a name="id4797516" id="id4797516"></a>Index
Bitmap</h5>
</div>
</div>
</div>
<p>Which clusters (indexes) are in use.</p>
<pre class="programlisting">A directory can even have a named data stream
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797536" id="id4797536"></a>Definition</h3>
</div>
</div>
</div>
<p>From an human's point of view, a directory is a particular kind
of file that can contain other files. It is a file folder, used in
a nested way to create a logical file hierarchy on a volume.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797549" id="id4797549"></a>Properties</h3>
</div>
</div>
</div>
<p>From NTFS' point of view, a directory is an index of file names,
or more accurately a sequence of index entries containing a
filename attribute. An index entry is created for each file name
attribute of each file contained in the folder. This kind of index
entries can be compared together using the alphabetical order on
their upper-cased (thanks to $UpCase) file name attribute.</p>
<p>A directory has no data attribute. But, as an index, it has
instead three other file attributes: index root, index allocation,
and bitmap. The index is stored in the nodes of a B+ tree in the
following manner:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Each node of the tree contains one or several index entries.
Within a node, index entries are sorted in increasing order</p>
</li>
<li>
<p>Each index entry may point to another (sub-)node containing only
lower index entries</p>
</li>
<li>
<p>The root node is in the stream of the index root attribute, the
other (sub-)nodes are index buffers.</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797600" id="id4797600"></a>Interest</h3>
</div>
</div>
</div>
<p>When an application reads a directory, NTFS returns a list of
file names which is already sorted.</p>
<p>The B+ tree structure (which is used in HPFS too), when built in
a balanced way, is far more efficient than a linear structure to
perform a file name lookup in a folder containing a large number of
files.</p>
<p>Although the duplication of the stream of the indexed attribute
in an index entry can cost some time, it is worthy because you can
browse an index without actually opening all the indexed files (FAT
and HPFS do that, too).</p>
<p>In a directory, the three file attributes: index root, index
allocation, and bitmap are named "$I30", and a directory is just an
Index of file attributes whose type is 30. But NTFS has been
thought as a database filesystem, and it can actually create
indexes based on any file attribute that is always resident. E.g.,
you could create a new file attribute labeled "author name", and
sort your files according to that criteria.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_file" id="concept_file"></a>Concept - File</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797646" id="id4797646"></a>Overview</h3>
</div>
</div>
</div>
<p>It is composed of attributes including its name and its
data.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797657" id="id4797657"></a>Attributes</h3>
</div>
</div>
</div>
<div class="table"><a name="id4797663" id="id4797663"></a>
<p class="title"><b>Table&nbsp;4.17.&nbsp;A file record
attributes</b></p>
<table summary="A file record attributes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">0x10</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">$STANDARD_INFORMATION</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">0x30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">$FILE_NAME</a></td>
<td>filename</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">0x50</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">$SECURITY_DESCRIPTOR</a></td>
<td>&nbsp;</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>[Unnamed]</td>
</tr>
</tbody>
</table>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4797823" id="id4797823"></a>Standard
Information</h4>
</div>
</div>
</div>
<p>This contains the DOS-style file permission, such as read-only
and archive. It also contains four different types of modification
time.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>File creation time</p>
</li>
<li>
<p>Last modification time</p>
</li>
<li>
<p>Last modification time for FILE record</p>
</li>
<li>
<p>Last access time</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4797866" id="id4797866"></a>File
Name</h4>
</div>
</div>
</div>
<p>The file's name is stored as an attribute, too. A file can have
several filenames. This is Windows' equivalent to hard linking
files together.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4797879" id="id4797879"></a>Security
Descriptor</h4>
</div>
</div>
</div>
<p>This stores all of Windows' permissions. ACLs, ACEs,
auditing.</p>
<pre class="programlisting">    May not exist on Win2K (std info, $secure)
                                
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="concept_file_data" id="concept_file_data"></a>Data</h4>
</div>
</div>
</div>
<p>This, finally, is the actual data of the file. It, too, is
stored in an attribute</p>
<pre class="programlisting">    unnamed data stream compulsory (chkdsk will put it back if missing)
    named data streams optional (any limit to the number?)
                                
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4797920" id="id4797920"></a>Named Data
Streams</h3>
</div>
</div>
</div>
<pre class="programlisting">    access with "jim.txt:stream"
                        
</pre>
<div class="table"><a name="id4797932" id="id4797932"></a>
<p class="title"><b>Table 4.18. Fictional named data
streams</b></p>
<table summary="Fictional named data streams" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>icon</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>author</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="concept_file_summary_information" id="concept_file_summary_information"></a>Summary Information</h3>
</div>
</div>
</div>
<p>Windows 2000 introduced the idea of summary information on
files. This information is stored as a set of four named data
streams.</p>
<div class="itemizedlist">
<p class="title"><b>Description</b></p>
<ul type="disc">
<li>
<p>Title</p>
</li>
<li>
<p>Subject</p>
</li>
<li>
<p>Category</p>
</li>
<li>
<p>Keywords (multi-line)</p>
</li>
<li>
<p>Comments (multi-line)</p>
</li>
</ul>
</div>
<div class="itemizedlist">
<p class="title"><b>Origin</b></p>
<ul type="disc">
<li>
<p>Source</p>
</li>
<li>
<p>Author</p>
</li>
<li>
<p>Revision Number</p>
</li>
</ul>
</div>
<div class="table"><a name="id4798116" id="id4798116"></a>
<p class="title"><b>Table&nbsp;4.19.&nbsp;Summary Information named
data streams</b></p>
<table summary="Summary Information named data streams" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>{4c8cc155-6c1e-11d1-8e41-00c04fb9386d}</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>^EDocumentSummaryInformation</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>^ESebiesnrMkudrfcoIaamtykdDa</td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">0x80</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">$DATA</a></td>
<td>^ESummaryInformation</td>
</tr>
</tbody>
</table>
</div>
<p>N.B. Three of the names begin with CTRL-E (0x05). This is
probably to discourage people from reading the streams
directly.</p>
<p>The first stream <span class="emphasis"><em>{4c..</em></span> is
always empty. This is probably just a marker to</p>
<div class="table"><a name="id4798291" id="id4798291"></a>
<p class="title"><b>Table&nbsp;4.20.&nbsp;contents of Summary
Information named data streams</b></p>
<table summary="contents of Summary Information named data streams" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Data Stream</th>
<th>Summary Field</th>
<th>Data Type</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="3">^EDocumentSummaryInformation</td>
<td>Unknown1</td>
<td>Numeric?</td>
<td>0x00</td>
</tr>
<tr>
<td>Unknown2</td>
<td>Numeric</td>
<td>0x01</td>
</tr>
<tr>
<td>Category</td>
<td>ASCII</td>
<td>0x02</td>
</tr>
<tr>
<td rowspan="3">^ESebiesnrMkudrfcoIaamtykdDa</td>
<td>Unknown3</td>
<td>Numeric?</td>
<td>0x00</td>
</tr>
<tr>
<td>Unknown4</td>
<td>Numeric?</td>
<td>0x01</td>
</tr>
<tr>
<td>Source</td>
<td>Unicode</td>
<td>0x04</td>
</tr>
<tr>
<td rowspan="8">^ESummaryInformation</td>
<td>Unknown5</td>
<td>Numeric?</td>
<td>0x00</td>
</tr>
<tr>
<td>Unknown6</td>
<td>Numeric?</td>
<td>0x01</td>
</tr>
<tr>
<td>Title</td>
<td>ASCII</td>
<td>0x02</td>
</tr>
<tr>
<td>Subject</td>
<td>ASCII</td>
<td>0x03</td>
</tr>
<tr>
<td>Author</td>
<td>ASCII</td>
<td>0x04</td>
</tr>
<tr>
<td>Keywords</td>
<td>ASCII</td>
<td>0x05</td>
</tr>
<tr>
<td>Comments</td>
<td>ASCII</td>
<td>0x06</td>
</tr>
<tr>
<td>Revision Number</td>
<td>ASCII</td>
<td>0x09</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_file_record" id="concept_file_record"></a>Concept - File Record</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4798573" id="id4798573"></a>Overview</h3>
</div>
</div>
</div>
<p>The MFT is a set of FILE records. Each file of the volume is
completely described by one or more of these FILE Records. File
Records are equivalent to inodes in Unix terminology. The first
FILE Record that describes a given file is called the Base FILE
record and the others are called Extension FILE Records.</p>
<p>A FILE Record is built up from a header, several variable length
attributes and an end marker (simply 0xFFFFFFFF).</p>
<pre class="programlisting">link table to notes
</pre>
<p>See also: <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attributes" title="Chapter2.NTFS Attributes">Attributes</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_header" title="Concept - Attribute Header">Standard Attribute Header</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft" title="NTFS Files: $MFT (0)">$MFT</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file" title="Concept - File">File</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_fixup" title="Concept - Fixup">Fixup</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_attribute_id" title="Concept - Attribute Id">Attribute
Id</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">Directory</a>,</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4798661" id="id4798661"></a>Layout</h3>
</div>
</div>
</div>
<p>FILE Record</p>
<p>Header</p>
<p>Attribute</p>
<p>Attribute</p>
<p>...</p>
<p>End Marker (0xFFFFFFFF)</p>
<div class="table"><a name="id4798687" id="id4798687"></a>
<p class="title"><b>Table&nbsp;4.21.&nbsp;Layout of a file
record</b></p>
<table summary="Layout of a file record" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>OS</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>&nbsp;</td>
<td>Magic number 'FILE'</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>&nbsp;</td>
<td>Offset to the update sequence</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>&nbsp;</td>
<td>Size in words of Update Sequence Number &amp; Array (S)</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>&nbsp;</td>
<td>$LogFile Sequence Number (LSN)</td>
</tr>
<tr>
<td>0x10</td>
<td>2</td>
<td>&nbsp;</td>
<td>Sequence number</td>
</tr>
<tr>
<td>0x12</td>
<td>2</td>
<td>&nbsp;</td>
<td>Hard link count</td>
</tr>
<tr>
<td>0x14</td>
<td>2</td>
<td>&nbsp;</td>
<td>Offset to the first Attribute</td>
</tr>
<tr>
<td>0x16</td>
<td>2</td>
<td>&nbsp;</td>
<td>Flags</td>
</tr>
<tr>
<td>0x18</td>
<td>4</td>
<td>&nbsp;</td>
<td>Real size of the FILE record</td>
</tr>
<tr>
<td>0x1C</td>
<td>4</td>
<td>&nbsp;</td>
<td>Allocated size of the FILE record</td>
</tr>
<tr>
<td>0x20</td>
<td>8</td>
<td>&nbsp;</td>
<td>File reference to the base FILE record</td>
</tr>
<tr>
<td>0x28</td>
<td>2</td>
<td>&nbsp;</td>
<td>Next Attribute Id</td>
</tr>
<tr>
<td>0x2A</td>
<td>2</td>
<td>XP</td>
<td>Align to 4 byte boundary</td>
</tr>
<tr>
<td>0x2C</td>
<td>4</td>
<td>XP</td>
<td>Number of this MFT Record</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>2</td>
<td>&nbsp;</td>
<td>Update Sequence Number (a)</td>
</tr>
<tr>
<td>&nbsp;</td>
<td>2S-2</td>
<td>&nbsp;</td>
<td>Update Sequence Array (a)</td>
</tr>
</tbody>
</table>
</div>
<p>(a) The offset to these two fields depends on your operating
system.</p>
<p>$LogFile Sequence Number (LSN)</p>
<p>This is changed every time the record is modified.</p>
<p>Sequence Number</p>
<p>Number of times this mft record has been reused.</p>
<p>N.B. The increment (skipping zero) is done when the file is
deleted.</p>
<p>N.B. If this is set to zero it is left as zero.</p>
<p>Hard Link Count</p>
<p>Number of hard links, i.e. the number of directory entries
referencing this record.</p>
<p>N.B. Only used in mft base records.</p>
<p>Flags</p>
<div class="table"><a name="id4799045" id="id4799045"></a>
<p class="title"><b>Table&nbsp;4.22.&nbsp;File record flags</b></p>
<table summary="File record flags" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Flag</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x01</td>
<td>Record is in use</td>
</tr>
<tr>
<td>0x02</td>
<td>Record is a directory</td>
</tr>
<tr>
<td>0x04</td>
<td>Don't know</td>
</tr>
<tr>
<td>0x08</td>
<td>Don't know</td>
</tr>
</tbody>
</table>
</div>
<p>Real / Allocated Size</p>
<p>The Allocated Size is how much space the Record takes up on
disk. This should be a multiple of the cluster size and should
probably be equal to the size of an MFT File Record. The Real Size
is a count of how many bytes of the Record are actually used.</p>
<p>N.B. The Real Size will be padded to an 8 byte boundary.</p>
<p>Base MFT Record</p>
<p>This is zero for Base MFT Records. When it is not zero it is a
MFT Reference pointing to the Base MFT Record to which this Record
belongs. The Base Record contains the information about the
Extension Record. This information is stored in an ATTRIBUTE_LIST
attribute.</p>
<p>Next Attribute Id</p>
<p>The Attribute Id that will be assigned to the next Attribute
added to this MFT Record.</p>
<p>N.B. Incremented each time it is used.</p>
<p>N.B. Every time the MFT Record is reused this Id is set to
zero.</p>
<p>N.B. The first instance number is always 0.</p>
<p>The master file table record consists of a header and the
attribute list. It has a size of 400 (=1K), or the cluster size
(whichever is larger). The header has the following fields:</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799178" id="id4799178"></a>Notes</h3>
</div>
</div>
</div>
<p>The attribute list is of variable length and terminated with
FFFFFFFF. For 1K MFT records, the attribute list starts at offset
0x30.</p>
<pre class="programlisting">    The sequence number is a circular counter (skipping 0) describing how many
    times the referenced mft record has been (re)used. This has to match the
    sequence number of the mft record being referenced, otherwise the reference
    is considered stale and removed (FIXME: only ntfsck or the driver itself?).

    If the sequence number is zero it is assumed that no sequence number
    consistency checking should be performed.

    FIXME: The mft zone is defined as the first 12% of the volume. This space is
    reserved so that the mft can grow contiguously and hence doesn't become
    fragmented. Volume free space includes the empty part of the mft zone and
    when the volume's free 88% are used up, the mft zone is shrunk by a factor
    of 2, thus making more space available for more files/data. This process is
    repeated everytime there is no more free space except for the mft zone until
    there really is no more free space.

    The mft record header present at the beginning of every record in the mft.
    This is followed by a sequence of variable length attribute records which
    is terminated by an attribute of type $END which is a truncated attribute
    in that it only consists of the attribute type code $END and none of the
    other members of the attribute structure are present.

    When (re)using the mft record, we place the update sequence array at this
    offset, i.e. before we start with the attributes. This also makes sense,
    otherwise we could run into problems with the update sequence array
    containing in itself the last two bytes of a sector which would mean that
    multi sector transfer protection wouldn't work. As you can't protect data
    by overwriting it since you then can't get it back...
    When reading we obviously use the data from the ntfs record header.
                        
</pre>
<p>The sequence of attributes part</p>
<p>This is a sequence of file attributes that has a variable
length. In each FILE record, the sequence is ordered by increasing
order of the attribute type. The sequence is terminated with FF FF
FF FF.</p>
<pre class="programlisting">    Size defined in $Boot.
    A FILE record is 1 KB large or the cluster size if larger (as far as Helen is
    concerned, its maximum size is 4 KB, but Windows NT 4 limit is 64 KB). It falls into
    2 parts:
                        
</pre>
<p>Extension FILE records are used when all information about a
file doesn't fit into the base FILE record (e.g. if the sequence of
file attributes grows because the file has a lot of file attributes
or because the data attribute of the file has a long runlist
because its stream is very fragmented). Only the base FILE record
is used for referencing the file it describes. Since the type of
the Attribute List file attribute is small enough, we are sure that
this file attribute will be in the base FILE record. And this file
attribute provides the references to all the extension FILE records
describing the file.</p>
<p>When a file is deleted, NTFS can't simply remove the associated
FILE records from the MFT, otherwise FILE record numbers wouldn't
be constant over time, and all file references would have to be
updated! Instead, the in-use flag of a FILE record indicates when
it is no longer in use. When a file is created, an unused FILE
record can be re-used for it, but its sequence number is
incremented by one. This mechanism allow NTFS to check that file
references don't point to deleted files.</p>
<pre class="programlisting">    seq num = inode for 0x00 &lt; i &lt; 0x10 (inode 0 (MFT) has seq num of 1)
    

    see also attribute id page and file reference page
    

    flags 1 in use, 2 dir, 4 ???, 8??? (4+8 ARE used)
                        
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_file_reference" id="concept_file_reference"></a>Concept -
File Reference</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799297" id="id4799297"></a>Overview</h3>
</div>
</div>
</div>
<p>A unique identifier for a FILE record in the MFT.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799307" id="id4799307"></a>Layout</h3>
</div>
</div>
</div>
<div class="table"><a name="id4799313" id="id4799313"></a>
<p class="title"><b>Table&nbsp;4.23.&nbsp;Layout of a file
reference</b></p>
<table summary="Layout of a file reference" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>6</td>
<td>FILE record number</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Sequence number</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799386" id="id4799386"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4799392" id="id4799392"></a>Sequence
number</h4>
</div>
</div>
</div>
<p>If the filesystem is consistent, this number must match the
sequence number of the FILE record referenced by the FILE record
number.</p>
<pre class="programlisting">    mft references (aka file references or file record segment references) are
    used whenever a structure needs to refer to a record in the mft.

    A reference consists of a 48-bit index into the mft and a 16-bit sequence
    number used to detect stale references.

    when is the seq num incremented
                                
</pre></div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_filename_namespace" id="concept_filename_namespace"></a>Concept - Filename Namespace</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799428" id="id4799428"></a>Overview</h3>
</div>
</div>
</div>
<p>Old versions of the FAT filesystem had strict limits on
filenames. Many characters were forbidden, and the length was
restricted to 11 characters (a small namespace). Newer versions of
FAT allowed more characters and longer filenames. NTFS has almost
no restrictions.</p>
<p>Filenames are given a flag to show which namespace the name
belongs to. In order to support old applications, NTFS allocates a
short DOS-friendly name to any file with an DOS-incompatible
name.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799448" id="id4799448"></a>Possible
Namespaces</h3>
</div>
</div>
</div>
<p>0: POSIX</p>
<p>This is the largest namespace. It is case sensitive and allows
all Unicode characters except for NULL (0) and Forward Slash '/'.
The maximum name length is 255 characters. N.B. There are some
characters, e.g. Colon ':', which are valid in NTFS, but Windows
will not allow you to use.</p>
<p>1: Win32</p>
<p>Win32 is a subset of the POSIX namespace and is case
insensitive. It uses all the Unicode characters, except: '"' '*'
'/' ':' '&lt;' '&gt;' '?' '\' '|' N.B. Names cannot end with Dot
'.', or Space ''.</p>
<p>2: DOS</p>
<p>DOS is a subset of the Win32 namespace, allowing only 8 bit
upper case characters, greater than Space '', and excluding: '"'
'*' '+' ',' '/' ':' ';' '&lt;' '=' '&gt;' '?' '\'. N.B. Names must
match the following pattern: 1 to 8 characters, then '.', then 1 to
3 characters.</p>
<p>3: Win32 &amp;DOS</p>
<p>This namespace means that both the Win32 and the DOS filenames
are identical and hence have been saved in this single filename
record.</p>
<p>To convert a POSIX or Win32 filename to a DOS-friendly filename,
follow these steps:</p>
<div class="orderedlist">
<ol type="1">
<li>
<p>Remove all Unicode characters</p>
</li>
<li>
<p>Remove all '.' but the last one if <span class="emphasis"><em>it
is not the first character</em></span></p>
</li>
<li>
<p>Uppercase all letters</p>
</li>
<li>
<p>Remove forbidden characters</p>
</li>
<li>
<p>Truncate everything before the potential '.' to 6 characters,
and add the string "~1"</p>
</li>
<li>
<p>Truncate everything after the potential '.' to 3 characters</p>
</li>
<li>
<p>While the name already exists, increment the string "~1"</p>
</li>
<li>
<p>N.B. Step 7 means that although the generated DOS name is
unique, it is impossible to deduce it from the Win32 name only.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_fixup" id="concept_fixup"></a>Concept - Fixup</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799585" id="id4799585"></a>Overview</h3>
</div>
</div>
</div>
<p>The smallest unit of disk space that NTFS uses is a <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Cluster</a>. This can vary from one sector to
128 sectors, the usual number is 8 (4KB). Naturally this is
dependent on the sector and <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Cluster</a>. sizes declared in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a>.</p>
<p>Because a single sector could fail, it's important for NTFS to
be able to detect errors in a cluster. For this purpose the sectors
have <span class="emphasis"><em>Fixups</em></span>, which are kept
in an <span class="emphasis"><em>Update Sequence
Array</em></span>.</p>
<p>Many important Metadata Records use fixups to protect data
integrity</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file_record" title="Concept - File Record">FILE Records in the $MFT</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">INDX Records in directories and other
indexes</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile" title="NTFS Files: $LogFile (2)">RCRD
Records in the $LogFile</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_restart" title="Concept - Restart">RSTR
Records in the $LogFile</a></p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799697" id="id4799697"></a>What Does
It Do?</h3>
</div>
</div>
</div>
<p>The header of each of these records contains a Update Sequence
Number and a buffer. The last two bytes of each sector of the
record are copied into the buffer and the Update Sequence Number is
written in their place.</p>
<p>When the record is read, the Update Sequence Number is read from
the header and compared against the last two bytes of each sector.
If it succeeds, then it copies the bytes in the buffer back to
their original places.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4799717" id="id4799717"></a>Example</h3>
</div>
</div>
</div>
<p>Here's an example before the fixup is applied, with a cluster
size of 2KB (4 Sectors).</p>
<div class="table"><a name="id4799727" id="id4799727"></a>
<p class="title"><b>Table&nbsp;4.24.&nbsp;Fixup example:
before</b></p>
<table summary="Fixup example: before" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col></colgroup>
<tbody>
<tr>
<td>
<p>Offset</p>
</td>
<td colspan="8">
<p>Data</p>
</td>
<td>
<p>Description</p>
</td>
</tr>
<tr>
<td>
<p>0x0000</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td>
<p>Header</p>
</td>
</tr>
<tr>
<td>
<p>0x0028</p>
</td>
<td>
<p>CD</p>
</td>
<td>
<p>AB</p>
</td>
<td colspan="6"></td>
<td>
<p>Update Sequence Number</p>
</td>
</tr>
<tr>
<td>
<p>0x002A</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>00</p>
</td>
<td>
<p>Update Sequence Array</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x01F8</p>
</td>
<td>
<p>11</p>
</td>
<td>
<p>12</p>
</td>
<td>
<p>13</p>
</td>
<td>
<p>14</p>
</td>
<td>
<p>15</p>
</td>
<td>
<p>16</p>
</td>
<td>
<p>17</p>
</td>
<td>
<p>18</p>
</td>
<td>
<p>End of Sector 1</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x03F8</p>
</td>
<td>
<p>21</p>
</td>
<td>
<p>22</p>
</td>
<td>
<p>23</p>
</td>
<td>
<p>24</p>
</td>
<td>
<p>25</p>
</td>
<td>
<p>26</p>
</td>
<td>
<p>27</p>
</td>
<td>
<p>28</p>
</td>
<td>
<p>End of Sector 2</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x05F8</p>
</td>
<td>
<p>31</p>
</td>
<td>
<p>32</p>
</td>
<td>
<p>33</p>
</td>
<td>
<p>34</p>
</td>
<td>
<p>35</p>
</td>
<td>
<p>36</p>
</td>
<td>
<p>37</p>
</td>
<td>
<p>38</p>
</td>
<td>
<p>End of Sector 3</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x07F8</p>
</td>
<td>
<p>41</p>
</td>
<td>
<p>42</p>
</td>
<td>
<p>43</p>
</td>
<td>
<p>44</p>
</td>
<td>
<p>45</p>
</td>
<td>
<p>46</p>
</td>
<td>
<p>47</p>
</td>
<td>
<p>48</p>
</td>
<td>
<p>End of Sector 4</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Here the Update Sequence Number is 0xABCD and the Update
Sequence Array is still empty.</p>
<div class="table"><a name="id4800357" id="id4800357"></a>
<p class="title"><b>Table&nbsp;4.25.&nbsp;Fixup example:
after</b></p>
<table summary="Fixup example: after" border="1">
<colgroup>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col>
<col></colgroup>
<tbody>
<tr>
<td>
<p>Offset</p>
</td>
<td colspan="8">
<p>Data</p>
</td>
<td>
<p>Description</p>
</td>
</tr>
<tr>
<td>
<p>0x0000</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td>
<p>Header</p>
</td>
</tr>
<tr>
<td>
<p>0x0028</p>
</td>
<td>
<p>CD</p>
</td>
<td>
<p>AB</p>
</td>
<td colspan="6"></td>
<td>
<p>Update Sequence Number</p>
</td>
</tr>
<tr>
<td>
<p>0x002A</p>
</td>
<td>
<p>17</p>
</td>
<td>
<p>18</p>
</td>
<td>
<p>27</p>
</td>
<td>
<p>28</p>
</td>
<td>
<p>37</p>
</td>
<td>
<p>38</p>
</td>
<td>
<p>47</p>
</td>
<td>
<p>48</p>
</td>
<td>
<p>Update Sequence Array</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x01F8</p>
</td>
<td>
<p>11</p>
</td>
<td>
<p>12</p>
</td>
<td>
<p>13</p>
</td>
<td>
<p>14</p>
</td>
<td>
<p>15</p>
</td>
<td>
<p>16</p>
</td>
<td>
<p>CD</p>
</td>
<td>
<p>AB</p>
</td>
<td>
<p>End of Sector 1</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x03F8</p>
</td>
<td>
<p>21</p>
</td>
<td>
<p>22</p>
</td>
<td>
<p>23</p>
</td>
<td>
<p>24</p>
</td>
<td>
<p>25</p>
</td>
<td>
<p>26</p>
</td>
<td>
<p>CD</p>
</td>
<td>
<p>AB</p>
</td>
<td>
<p>End of Sector 2</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x05F8</p>
</td>
<td>
<p>31</p>
</td>
<td>
<p>32</p>
</td>
<td>
<p>33</p>
</td>
<td>
<p>34</p>
</td>
<td>
<p>35</p>
</td>
<td>
<p>36</p>
</td>
<td>
<p>CD</p>
</td>
<td>
<p>AB</p>
</td>
<td>
<p>End of Sector 3</p>
</td>
</tr>
<tr>
<td>
<p>...</p>
</td>
<td colspan="8">
<p>...</p>
</td>
<td></td>
</tr>
<tr>
<td>
<p>0x07F8</p>
</td>
<td>
<p>41</p>
</td>
<td>
<p>42</p>
</td>
<td>
<p>43</p>
</td>
<td>
<p>44</p>
</td>
<td>
<p>45</p>
</td>
<td>
<p>46</p>
</td>
<td>
<p>CD</p>
</td>
<td>
<p>AB</p>
</td>
<td>
<p>End of Sector 4</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The last two bytes of each sector have been copied into the
Update Sequence Array, and the Update Sequence Number has been
written over the last two bytes of each sector.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4800988" id="id4800988"></a>The
Details</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4800994" id="id4800994"></a>Writing</h4>
</div>
</div>
</div>
<p>Before writing a fixup-protected record:</p>
<div class="orderedlist">
<ol type="1">
<li>
<p>Add one to the Update Sequence Number (0x0000 must be
skipped)</p>
</li>
<li>
<p>For each sector, copy the last two bytes into the Update
Sequence Array</p>
</li>
<li>
<p>Write the new Update Sequence Number to the end of each
sector</p>
</li>
<li>
<p>Write the record to disk</p>
</li>
</ol>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4801042" id="id4801042"></a>Reading</h4>
</div>
</div>
</div>
<p>When reading a fixup-protected record:</p>
<div class="orderedlist">
<ol type="1">
<li>
<p>Read the record from disk</p>
</li>
<li>
<p>Check the magic number is correct</p>
</li>
<li>
<p>Read the Update Sequence Number</p>
</li>
<li>
<p>Compare it against the last two bytes of every sector</p>
</li>
<li>
<p>Copy the contents of the Update Sequence Array to the correct
places</p>
</li>
<li>
<p>If any of the checks fail when reading, it could mean there is:
a bad sector, disk corruption or a fault in the driver.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_index_header" id="concept_index_header"></a>Concept -
Index Header</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4801118" id="id4801118"></a>Overview</h3>
</div>
</div>
</div>
<p>Every Index Record has a standard header and a set of blocks
containing an Index Key and Index Data.</p>
<p>The size of an Index Record is defined in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">$Boot</a> and always seems to be
4KB.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4801141" id="id4801141"></a>Layout</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4801146" id="id4801146"></a>Standard
Index Header</h4>
</div>
</div>
</div>
<div class="table"><a name="id4801152" id="id4801152"></a>
<p class="title"><b>Table&nbsp;4.26.&nbsp;Layout of a Standard
Index Header</b></p>
<table summary="Layout of a Standard Index Header" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>0x00</td>
<td>4</td>
<td>Magic number 'INDX'</td>
</tr>
<tr>
<td>0x04</td>
<td>2</td>
<td>Offset to the Update Sequence</td>
</tr>
<tr>
<td>0x06</td>
<td>2</td>
<td>Size in words of the Update Sequence Number &amp;Array (S)</td>
</tr>
<tr>
<td>0x08</td>
<td>8</td>
<td>$LogFile sequence number</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>VCN of this INDX buffer in the Index Allocation</td>
</tr>
<tr>
<td>0x18</td>
<td>4</td>
<td>Offset to the Index Entries (a)</td>
</tr>
<tr>
<td>0x1C</td>
<td>4</td>
<td>Size of Index Entries (a)</td>
</tr>
<tr>
<td>0x20</td>
<td>4</td>
<td>Allocated size of the Index Entries (a)</td>
</tr>
<tr>
<td>0x24</td>
<td>1</td>
<td>1 if not leaf node (b)</td>
</tr>
<tr>
<td>0x25</td>
<td>3</td>
<td>Padding (always zero)</td>
</tr>
<tr>
<td>0x28</td>
<td>2</td>
<td>Update sequence</td>
</tr>
<tr>
<td>0x2A</td>
<td>2S-2</td>
<td>Update sequence array</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">(a) These values are relative to 0x18
(b) Has children
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4801378" id="id4801378"></a>Notes</h3>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4801383" id="id4801383"></a>List of
Common Indexes</h4>
</div>
</div>
</div>
<div class="table"><a name="id4801389" id="id4801389"></a>
<p class="title"><b>Table&nbsp;4.27.&nbsp;List of Common
Indexes</b></p>
<table summary="List of Common Indexes" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Name</th>
<th>Index Of</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_i30">$I30</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">Filenames</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">Used
by Directories</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sdh">$SDH</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">Security
Descriptors</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$Secure</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sii">$SII</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">Security
Ids</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">$Secure</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_o">$O</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">Object
Ids</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">$ObjId</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_o">$O</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">Owner Ids</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_q">$Q</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">Quotas</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">$Quota</a></td>
</tr>
<tr>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_r">$R</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">Reparse Points</a></td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse" title="NTFS Files: $Reparse (Any)">$Reparse</a></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4801670" id="id4801670"></a>Other
Information</h4>
</div>
</div>
</div>
<p>There is no information contained in the Index Record describing
what the index is storing (this is kept in the Index Root).</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_index_record" id="concept_index_record"></a>Concept -
Index Record</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4801694" id="id4801694"></a>Overview</h3>
</div>
</div>
</div>
<pre class="programlisting">This is only applicable to a file index ($I30)

    indx help describe as "index = key + data"

    given an INDX record, it's difficult to work out what's
    being indexed (that info is in the index root)
                        
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4801710" id="id4801710"></a>Definition</h3>
</div>
</div>
</div>
<p>This is a sub-node of the B+ tree that implements an index (e.g.
a directory). It is stored in the stream of the index allocation
attribute associated to the index it belongs to.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4801723" id="id4801723"></a>Layout</h3>
</div>
</div>
</div>
<p>An INDX buffer is at least 2 KB large or the cluster size if
larger (this seems to be a per-index parameter). It falls into 2
parts:</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4801734" id="id4801734"></a>The header
part</h4>
</div>
</div>
</div>
<p>this ISN'T just the header...</p>
<div class="table"><a name="id4801744" id="id4801744"></a>
<p class="title"><b>Table&nbsp;4.28.&nbsp;Layout of an Index record
header</b></p>
<table summary="Layout of an Index record header" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Offset</th>
<th>Size</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>~</td>
<td>~</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_header" title="Concept - Index Header">Standard Index Header</a></td>
</tr>
<tr>
<td>0x00</td>
<td>8</td>
<td>MFT Reference of the file</td>
</tr>
<tr>
<td>0x08</td>
<td>2</td>
<td>Size of this index entry</td>
</tr>
<tr>
<td>0x0A</td>
<td>2</td>
<td>Offset to the filename</td>
</tr>
<tr>
<td>0x0C</td>
<td>2</td>
<td>Index Flags</td>
</tr>
<tr>
<td>0x0E</td>
<td>2</td>
<td>Padding (align to 8 bytes)</td>
</tr>
<tr>
<td>0x10</td>
<td>8</td>
<td>MFT File Reference of the parent</td>
</tr>
<tr>
<td>0x18</td>
<td>8</td>
<td>File creation time</td>
</tr>
<tr>
<td>0x20</td>
<td>8</td>
<td>Last modification time</td>
</tr>
<tr>
<td>0x28</td>
<td>8</td>
<td>Last modification time for FILE record</td>
</tr>
<tr>
<td>0x30</td>
<td>8</td>
<td>Last access time</td>
</tr>
<tr>
<td>0x38</td>
<td>8</td>
<td>Allocated size of file</td>
</tr>
<tr>
<td>0x40</td>
<td>8</td>
<td>Real size of file</td>
</tr>
<tr>
<td>0x48</td>
<td>8</td>
<td>File Flags</td>
</tr>
<tr>
<td>0x50</td>
<td>1</td>
<td>Length of filename (F)</td>
</tr>
<tr>
<td>0x51</td>
<td>1</td>
<td><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace" title="Concept - Filename Namespace">Filename namespace</a></td>
</tr>
<tr>
<td>0x52</td>
<td>2F</td>
<td>Filename</td>
</tr>
<tr>
<td>2F+0x52</td>
<td>P</td>
<td>Padding (align to 8 bytes)</td>
</tr>
<tr>
<td>P+2F+0x52</td>
<td>8</td>
<td>VCN of index buffer with sub-nodes</td>
</tr>
</tbody>
</table>
</div>
<pre class="programlisting">    N.B. the filename is not null terminated
    surely the flags can't be 8 bytes long
    table for the flags
    VCN of ib only exists when flags&amp;1
    last entry has a size of 0x10 (just large enough
    for the flags (and a mft ref of zero))
                                
</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h4 class="title"><a name="id4802079" id="id4802079"></a>The
sequence of index entries part</h4>
</div>
</div>
</div>
<p>This is a sequence of index entries similar to the one found in
the index root attribute.</p>
<p>The index entry has the following structure:</p>
<pre class="programlisting">    Index entry flags (16-bit).

    INDEX_ENTRY_NODE = cpu_to_le16(1), This entry contains a sub-node,
                      i.e. a reference to an index
                      block in form of a virtual
                      cluster number (see below).
    INDEX_ENTRY_END  = cpu_to_le16(2), This signifies the last entry in
                      an index block. The index entry
                      does not represent a file but it
                      can point to a sub-node.

    This is an index entry. A sequence of such entries follows each INDEX_HEADER
    structure. Together they make up a complete index. The index follows either
    an index root attribute or an index allocation attribute.

    NOTE: Before NTFS 3.0 only filename attributes were indexed.
                                
</pre>
<p>Most entries are not valid (and present) if the entry is the
last one. This entry does not represent a file and is used only for
subnodes. The pointer to the subnode buffer is only present if the
entry has subnodes.</p>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_links" id="concept_links"></a>Concept - Links</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4802132" id="id4802132"></a>Overview</h3>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4802140" id="id4802140"></a>Interest</h3>
</div>
</div>
</div>
<p>NTFS doesn't manage POSIX symbolic links. Nevertheless, this
file attribute let us think that NTFS will manage symbolic links
(or Reparse point, in Microsoft terminology) in Windows NT 5.0,
like all modern Unix filesystems (e.g. Ext2, the Linux filesystem)
do.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4802155" id="id4802155"></a>Questions</h3>
</div>
</div>
</div>
<p>What is the role and the layout of the stream of this file
attribute?</p>
<pre class="programlisting">    NTFS represents POSIX-style hard links as files with multiple filename
    NTFS represents hard links with multiple filenames.
    This is different to one file with names in different namespaces.
    Delete a name from a hard linked file and only the name will be removed.
                        
</pre></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_restart" id="concept_restart"></a>Concept - Restart</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4802186" id="id4802186"></a>Overview</h3>
</div>
</div>
</div>
<p>Each copy of the restart area is 4KB in size, and has the
following structure:</p>
<pre class="programlisting">Offset(length)         Description
0(4)                   Magic number 'RSTR'
1E(12)                 Fixup
30(4)                  LSNa
58(4)                  LSNb
60(4)                  LSNc (==LSNa?)
6C(1)                  Volume clear flag
78(8)                  Unicode string 'NTFS'
                        
</pre>
<p>The purpose of the various LSNs is unclear. It appears that the
data around offset 3C deal with the clear/dirty state of the
volume, too.</p>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_sid" id="concept_sid"></a>Concept - SID</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4802224" id="id4802224"></a>Overview</h3>
</div>
</div>
</div>
<p>There are several SIDs reserved for NT.</p>
<pre class="programlisting">    link back to sec page
                        
</pre>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">sec</a></p>
<pre class="programlisting">    S-1-5-21-646518322-1873620750-619646970-1110
    S for security id
    1 Revision level
    5 Identifier Authority (48 bit) 5 = logon id
    21 Sub-authority (21 = nt non unique)
    646518322        SA
    1873620750        SA domain id
    619646970        SA
    1110        user id
                        
</pre>
<div class="table"><a name="id4802261" id="id4802261"></a>
<p class="title"><b>Table 4.29. Common well known SIDs</b></p>
<table summary="Common well known SIDs" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>SID</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>S-1-5-32-544</td>
<td>Local admin.</td>
</tr>
<tr>
<td>S-1-1-0</td>
<td>World (everybody)</td>
</tr>
<tr>
<td>S-1-5-21</td>
<td>NT non-unique ids</td>
</tr>
</tbody>
</table>
</div>
<p>Identifier Authorities</p>
<div class="table"><a name="id4802333" id="id4802333"></a>
<p class="title"><b>Table 4.30. Identifier Authorities</b></p>
<table summary="Identifier Authorities" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Identifier Authority</th>
<th>Abbr.</th>
</tr>
</thead>
<tbody>
<tr>
<td>Null SID</td>
<td>S-1-0</td>
</tr>
<tr>
<td>World SID</td>
<td>S-1-1</td>
</tr>
<tr>
<td>Local SID</td>
<td>S-1-2</td>
</tr>
<tr>
<td>Creator SID</td>
<td>S-1-3</td>
</tr>
<tr>
<td>Non-unique</td>
<td>S-1-4</td>
</tr>
<tr>
<td>NT SID</td>
<td>S-1-5</td>
</tr>
</tbody>
</table>
</div>
<p>Relative Identifiers (RIDs)</p>
<pre class="programlisting">    These relative identifiers (RIDs) are used with the above identifier
    authorities to make up universal well-known SIDs.

    Note: The relative identifier (RID) refers to the portion of a SID, which
    identifies a user or group in relation to the authority that issued the SID.
    For example, the universal well-known SID Creator Owner ID (S-1-3-0) is
    made up of the identifier authority SECURITY_CREATOR_SID_AUTHORITY (3) and
    the relative identifier SECURITY_CREATOR_OWNER_RID (0).
                        
</pre>
<p>Relative Identifiers</p>
<div class="table"><a name="id4802453" id="id4802453"></a>
<p class="title"><b>Table 4.31. Relative Identifiers</b></p>
<table summary="Relative Identifiers" border="1">
<colgroup>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Relative Identifier</th>
<th>Code</th>
<th>SID</th>
</tr>
</thead>
<tbody>
<tr>
<td>Null</td>
<td>0</td>
<td>S-1-0-0</td>
</tr>
<tr>
<td>World</td>
<td>0</td>
<td>S-1-1-0</td>
</tr>
<tr>
<td>Local</td>
<td>0</td>
<td>S-1-2-0</td>
</tr>
<tr>
<td>Creator Owner</td>
<td>0</td>
<td>S-1-3-0</td>
</tr>
<tr>
<td>Creator Group</td>
<td>1</td>
<td>S-1-3-1</td>
</tr>
<tr>
<td>Creator Owner Server</td>
<td>2</td>
<td>S-1-3-2</td>
</tr>
<tr>
<td>Creator Group Server</td>
<td>3</td>
<td>S-1-3-3</td>
</tr>
<tr>
<td>Dialup</td>
<td>1</td>
<td>S-1-5-1</td>
</tr>
<tr>
<td>Network</td>
<td>2</td>
<td>S-1-5-2</td>
</tr>
<tr>
<td>Batch</td>
<td>3</td>
<td>S-1-5-3</td>
</tr>
<tr>
<td>Interactive</td>
<td>4</td>
<td>S-1-5-4</td>
</tr>
<tr>
<td>Logon Ids</td>
<td>5</td>
<td>S-1-5-5-X-Y</td>
</tr>
<tr>
<td>Service</td>
<td>6</td>
<td>S-1-5-6</td>
</tr>
<tr>
<td>Anonymous Logon</td>
<td>7</td>
<td>S-1-5-7</td>
</tr>
<tr>
<td>Proxy</td>
<td>8</td>
<td>S-1-5-8</td>
</tr>
<tr>
<td>Enterprise Controllers</td>
<td>9</td>
<td>S-1-5-9</td>
</tr>
<tr>
<td>Server Logon</td>
<td>9</td>
<td>S-1-5-9</td>
</tr>
<tr>
<td>Principal Self</td>
<td>10</td>
<td>S-1-5-10</td>
</tr>
<tr>
<td>Authenticated User</td>
<td>11</td>
<td>S-1-5-11</td>
</tr>
<tr>
<td>Restricted Code</td>
<td>12</td>
<td>S-1-5-12</td>
</tr>
<tr>
<td>Terminal Server</td>
<td>13</td>
<td>S-1-5-13</td>
</tr>
<tr>
<td>Local System</td>
<td>18</td>
<td>S-1-5-18</td>
</tr>
<tr>
<td>NT Non-unique</td>
<td>21</td>
<td>S-1-5-21</td>
</tr>
<tr>
<td>Builtin Domain</td>
<td>32</td>
<td>S-1-5-32</td>
</tr>
</tbody>
</table>
</div>
<p>Well-known domain relative sub-authority values (RIDs).</p>
<p>Domain Users</p>
<div class="table"><a name="id4802828" id="id4802828"></a>
<p class="title"><b>Table 4.32. Domain Users</b></p>
<table summary="Domain Users" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Domain User</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Admin</td>
<td>500</td>
</tr>
<tr>
<td>Guest</td>
<td>501</td>
</tr>
<tr>
<td>Kerberos Target</td>
<td>502</td>
</tr>
</tbody>
</table>
</div>
<p>Domain Groups</p>
<div class="table"><a name="id4802899" id="id4802899"></a>
<p class="title"><b>Table 4.33. Domain Groups</b></p>
<table summary="Domain Groups" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Domain Group</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Admins</td>
<td>512</td>
</tr>
<tr>
<td>Users</td>
<td>513</td>
</tr>
<tr>
<td>Guests</td>
<td>514</td>
</tr>
<tr>
<td>Computers</td>
<td>515</td>
</tr>
<tr>
<td>Controllers</td>
<td>516</td>
</tr>
<tr>
<td>Cert Admins</td>
<td>517</td>
</tr>
<tr>
<td>Schema Admins</td>
<td>518</td>
</tr>
<tr>
<td>Enterprise Admins</td>
<td>519</td>
</tr>
<tr>
<td>Policy Admins</td>
<td>520</td>
</tr>
</tbody>
</table>
</div>
<p>Domain Aliases</p>
<div class="table"><a name="id4803030" id="id4803030"></a>
<p class="title"><b>Table 4.34. Domain Aliases</b></p>
<table summary="Domain Aliases" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>Domain Alias</th>
<th>Code</th>
</tr>
</thead>
<tbody>
<tr>
<td>Admins</td>
<td>544</td>
</tr>
<tr>
<td>Users</td>
<td>545</td>
</tr>
<tr>
<td>Guests</td>
<td>546</td>
</tr>
<tr>
<td>Power Users</td>
<td>547</td>
</tr>
<tr>
<td>Account Ops</td>
<td>548</td>
</tr>
<tr>
<td>System Ops</td>
<td>549</td>
</tr>
<tr>
<td>Print Ops</td>
<td>550</td>
</tr>
<tr>
<td>Backup Ops</td>
<td>551</td>
</tr>
<tr>
<td>Replicator</td>
<td>552</td>
</tr>
<tr>
<td>RAS Servers</td>
<td>553</td>
</tr>
<tr>
<td>Pre W2K Comp Access</td>
<td>554</td>
</tr>
</tbody>
</table>
</div>
<p>Universal well-known SIDs</p>
<div class="table"><a name="id4803184" id="id4803184"></a>
<p class="title"><b>Table 4.35. Universal well-known SIDs</b></p>
<table summary="Universal well-known SIDs" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>SID</th>
<th>Abbr.</th>
</tr>
</thead>
<tbody>
<tr>
<td>Null</td>
<td>S-1-0-0</td>
</tr>
<tr>
<td>World</td>
<td>S-1-1-0</td>
</tr>
<tr>
<td>Local</td>
<td>S-1-2-0</td>
</tr>
<tr>
<td>Creator Owner</td>
<td>S-1-3-0</td>
</tr>
<tr>
<td>Creator Group</td>
<td>S-1-3-1</td>
</tr>
<tr>
<td>Creator Owner Server</td>
<td>S-1-3-2</td>
</tr>
<tr>
<td>Creator Group Server</td>
<td>S-1-3-3</td>
</tr>
<tr>
<td>Non-unique IDs</td>
<td>S-1-4</td>
</tr>
</tbody>
</table>
</div>
<p>NT well-known SIDs</p>
<div class="table"><a name="id4803306" id="id4803306"></a>
<p class="title"><b>Table 4.36. NT well-known SIDs</b></p>
<table summary="NT well-known SIDs" border="1">
<colgroup>
<col>
<col></colgroup>
<thead>
<tr>
<th>SID</th>
<th>Abbr.</th>
</tr>
</thead>
<tbody>
<tr>
<td>NT Authority</td>
<td>S-1-5</td>
</tr>
<tr>
<td>Dialup</td>
<td>S-1-5-1</td>
</tr>
<tr>
<td>Network</td>
<td>S-1-5-2</td>
</tr>
<tr>
<td>Batch</td>
<td>S-1-5-3</td>
</tr>
<tr>
<td>Interactive</td>
<td>S-1-5-4</td>
</tr>
<tr>
<td>Service</td>
<td>S-1-5-6</td>
</tr>
<tr>
<td>Anonymous Logon (Null Logon)</td>
<td>S-1-5-7</td>
</tr>
<tr>
<td>Proxy</td>
<td>S-1-5-8</td>
</tr>
<tr>
<td>Server Logon (Domain Controller)</td>
<td>S-1-5-9</td>
</tr>
<tr>
<td>Self</td>
<td>S-1-5-10</td>
</tr>
<tr>
<td>Authenticated User</td>
<td>S-1-5-11</td>
</tr>
<tr>
<td>Restricted Code</td>
<td>S-1-5-12</td>
</tr>
<tr>
<td>Terminal Server</td>
<td>S-1-5-13</td>
</tr>
<tr>
<td>Logon IDs</td>
<td>S-1-5-5-X-Y</td>
</tr>
<tr>
<td>NT Non-unique IDs</td>
<td>S-1-5-21-...</td>
</tr>
<tr>
<td>Built-in Domain</td>
<td>S-1-5-32</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="concept_sparse" id="concept_sparse"></a>Concept - Sparse</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4803518" id="id4803518"></a>Overview</h3>
</div>
</div>
</div>
<p>Sparse files</p>
<pre class="programlisting">    fix the data runs page for NT4 (old style)
    13 b8 ae 04 ff 00     old
    03 b8 ae 04 00        new
    bad clus on NT4 sparse data runs use -1!
                        
</pre></div>
</div>
</div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="epilogue" id="epilogue"></a>Chapter&nbsp;5.&nbsp;Epilogue</h2>
</div>
</div>
</div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4815632">ToDo</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#unanswered_questions">Unanswered Questions</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#history">History</a></span></dt>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="id4815632" id="id4815632"></a>ToDo</h2>
</div>
</div>
</div>
<p>Unless otherwise specified, each item is a rewrite /
overhaul.</p>
<p>Urgent</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Security</p>
</li>
<li>
<p>Log</p>
</li>
<li>
<p>Index Root</p>
</li>
<li>
<p>Attribute Id</p>
</li>
<li>
<p>FILE Record</p>
</li>
</ul>
</div>
<p>Medium</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Cross-ref $Secure</p>
</li>
<li>
<p>Cross-ref $Quota</p>
</li>
<li>
<p>Attribute List</p>
</li>
<li>
<p>Logged Utility Stream</p>
</li>
<li>
<p>Compression</p>
</li>
<li>
<p>Data Runs</p>
</li>
<li>
<p>Directory</p>
</li>
<li>
<p>File</p>
</li>
<li>
<p>Index Header</p>
</li>
<li>
<p>Index Record</p>
</li>
<li>
<p>Sparse files</p>
</li>
</ul>
</div>
<p>Low</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Res/Non-res in Overview</p>
</li>
<li>
<p>Table (P8) sizes</p>
</li>
<li>
<p>Data</p>
</li>
<li>
<p>Reparse Point</p>
</li>
<li>
<p>File Reference</p>
</li>
<li>
<p>USN confusion</p>
</li>
<li>
<p>Remove Links?</p>
</li>
<li>
<p>Restart</p>
</li>
<li>
<p>SID</p>
</li>
<li>
<p>Glossary</p>
</li>
</ul>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="unanswered_questions" id="unanswered_questions"></a>Unanswered
Questions</h2>
</div>
</div>
</div>
<p>This, final, section of the documentation is the place for all
the unanswered questions. Some relate to Windows' use of NTFS and
some are very technical.</p>
<p>Your help is needed to fill in the blanks.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Why do some Metadata files on NTFS 3.0+ still have Security
Descriptors?</p>
<p>On NTFS 3.0+, $Volume, $AttrDef, dot and $Boot have Security
Descriptors. Is this to save time at boot up? Perhaps to reduce the
number of files it has to parse? Or is this the same as the
previous question?</p>
</li>
<li>
<p>$STANDARD_INFORMATION: Max Versions, Version Number and Class
Id?</p>
<p>Are any of the three fields used?</p>
</li>
<li>
<p>Is $UsnJrnl's $J Data Stream a fixed size?</p>
<p>Is it a fixed size? Does it wrap around like $LogFile?</p>
</li>
<li>
<p>What does $UsnJrnl's $Max Data Stream do?</p>
<p>There's a time stamp, two fields that might be flags and a field
that might be a length.</p>
</li>
<li>
<p>Attribute Header</p>
<p>When is "Initialised" not the same size as "Real"?</p>
</li>
<li>
<p>$MountMgrDatabase</p>
<p>What is the format of this stream?</p>
</li>
<li>
<p>MFT (FILE) Records</p>
<p>Will we only see MFT Extension records with inodes &lt;23? Is
the sequence number always equal to the inode number for the
Metadata?</p>
</li>
<li>
<p>MFT Mirr</p>
<p>How large is this if the cluster size is greater than 4kB?</p>
</li>
<li>
<p>Index Records</p>
<p>Are they always 4kB?</p>
</li>
<li>
<p>Collation</p>
<p>Is a collation type ULONGS equivalent to GUID?</p>
</li>
<li>
<p>Security Descriptors</p>
<p>How are ACEs inherited?</p>
</li>
</ul>
</div>
<p>ToDo: copy questions to relevant pages and x-link.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="history" id="history"></a>History</h2>
</div>
</div>
</div>
<p>Version 0.6</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Conversion to DocBook:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Reordering files as chapters and sections.</p>
</li>
<li>
<p>Removed/Reauthored paragraphs related specifically to the html
format.</p>
</li>
<li>
<p>Titled sections and tables.</p>
</li>
<li>
<p>Line breaks became new paragraphs or removed.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Presentation changes:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Moving "Notes" and "Other information" to the bottom of each
section.</p>
</li>
<li>
<p>Removed illustrations from the Tree concept (will be returned in
the future).</p>
</li>
<li>
<p>Removed empty sections.</p>
</li>
<li>
<p>Data Runs examples are described now in tables.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Version 0.5</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>New:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Added a link to the NTFS FAQ.</p>
</li>
<li>
<p>Added the tree concept.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Tidied, Fixed or Rewritten:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Fixed the 3rd data run example.</p>
</li>
<li>
<p>Add directory &amp; Index View flags to the FileName
attribute.</p>
</li>
<li>
<p>More info about Reparse Points.</p>
</li>
<li>
<p>More info about $usnjrnl.</p>
</li>
<li>
<p>Updated $boot.</p>
</li>
<li>
<p>Updated $mftmirr.</p>
</li>
<li>
<p>Updated Security Descriptor attribute.</p>
</li>
<li>
<p>Fixed a minor error in the attribute header concept.</p>
</li>
<li>
<p>Fixed a minor error in the file record concept.</p>
</li>
<li>
<p>Fixed a type in the clusters concept.</p>
</li>
<li>
<p>Updated the thanks page.</p>
</li>
</ul>
</div>
</li>
<li>
<p>HTML Improvements:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Added an icon to the html meta</p>
</li>
<li>
<p>Moved the help menu to the front page</p>
</li>
<li>
<p>Added the SF logo and a copyright to the footer</p>
</li>
<li>
<p>Change the contact email to a picture.</p>
</li>
<li>
<p>Removed a link from the glossary to the obsolete property_set
page.</p>
</li>
<li>
<p>Removed the contact info from the footer</p>
</li>
<li>
<p>Fixed a link to sourceforge (removed the www. prefix).</p>
</li>
<li>
<p>CSS updates.</p>
</li>
<li>
<p>Whitespace cleanup</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Version 0.4</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>New:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>List of all Data Streams and Indexes</p>
</li>
<li>
<p>Pages: About, Collation and SID</p>
</li>
<li>
<p>(Some) info about XP</p>
</li>
<li>
<p>Info about $Q, $O and $R</p>
</li>
<li>
<p>Info about the MFT Zone</p>
</li>
<li>
<p>More info about Indexes</p>
</li>
<li>
<p>Load of new Glossay entries</p>
</li>
</ul>
</div>
</li>
<li>
<p>Tidied, Fixed or Rewritten:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Standard Information, Filename, Fixup</p>
</li>
<li>
<p>Standardise naming of the four time fields</p>
</li>
<li>
<p>Standardise naming of the three file size fields</p>
</li>
<li>
<p>Minor improvements to Bitmap and Quota</p>
</li>
</ul>
</div>
</li>
<li>
<p>HTML Improvements:</p>
<div class="itemizedlist">
<ul type="circle">
<li>
<p>Standardised tables</p>
</li>
<li>
<p>Footnote links on every page: Validate HTML, CSS and Online</p>
</li>
<li>
<p>Next / Prev links cycle through the index</p>
</li>
<li>
<p>Better CSS compliance</p>
</li>
<li>
<p>Added keywords to aid search engines</p>
</li>
<li>
<p>Tweaked fonts</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Version 0.3</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Worked in Anton's header files</p>
</li>
<li>
<p>New page for Collation</p>
</li>
<li>
<p>New page for Index Header</p>
</li>
<li>
<p>New page for $UsnJrnl</p>
</li>
<li>
<p>Reworked Index Record page</p>
</li>
<li>
<p>New info for $ObjId</p>
</li>
<li>
<p>New info for $Quota</p>
</li>
<li>
<p>New info for $Secure</p>
</li>
<li>
<p>New info for $Reparse</p>
</li>
<li>
<p>$MountMgrDatabase added to dot</p>
</li>
<li>
<p>Reworked $MFT page</p>
</li>
<li>
<p>Lots of tidying up</p>
</li>
</ul>
</div>
<p>Version 0.2</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>Put everything under CVS control on SourceForge</p>
</li>
<li>
<p>Added $Id CVS tag to the end of every file</p>
</li>
<li>
<p>Added full path to the beginning of every file</p>
</li>
<li>
<p>Fixed up CSS so old version of Netscape should look OK</p>
</li>
<li>
<p>Updated $AttrDef</p>
</li>
<li>
<p>Updated $EA</p>
</li>
<li>
<p>Updated $EA_INFORMATION</p>
</li>
<li>
<p>Updated $FILE_NAME</p>
</li>
<li>
<p>Updated $STANDARD_INFORMATION</p>
</li>
<li>
<p>Updated $VOLUME_INFORMATION</p>
</li>
<li>
<p>Wrote entries for all the glossary items</p>
</li>
<li>
<p>Access keys for Previous and Next , and .</p>
</li>
<li>
<p>Fixed lots of typos</p>
</li>
</ul>
</div>
<p>Version 0.1</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>First public release, based on the very old "original docs"</p>
</li>
</ul>
</div>
</div>
</div>
<div class="appendix" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="appendix_license" id="appendix_license"></a>Appendix&nbsp;Appendix I.&nbsp;License</h2>
</div>
</div>
</div>
<div class="toc">
<p><b>Table of Contents</b></p>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817137">GNU Free
Documentation License</a></span></dt>
<dd>
<dl>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817143">Version 1.1, March
2000</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817160">0.
PREAMBLE</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4817838">1. APPLICABILITY AND
DEFINITIONS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818004">2. VERBATIM
COPYING</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818029">3. COPYING IN
QUANTITY</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818096">4.
MODIFICATIONS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818352">5. COMBINING
DOCUMENTS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818409">6. COLLECTIONS OF
DOCUMENTS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818433">7. AGGREGATION WITH
INDEPENDENT WORKS</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818474">8.
TRANSLATION</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818494">9.
TERMINATION</a></span></dt>
<dt><span class="section"><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#id4818512">10. FUTURE REVISIONS
OF THIS LICENSE</a></span></dt>
</dl>
</dd>
</dl>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both"><a name="id4817137" id="id4817137"></a>GNU Free Documentation License</h2>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4817143" id="id4817143"></a>Version
1.1, March 2000</h3>
</div>
</div>
</div>
<p>Copyright (C) 2000 Free Software Foundation, Inc. 59 Temple
Place, Suite 330, Boston, MA 02111-1307 USA</p>
<p>Everyone is permitted to copy and distribute verbatim copies of
this license document, but changing it is not allowed.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4817160" id="id4817160"></a>0.
PREAMBLE</h3>
</div>
</div>
</div>
<p>The purpose of this License is to make a manual, textbook, or
other written document <span class="emphasis"><em>free</em></span>
in the sense of freedom: to assure everyone the effective freedom
to copy and redistribute it, with or without modifying it, either
commercially or noncommercially. Secondarily, this License
preserves for the author and publisher a way to get credit for
their work, while not being considered responsible for
modifications made by others.</p>
<p>This License is a kind of <span class="emphasis"><em>copyleft</em></span>, which means that derivative
works of the document must themselves be free in the same sense. It
complements the GNU General Public License, which is a copyleft
license designed for free software.</p>
<p>We have designed this License in order to use it for manuals for
free software, because free software needs free documentation: a
free program should come with manuals providing the same freedoms
that the software does. But this License is not limited to software
manuals; it can be used for any textual work, regardless of subject
matter or whether it is published as a printed book. We recommend
this License principally for works whose purpose is instruction or
reference.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4817838" id="id4817838"></a>1.
APPLICABILITY AND DEFINITIONS</h3>
</div>
</div>
</div>
<p>This License applies to any manual or other work that contains a
notice placed by the copyright holder saying it can be distributed
under the terms of this License. The <span class="emphasis"><em>Document</em></span>, below, refers to any such
manual or work. Any member of the public is a licensee, and is
addressed as <span class="emphasis"><em>you</em></span>.</p>
<p>A <span class="emphasis"><em>Modified Version</em></span> of the
Document means any work containing the Document or a portion of it,
either copied verbatim, or with modifications and/or translated
into another language.</p>
<p>A <span class="emphasis"><em>Secondary Section</em></span> is a
named appendix or a front-matter section of the Document that deals
exclusively with the relationship of the publishers or authors of
the Document to the Document's overall subject (or to related
matters) and contains nothing that could fall directly within that
overall subject. (For example, if the Document is in part a
textbook of mathematics, a Secondary Section may not explain any
mathematics.) The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.</p>
<p>The <span class="emphasis"><em>Invariant Sections</em></span>
are certain Secondary Sections whose titles are designated, as
being those of Invariant Sections, in the notice that says that the
Document is released under this License.</p>
<p>The <span class="emphasis"><em>Cover Texts</em></span> are
certain short passages of text that are listed, as Front-Cover
Texts or Back-Cover Texts, in the notice that says that the
Document is released under this License.</p>
<p>A <span class="emphasis"><em>Transparent</em></span> copy of the
Document means a machine-readable copy, represented in a format
whose specification is available to the general public, whose
contents can be viewed and edited directly and straightforwardly
with generic text editors or (for images composed of pixels)
generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters
or for automatic translation to a variety of formats suitable for
input to text formatters. A copy made in an otherwise Transparent
file format whose markup has been designed to thwart or discourage
subsequent modification by readers is not Transparent. A copy that
is not <span class="emphasis"><em>Transparent</em></span> is called
<span class="emphasis"><em>Opaque</em></span>.</p>
<p>Examples of suitable formats for Transparent copies include
plain ASCII without markup, Texinfo input format, LaTeX input
format, SGML or XML using a publicly available DTD, and
standard-conforming simple HTML designed for human modification.
Opaque formats include PostScript, PDF, proprietary formats that
can be read and edited only by proprietary word processors, SGML or
XML for which the DTD and/or processing tools are not generally
available, and the machine-generated HTML produced by some word
processors for output purposes only.</p>
<p>The <span class="emphasis"><em>Title Page</em></span> means, for
a printed book, the title page itself, plus such following pages as
are needed to hold, legibly, the material this License requires to
appear in the title page. For works in formats which do not have
any title page as such, <span class="emphasis"><em>Title
Page</em></span> means the text near the most prominent appearance
of the work's title, preceding the beginning of the body of the
text.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818004" id="id4818004"></a>2.
VERBATIM COPYING</h3>
</div>
</div>
</div>
<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License
applies to the Document are reproduced in all copies, and that you
add no other conditions whatsoever to those of this License. You
may not use technical measures to obstruct or control the reading
or further copying of the copies you make or distribute. However,
you may accept compensation in exchange for copies. If you
distribute a large enough number of copies you must also follow the
conditions in section 3.</p>
<p>You may also lend copies, under the same conditions stated
above, and you may publicly display copies.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818029" id="id4818029"></a>3. COPYING
IN QUANTITY</h3>
</div>
</div>
</div>
<p>If you publish printed copies of the Document numbering more
than 100, and the Document's license notice requires Cover Texts,
you must enclose the copies in covers that carry, clearly and
legibly, all these Cover Texts: Front-Cover Texts on the front
cover, and Back-Cover Texts on the back cover. Both covers must
also clearly and legibly identify you as the publisher of these
copies. The front cover must present the full title with all words
of the title equally prominent and visible. You may add other
material on the covers in addition. Copying with changes limited to
the covers, as long as they preserve the title of the Document and
satisfy these conditions, can be treated as verbatim copying in
other respects.</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto
adjacent pages.</p>
<p>If you publish or distribute Opaque copies of the Document
numbering more than 100, you must either include a machine-readable
Transparent copy along with each Opaque copy, or state in or with
each Opaque copy a publicly-accessible computer-network location
containing a complete Transparent copy of the Document, free of
added material, which the general network-using public has access
to download anonymously at no charge using public-standard network
protocols. If you use the latter option, you must take reasonably
prudent steps, when you begin distribution of Opaque copies in
quantity, to ensure that this Transparent copy will remain thus
accessible at the stated location until at least one year after the
last time you distribute an Opaque copy (directly or through your
agents or retailers) of that edition to the public.</p>
<p>It is requested, but not required, that you contact the authors
of the Document well before redistributing any large number of
copies, to give them a chance to provide you with an updated
version of the Document.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818096" id="id4818096"></a>4.
MODIFICATIONS</h3>
</div>
</div>
</div>
<p>You may copy and distribute a Modified Version of the Document
under the conditions of sections 2 and 3 above, provided that you
release the Modified Version under precisely this License, with the
Modified Version filling the role of the Document, thus licensing
distribution and modification of the Modified Version to whoever
possesses a copy of it. In addition, you must do these things in
the Modified Version:</p>
<div class="orderedlist">
<ol type="1">
<li>
<p>Use in the Title Page (and on the covers, if any) a title
distinct from that of the Document, and from those of previous
versions (which should, if there were any, be listed in the History
section of the Document). You may use the same title as a previous
version if the original publisher of that version gives
permission.</p>
</li>
<li>
<p>List on the Title Page, as authors, one or more persons or
entities responsible for authorship of the modifications in the
Modified Version, together with at least five of the principal
authors of the Document (all of its principal authors, if it has
less than five).</p>
</li>
<li>
<p>State on the Title page the name of the publisher of the
Modified Version, as the publisher.</p>
</li>
<li>
<p>Preserve all the copyright notices of the Document.</p>
</li>
<li>
<p>Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.</p>
</li>
<li>
<p>Include, immediately after the copyright notices, a license
notice giving the public permission to use the Modified Version
under the terms of this License, in the form shown in the Addendum
below.</p>
</li>
<li>
<p>Preserve in that license notice the full lists of Invariant
Sections and required Cover Texts given in the Document's license
notice.</p>
</li>
<li>
<p>Include an unaltered copy of this License.</p>
</li>
<li>
<p>Preserve the section entitled <span class="emphasis"><em>History</em></span>, and its title, and add to it an
item stating at least the title, year, new authors, and publisher
of the Modified Version as given on the Title Page. If there is no
section entitled <span class="emphasis"><em>History</em></span> in
the Document, create one stating the title, year, authors, and
publisher of the Document as given on its Title Page, then add an
item describing the Modified Version as stated in the previous
sentence.</p>
</li>
<li>
<p>Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on. These may be placed in the <span class="emphasis"><em>History</em></span> section. You may omit a network
location for a work that was published at least four years before
the Document itself, or if the original publisher of the version it
refers to gives permission.</p>
</li>
<li>
<p>In any section entitled <span class="emphasis"><em>Acknowledgements</em></span> or <span class="emphasis"><em>Dedications</em></span>, preserve the section's
title, and preserve in the section all the substance and tone of
each of the contributor acknowledgements and/or dedications given
therein.</p>
</li>
<li>
<p>Preserve all the Invariant Sections of the Document, unaltered
in their text and in their titles. Section numbers or the
equivalent are not considered part of the section titles.</p>
</li>
<li>
<p>Delete any section entitled <span class="emphasis"><em>Endorsements</em></span>. Such a section may not be
included in the Modified Version.</p>
</li>
<li>
<p>Do not retitle any existing section as <span class="emphasis"><em>Endorsements</em></span> or to conflict in title
with any Invariant Section.</p>
</li>
</ol>
</div>
<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no
material copied from the Document, you may at your option designate
some or all of these sections as invariant. To do this, add their
titles to the list of Invariant Sections in the Modified Version's
license notice. These titles must be distinct from any other
section titles.</p>
<p>You may add a section entitled <span class="emphasis"><em>Endorsements</em></span>, provided it contains
nothing but endorsements of your Modified Version by various
parties--for example, statements of peer review or that the text
has been approved by an organization as the authoritative
definition of a standard.</p>
<p>You may add a passage of up to five words as a Front-Cover Text,
and a passage of up to 25 words as a Back-Cover Text, to the end of
the list of Cover Texts in the Modified Version. Only one passage
of Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity. If the Document
already includes a cover text for the same cover, previously added
by you or by arrangement made by the same entity you are acting on
behalf of, you may not add another; but you may replace the old
one, on explicit permission from the previous publisher that added
the old one.</p>
<p>The author(s) and publisher(s) of the Document do not by this
License give permission to use their names for publicity for or to
assert or imply endorsement of any Modified Version.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818352" id="id4818352"></a>5.
COMBINING DOCUMENTS</h3>
</div>
</div>
</div>
<p>You may combine the Document with other documents released under
this License, under the terms defined in section 4 above for
modified versions, provided that you include in the combination all
of the Invariant Sections of all of the original documents,
unmodified, and list them all as Invariant Sections of your
combined work in its license notice.</p>
<p>The combined work need only contain one copy of this License,
and multiple identical Invariant Sections may be replaced with a
single copy. If there are multiple Invariant Sections with the same
name but different contents, make the title of each such section
unique by adding at the end of it, in parentheses, the name of the
original author or publisher of that section if known, or else a
unique number. Make the same adjustment to the section titles in
the list of Invariant Sections in the license notice of the
combined work.</p>
<p>In the combination, you must combine any sections entitled
<span class="emphasis"><em>History</em></span> in the various
original documents, forming one section entitled <span class="emphasis"><em>History</em></span>; likewise combine any sections
entitled <span class="emphasis"><em>Acknowledgements</em></span>,
and any sections entitled <span class="emphasis"><em>Dedications</em></span>. You must delete all
sections entitled <span class="emphasis"><em>Endorsements.</em></span></p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818409" id="id4818409"></a>6.
COLLECTIONS OF DOCUMENTS</h3>
</div>
</div>
</div>
<p>You may make a collection consisting of the Document and other
documents released under this License, and replace the individual
copies of this License in the various documents with a single copy
that is included in the collection, provided that you follow the
rules of this License for verbatim copying of each of the documents
in all other respects.</p>
<p>You may extract a single document from such a collection, and
distribute it individually under this License, provided you insert
a copy of this License into the extracted document, and follow this
License in all other respects regarding verbatim copying of that
document.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818433" id="id4818433"></a>7.
AGGREGATION WITH INDEPENDENT WORKS</h3>
</div>
</div>
</div>
<p>A compilation of the Document or its derivatives with other
separate and independent documents or works, in or on a volume of a
storage or distribution medium, does not as a whole count as a
Modified Version of the Document, provided no compilation copyright
is claimed for the compilation. Such a compilation is called an
<span class="emphasis"><em>aggregate</em></span>, and this License
does not apply to the other self-contained works thus compiled with
the Document, on account of their being thus compiled, if they are
not themselves derivative works of the Document.</p>
<p>If the Cover Text requirement of section 3 is applicable to
these copies of the Document, then if the Document is less than one
quarter of the entire aggregate, the Document's Cover Texts may be
placed on covers that surround only the Document within the
aggregate. Otherwise they must appear on covers around the whole
aggregate.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818474" id="id4818474"></a>8.
TRANSLATION</h3>
</div>
</div>
</div>
<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section
4. Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections. You may include a
translation of this License provided that you also include the
original English version of this License. In case of a disagreement
between the translation and the original English version of this
License, the original English version will prevail.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818494" id="id4818494"></a>9.
TERMINATION</h3>
</div>
</div>
</div>
<p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided for under this License. Any other
attempt to copy, modify, sublicense or distribute the Document is
void, and will automatically terminate your rights under this
License. However, parties who have received copies, or rights, from
you under this License will not have their licenses terminated so
long as such parties remain in full compliance.</p>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h3 class="title"><a name="id4818512" id="id4818512"></a>10. FUTURE
REVISIONS OF THIS LICENSE</h3>
</div>
</div>
</div>
<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time. Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns. See
http://www.gnu.org/copyleft/.</p>
<p>Each version of the License is given a distinguishing version
number. If the Document specifies that a particular numbered
version of this License <span class="emphasis"><em>or any later
version</em></span> applies to it, you have the option of following
the terms and conditions either of that specified version or of any
later version that has been published (not as a draft) by the Free
Software Foundation. If the Document does not specify a version
number of this License, you may choose any version ever published
(not as a draft) by the Free Software Foundation.</p>
</div>
</div>
</div>
<div class="glossary">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="glossary" id="glossary"></a>Glossary</h2>
</div>
</div>
</div>
<div class="abstract">
<p class="title"><b>Abstract</b></p>
<p>This is a glossary of all terms.</p>
<p>Some entries refer to other entries, e.g. <span class="emphasis"><em>See also</em></span>.</p>
<p>Some entries have an entire page of their own, e.g. <span class="emphasis"><em>More...</em></span></p>
</div>
<div class="glossdiv">
<h3 class="title">Glossary</h3>
<dl>
<dt>. <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_dot">(See Dot, Root Directory)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_dot">Dot, Root Directory</a>.</p>
</dd>
<dt><a name="glossary_ace" id="glossary_ace"></a>Access Control
Entry (ACE)</dt>
<dd>
<p>An Access Control Entry is the smallest unit of security. It
contains a SID (either a user or a group) and permissions
information.</p>
<p>The permission will be one of <span class="emphasis"><em>Access
Allowed</em></span>, <span class="emphasis"><em>Access
Denied</em></span> or <span class="emphasis"><em>System
Audit</em></span>. This object has flags to determine how the
permissions should be inherited.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">Security Identifier (SID)</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">Access Control List (ACL)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_audit">Audit, Auditing</a>.</p>
</dd>
<dt><a name="glossary_acl" id="glossary_acl"></a>Access Control
List (ACL)</dt>
<dd>
<p>This security structure contains a list of ACEs.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">Security Identifier (SID)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">Access Control List (ACL)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_audit">Audit, Auditing</a>.</p>
</dd>
<dt>ACE <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_ace">(See Access Control Entry)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_ace">Access Control Entry (ACE)</a>.</p>
</dd>
<dt>ACL <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">(See Access Control List)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">Access Control List (ACL)</a>.</p>
</dd>
<dt><a name="glossary_attrdef" id="glossary_attrdef"></a>$AttrDef</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file contains the
definitions of all the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attributes</a>
that are allowed on an NTFS <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">volume</a>.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_attrdef" title="NTFS Files: $AttrDef (4)">(More...)</a></p>
</dd>
<dt><a name="glossary_attribute" id="glossary_attribute"></a>Attribute</dt>
<dd>
<p>on disk a file is stored as a set of attributes resident / non
res</p>
</dd>
<dt><a name="glossary_attribute_list" id="glossary_attribute_list"></a>$ATTRIBUTE_LIST</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> is used when a
file's attributes won't fit in a single MFT File Record. It has a
list of all the attributes and where they can be found.</p>
<p>The $ATTRIBUTE_LIST is always stored in the Base FILE
Record.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_attribute_list" title="Attribute - $ATTRIBUTE_LIST (0x20)">(More...)</a></p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE Record</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_mft">$MFT</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_base_file_record">Base FILE Record</a>.</p>
</dd>
<dt><a name="glossary_audit" id="glossary_audit"></a>Audit,
Auditing</dt>
<dd>
<p>As part of the security permissions of a file, any actions
performed on the file can be recorded.</p>
<p>For example a file could be required to log all the people who
tried to read it, but didn't have the permissions to do so.</p>
</dd>
<dt><a name="glossary_b_plus_tree" id="glossary_b_plus_tree"></a>B+
Tree</dt>
<dd>
<p>A B+ tree is a variant of the binary tree.</p>
<p>Instead of one data element per node, there are many.</p>
<p>In NTFS the actual number depends on the lengths of the names
and the cluster size).</p>
<p>The B+ tree retains the efficiency of a binary tree and also
performs well with large numbers of data elements (because the tree
tends to grow wide rather than deep).</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_binary_tree">Binary Tree</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_balanced_tree">Balanced Tree</a>.</p>
</dd>
<dt><a name="glossary_baad" id="glossary_baad"></a>BAAD</dt>
<dd>
<p>During chkdsk, if NTFS finds a multi-sector item (MFT, INDEX
BLOCK, etc) where the multi-sector header doesn't match the values
at the end of the sector, it marks the item with the magic number
'BAAD', and fill it with zeroes (except for a short at the end of
each sector...)</p>
<pre class="programlisting">        FIXME
        "BAAD" == corrupt record
        "CHKD" == chkdsk ???
        "FILE" == mft entry
        "HOLE" == ??? (NTFS 3.0+?)
        "INDX" == index buffer
        RSTR &amp; ???
                                
</pre>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_chkdsk">chkdsk</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_fsck">fsck</a>.</p>
</dd>
<dt><a name="glossary_bad" id="glossary_bad"></a>$Bad</dt>
<dd>
<p>This is the named Data Stream representing bad clusters on a
volume.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_badclus">$BadClus</a>.</p>
</dd>
<dt><a name="glossary_badclus" id="glossary_badclus"></a>$BadClus</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file lists all
the unreadable <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">clusters</a> on the
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">volume</a>.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_badclus" title="NTFS Files: $BadClus (8)">(More...)</a></p>
</dd>
<dt><a name="glossary_balanced_tree" id="glossary_balanced_tree"></a>Balanced Tree</dt>
<dd>
<p>Often binary trees can become very uneven. By reorganising the
data, the tree can be balanced such that no a node has similar
numbers of children to it's left and right.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_b_plus_tree">B+ Tree</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_binary_tree">Binary Tree</a>.</p>
</dd>
<dt><a name="glossary_base_file_record" id="glossary_base_file_record"></a>Base FILE Record</dt>
<dd>
<p>If the attributes don't fit into a single MFT record then the
Base FILE Record holds enough information to locate the other
records.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute_list">$ATTRIBUTE_LIST</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE Record</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_mft">$MFT</a>.</p>
</dd>
<dt><a name="glossary_binary" id="glossary_binary"></a>Binary</dt>
<dd>
<p>Maths carried out in base two. In this documentation, certain
flags fields are represented in binary, for the sake of
clarity.</p>
<p>e.g. 00001000 <sub>2</sub>, 010000000 <sub>2</sub>.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_decimal">Decimal</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hex">Hex, Hexadecimal</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_binary_tree" id="glossary_binary_tree"></a>Binary Tree</dt>
<dd>
<p>This is an efficient way of storing sorted data in order.</p>
<p>Each node in the tree represents a data element.</p>
<p>The left child node is a collection of all the elements that
come before it.</p>
<p>The right child node is a collection of all the elements that
come after it.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_b_plus_tree">B+ Tree</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_balanced_tree">Balanced Tree</a>.</p>
</dd>
<dt><a name="glossary_bit" id="glossary_bit"></a>Bit</dt>
<dd>
<p>One binary digit, one or zero.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_bitmap" id="glossary_bitmap"></a>$Bitmap</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file keeps track
of which <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">clusters</a> are in use on the
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">volume</a>.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_bitmap" title="NTFS Files: $Bitmap (6)">(More...)</a></p>
</dd>
<dt><a name="glossary_bitmap2" id="glossary_bitmap2"></a>$BITMAP</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> keeps track of
which <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_record">records</a> are in use in an
index.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_bitmap" title="Attribute - $BITMAP (0xB0)">(More...)</a></p>
</dd>
<dt><a name="glossary_block" id="glossary_block"></a>Block</dt>
<dd>
<p>In Linux terminology, this is a cluster. Block device In Linux
terminology, this is a storage unit.</p>
<p>Cluster is the minimum allocation unit.</p>
<p>Clusters are a fixed power of 2 of the sector size (called the
cluster factor), and their size can be between 512 bytes and 4 KB
(Sometimes 64 KB, but 4 KB is the largest cluster size that the
current NTFS compression engine can operate with.</p>
<p>That limit may be related to the 4 KB page size used on the
Intel i386 CPU).</p>
<p>This size can be set with the Windows NT format utility, whose
default is: Volume size Cluster size 1 to 512 MB Sector size 512 MB
to 1 GB 1 KB 1 GB to 2 GB 2 KB more than 2 GB 4 KB</p>
</dd>
<dt><a name="glossary_boot" id="glossary_boot"></a>$Boot</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file points at
the boot sector of the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">volume</a>.</p>
<p>It contains information about the size of the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">volume</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">clusters</a> and the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_mft">MFT</a>.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_boot" title="NTFS Files: $Boot (7)">(More...)</a></p>
</dd>
<dt><a name="glossary_byte" id="glossary_byte"></a>Byte <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">(See Units)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_chkdsk" id="glossary_chkdsk"></a>chkdsk</dt>
<dd>
<p>This is a DOS and Windows utility to check and repair
filesystems.</p>
<p>Its name is an abbreviation of check disk.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_fsck">fsck</a>.</p>
</dd>
<dt><a name="glossary_cluster" id="glossary_cluster"></a>Cluster</dt>
<dd>
<p>This is the smallest unit of disk that NTFS uses and it is a
multiple of the sector size.</p>
<p>It is determined when the volume is formatted and cannot be
altered afterwards.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sector">Sector</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_boot">$Boot</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_compression" id="glossary_compression"></a>Compression</dt>
<dd>
<p>NTFS supports file- and directory-level compression.</p>
<p>The compression is performed transparently when the file is read
or written.</p>
<p>Any new files in a compressed directory will automatically be
compressed.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_compression_unit">Compression
Unit</a>.</p>
</dd>
<dt><a name="glossary_compression_unit" id="glossary_compression_unit"></a>Compression Unit</dt>
<dd>
<p>Each file marked to be compressed is divided into sixteen
cluster blocks, known as compression units.</p>
<p>If one of these blocks cannot be compressed into fifteen
clusters or less it is left uncompressed.</p>
<p>This division also helps accessing a file randomly, ie it isn't
necessary to decompress the whole file.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Cluster</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_compression">Compression</a>.</p>
</dd>
<dt><a name="glossary_data" id="glossary_data"></a>$DATA</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> contains the
actual data for a file.</p>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_stream">stream</a> may also have a
name.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_data" title="Attribute - $DATA (0x80)">(More...)</a></p>
</dd>
<dt><a name="glossary_data_runs" id="glossary_data_runs"></a>Data
Runs</dt>
<dd>
<p>Non-resident attributes are stored in intervals of clusters
called runs.</p>
<p>Each run is represented by its starting cluster and its
length.</p>
<p>The runs map the VCNs of a file to the LCNs of a volume.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_data_runs" title="Concept - Data Runs">(More...)</a></p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">Attribute</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Cluster</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_lcn">Logical
Cluster Number (LCN)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_vcn">Virtual Cluster
Number (VCN)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_decimal" id="glossary_decimal"></a>Decimal</dt>
<dd>
<p>Maths carried out in base ten.</p>
<p>In this documentation, numbers that are neither in <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hex">hex</a>, nor <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_binary">binary</a>,
are in decimal, e.g. 16 (sixteen), 23 (twenty-three).</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_binary">Binary</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hex">Hex, Hexadecimal</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_directory" id="glossary_directory"></a>Directory</dt>
<dd>
<p>An NTFS directory is an index attribute. NTFS uses index
attributes to collate file names.</p>
<p>A directory entry contains the name of the file and a copy of
the file's standard information attribute (time stamp
information).</p>
<p>This approach provides a performance boost for directory
browsing because NTFS does not need to read the files' MFT records
to print directory information.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_directory" title="Concept - Directory">(More...)</a></p>
</dd>
<dt><a name="glossary_dos_file_permissions" id="glossary_dos_file_permissions"></a>DOS File Permissions <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_permissions">(see File Permissions)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_permissions">File
Permissions</a>.</p>
</dd>
<dt><a name="glossary_dot" id="glossary_dot"></a>Dot, Root
Directory</dt>
<dd>
<p>Root directory of the disk</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_dot" title="NTFS Files: . (Root Directory) (5)">(More...)</a></p>
</dd>
<dt><a name="glossary_drive" id="glossary_drive"></a>Drive <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">(See Volume)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_dynamic_disk" id="glossary_dynamic_disk"></a>Dynamic Disk</dt>
<dd>
<pre class="programlisting">        Dynamic disk SDS, win2k
                                
</pre></dd>
<dt><a name="glossary_ea" id="glossary_ea"></a>$EA</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> is used to
implement the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hpfs">HPFS</a> extended attribute
under NTFS.</p>
<p>It is only used for OS/2 compatibity.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea" title="Attribute - $EA (0xE0)">(More...)</a></p>
</dd>
<dt><a name="glossary_ea_information" id="glossary_ea_information"></a>$EA_INFORMATION</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> is used to
implement the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hpfs">HPFS</a> extended attribute
under NTFS.</p>
<p>It is only used for OS/2 compatibity.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_ea_information" title="Attribute - $EA_INFORMATION (0xD0)">(More...)</a></p>
</dd>
<dt><a name="glossary_efs" id="glossary_efs"></a>$EFS</dt>
<dd>
<p>$EFS is the named $LOGGED_UTILITY_STREAM of any encrypted
file.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_logged_utility_stream">$LOGGED_UTILITY_STREAM</a>.</p>
</dd>
<dt><a name="glossary_extend" id="glossary_extend"></a>$Extend</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> directory
contains the <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> files:</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_objid">$ObjId</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_quota">$Quota</a></p>
</li>
<li>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_reparse">$Reparse</a></p>
</li>
</ul>
</div>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_extend" title="NTFS Files: $Extend (11)">(More...)</a></p>
</dd>
<dt><a name="glossary_file" id="glossary_file"></a>File</dt>
<dd>
<p>In the NTFS terminology, a file can be a normal file, directory
(like in Linux) or a system file.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_file" title="Concept - File">(More...)</a></p>
</dd>
<dt><a name="glossary_file_name" id="glossary_file_name"></a>$FILE_NAME</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> represents the
file's name.</p>
<p>A file can have one or more names, which can be in any
directory.</p>
<p>This is the NTFS equivalent to Unix's hard links.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_file_name" title="Attribute - $FILE_NAME (0x30)">(More...)</a></p>
</dd>
<dt><a name="glossary_filename_namespace" id="glossary_filename_namespace"></a>Filename Namespace</dt>
<dd>
<p>Not all characters are valid in DOS filenames.</p>
<p>For compatibity NTFS stores which namespace the name belongs
to.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_filename_namespace" title="Concept - Filename Namespace">(More...)</a></p>
</dd>
<dt><a name="glossary_file_permissions" id="glossary_file_permissions"></a>File Permissions</dt>
<dd>
<p>NTFS supports the standard set of DOS file permissions, namely
<span class="emphasis"><em>Archive</em></span>, <span class="emphasis"><em>System</em></span>, <span class="emphasis"><em>Hidden</em></span> and <span class="emphasis"><em>Read Only</em></span>.</p>
<p>In addition, NTFS supports <span class="emphasis"><em>Compressed</em></span> and <span class="emphasis"><em>Encrypted</em></span>.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_compression">Compression</a>.</p>
</dd>
<dt><a name="glossary_file_record" id="glossary_file_record"></a>FILE Record</dt>
<dd>
<p>The $MFT is made up of FILE records, so named because of a magic
number of <span class="emphasis"><em>FILE</em></span>.</p>
<p>Each record has a standard header and a list of attributes.</p>
<p>If the attributes don't fit into a single record, then more
records will be used and a $ATTRIBUTE_LIST attribute will be
needed.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">Attribute</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute_list">$ATTRIBUTE_LIST</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_magic_number">Magic Number</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_mft">$MFT</a>.</p>
</dd>
<dt><a name="glossary_file_record_segment" id="glossary_file_record_segment"></a>File Record Segment (FRS)</dt>
<dd>
<pre class="programlisting">        FRS = MFT File Record
                                
</pre></dd>
<dt><a name="glossary_file_reference" id="glossary_file_reference"></a>File Reference</dt>
<dd>
<p>Each file record has a unique number identifying it.</p>
<p>The first 48 bits are a sequentially allocated number which is
the offset in the $MFT.</p>
<p>The last 16 bits are a sequence number.</p>
<p>Every time the record is altered this number is incremented.</p>
<p>The sequence number can help detect errors on the volume.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE Record</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_mft">$MFT</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_file_runs" id="glossary_file_runs"></a>File
Runs <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_data_runs">(See Data Runs)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_data_runs">Data Runs</a>.</p>
</dd>
<dt><a name="glossary_filesize" id="glossary_filesize"></a>File
Size</dt>
<dd>
<p>There are three file sizes that NTFS records.</p>
<p>Each of them stores the number of bytes.</p>
<div class="itemizedlist">
<ul type="disc">
<li>
<p>R) Real. The number of bytes of data.</p>
</li>
<li>
<p>A) Allocated. The size taken up on disk.</p>
</li>
<li>
<p>I) Initialised. Size of compressed file.</p>
</li>
</ul>
</div>
<p>If the file is compressed, the Initialised Size may be smaller
than the Real Size.</p>
</dd>
<dt><a name="glossary_filesystem" id="glossary_filesystem"></a>Filesystem</dt>
<dd>
<p>The physical structure an operating system uses to store and
organize files on a storage unit.</p>
<p>A commonly used filesystem is FAT (used by DOS).</p>
</dd>
<dt><a name="glossary_fixup" id="glossary_fixup"></a>Fixup <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_update_sequence">(See Update Sequence)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_update_sequence">Update Sequence</a>.</p>
</dd>
<dt><a name="glossary_fork" id="glossary_fork"></a>Fork <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_resource_fork">(See Resource Fork)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_resource_fork">Resource Fork</a>.</p>
</dd>
<dt><a name="glossary_fragmented" id="glossary_fragmented"></a>Fragmented</dt>
<dd>
<p>(un)f file</p>
</dd>
<dt><a name="glossary_frs" id="glossary_frs"></a>FRS <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record_segment">(See File Record Segment)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record_segment">File Record Segment
(FRS)</a>.</p>
</dd>
<dt><a name="glossary_fsck" id="glossary_fsck"></a>fsck</dt>
<dd>
<p>This is a utility to check and repair filesystems.</p>
<p>Its name is an abbreviation of filesystem check.</p>
</dd>
<dt><a name="glossary_gb" id="glossary_gb"></a>GB <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">(See Units)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_guid" id="glossary_guid"></a>GUID <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">(See Units)</a></dt>
<dd>
<pre class="programlisting">      The valid format for a GUID is {XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX}

      Globally Unique Identifier (GUID)

      GUID structures store globally unique identifiers (GUID). A GUID is a
      128-bit value consisting of one group of eight hexadecimal digits, followed
      by three groups of four hexadecimal digits each, followed by one group of
      twelve hexadecimal digits. GUIDs are Microsoft's implementation of the
      distributed computing environment (DCE) universally unique identifier (UUID).
      Example of a GUID:
              1F010768-5A73-BC91-0010A52216A7

      order stored on disk?

      01020304-0506-0708-090A0B0C0D0E0F010

      0x00  04030201
      0x04  0605
      0x06  0807
      0x08  090A0B0C0D0E0F010
                                
</pre></dd>
<dt><a name="glossary_hex" id="glossary_hex"></a>Hex,
Hexadecimal</dt>
<dd>
<p>Maths carried out in base sixteen.</p>
<p>In this documentation, many numbers represented in hex, e.g.
0x02E0, 0xF100.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_binary">Binary</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_decimal">Decimal</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt>HFS <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hfs">(See Hierarchical File
System)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hfs">Hierarchical File System
(HFS)</a>.</p>
</dd>
<dt><a name="glossary_hfs" id="glossary_hfs"></a>Hierarchical File
System (HFS)</dt>
<dd>
<p>The MacOS filesystem.</p>
</dd>
<dt><a name="glossary_hpfs" id="glossary_hpfs"></a>High Performance
File System (HPFS)</dt>
<dd>
<p>The OS/2 filesystem.</p>
<p>Remember: once upon a time, OS/2 had to be the operating system
developed by both IBM and Microsoft.</p>
<p>There was a break between the 2 giants. IBM continued to develop
OS/2 (it became OS/2 Warp), and that explains why OS/2 knows how to
execute Windows applications. Microsoft decided to make its own
operating system: Windows NT.</p>
<p>HPFS design influenced NTFS design, so the 2 filesystems share
many features.</p>
</dd>
<dt>HPFS <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hpfs">(See High Performance File
System)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hpfs">High Performance File System
(HPFS)</a>.</p>
</dd>
<dt><a name="glossary_i30" id="glossary_i30"></a>$I30</dt>
<dd>
<p>This is the named index used by directories.</p>
<p>The name refers to attribute 0x30 ($FILE_NAME).</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">Attribute</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_directory">Directory</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_name">$FILE_NAME</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_index">Index</a>.</p>
</dd>
<dt><a name="glossary_index" id="glossary_index"></a>Index</dt>
<dd>
<p>just the whole index idea)</p>
</dd>
<dt><a name="glossary_index_allocation" id="glossary_index_allocation"></a>$INDEX_ALLOCATION</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> contains the
location of the entries that make up an index.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_allocation" title="Attribute - $INDEX_ALLOCATION (0xA0)">(More...)</a></p>
</dd>
<dt><a name="glossary_index_root" id="glossary_index_root"></a>$INDEX_ROOT</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> is the root of
an index.</p>
<p>The index is stored as a balanced binary tree.</p>
<p>The only attribute which is indexed is <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_name">$FILE_NAME</a> and the index is called
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_i30">$I30</a>.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_index_root" title="Attribute - $INDEX_ROOT (0x90)">(More...)</a></p>
</dd>
<dt><a name="glossary_indx_record" id="glossary_indx_record"></a>INDX Record</dt>
<dd>
<p>Index records are used by directories, $Quota, $Reparse and
$Secure.</p>
<p>The contents depend on the type of index being kept.</p>
<p>Directories store $FILE_NAME attributes.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#concept_index_record" title="Concept - Index Record">(More...)</a></p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_directory">Directory</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_i30">$I30</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_quota">$Quota</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_reparse">$Reparse</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_secure">$Secure</a>.</p>
</dd>
<dt><a name="glossary_infinite_logging_area" id="glossary_infinite_logging_area"></a>Infinite Logging Area</dt>
<dd>
<p>Something contained in $LogFile. It consists of a sequence of
4KB log records.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_logfile">$LogFile</a>.</p>
</dd>
<dt><a name="glossary_inode" id="glossary_inode"></a>Inode</dt>
<dd>
<p>An inode is the filesystems representation of a file, directory,
device, etc.</p>
<p>In NTFS every inode it represented by an MFT FILE record.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_directory">Directory</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file">File</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE
Record</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_filesystem">Filesystem</a>.</p>
</dd>
<dt><a name="glossary_j" id="glossary_j"></a>$J</dt>
<dd>
<p>$J is a named data stream of the Metadata File $UsnJrnl.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_usnjrnl">$UsnJrnl</a>.</p>
</dd>
<dt><a name="glossary_junction_point" id="glossary_junction_point"></a>Junction Point</dt>
<dd>
<p>Microsoft term for a mount point, available in NT 5.0.</p>
</dd>
<dt><a name="glossary_kb" id="glossary_kb"></a>KB <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">(See Units)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt>LCN <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_lcn">(See Logical Cluster
Number)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_lcn">Logical Cluster Number
(LCN)</a>.</p>
</dd>
<dt><a name="glossary_log_record" id="glossary_log_record"></a>Log
Record</dt>
<dd>
<p>One 4KB chunk of the infinite logging area. It starts with the
magic number 'RCRD' and a fixup, then has undocumented variable
length data. [The log record might be further subdivided - I cannot
imagine they waste 4KB if they only have to log a few bytes. Custer
mentions high level and low level 'records'. High level are: -
allocate inode n, - make a directory entry foo in directory m low
level are: - modify inode n with the new contents of
&lt;1KB&gt;]</p>
</dd>
<dt><a name="glossary_logfile" id="glossary_logfile"></a>$LogFile</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file is used to
guarantee data integrity in case of a system failure.</p>
<p>It has two copies of the restart area and the infinite logging
area.</p>
<p>The log file is near the centre of the volume, just after the
second cluster of the boot file. [Better say 'run' than cluster.
The boot file usually extends over several clusters at the
beginning of the disk, and then has a single run of just one
cluster (the copy of the boot sector). Also, isn't it
'infinite'?]</p>
<p>Transactional logging file</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_logfile" title="NTFS Files: $LogFile (2)">(More...)</a></p>
</dd>
<dt><a name="glossary_logged_utility_stream" id="glossary_logged_utility_stream"></a>$LOGGED_UTILITY_STREAM</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> is used by
encrypted files.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_logged_utility_stream" title="Attribute - $LOGGED_UTILITY_STREAM (0x100)">(More...)</a></p>
</dd>
<dt><a name="glossary_lcn" id="glossary_lcn"></a>Logical Cluster
Number (LCN)</dt>
<dd>
<p>A volume is divided into clusters. They are numbered
sequentially, starting at zero.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Cluster</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_lsn" id="glossary_lsn"></a>Logical Sequence
Number (LSN)</dt>
<dd>
<p>A serial number used to identify an NTFS log record.</p>
</dd>
<dt>LSN <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_lsn">(See Logical Sequence
Number)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_lsn">Logical Sequence Number
(LSN)</a>.</p>
</dd>
<dt><a name="glossary_magic_number" id="glossary_magic_number"></a>Magic Number</dt>
<dd>
<p>Most of the on-disk structures in NTFS have a unique constant
identifying them.</p>
<p>This number is usually located at the beginning of the structure
and can be used as a sanity check.</p>
</dd>
<dt><a name="glossary_master_file_table" id="glossary_master_file_table"></a>Master File Table</dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_master_file_table">Master File
Table</a>.</p>
</dd>
<dt><a name="glossary_max" id="glossary_max"></a>$Max</dt>
<dd>
<p>$Max is a named Data Stream of $UsnJrnl.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_usnjrnl">$UsnJrnl</a>.</p>
</dd>
<dt><a name="glossary_mb" id="glossary_mb"></a>MB <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">(See Units)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_metadata" id="glossary_metadata"></a>Metadata</dt>
<dd>
<p>Data on the storage unit used by the filesystem only, as a frame
to access user data.</p>
<p>Metadata constitutes the structure of the filesystem).</p>
<p>Metadata examples from various filesystems include FATs, inode
tables, free block lists, free block bitmaps, logging areas, and
the superblock.</p>
<pre class="programlisting">        meta-data

        Data about data. In data processing, meta-data is definitional data
        that provides information about or documentation of other data managed
        within an application or environment.

        For example, meta data would document data about data elements or
        attributes, (name, size, data type, etc) and data about records or
        data structures (length, fields, columns, etc) and data about data
        (where it is located, how it is associated, ownership, etc.). Meta
        data may include descriptive information about the context, quality
        and condition, or characteristics of the data.
                                
</pre></dd>
<dt><a name="glossary_mft" id="glossary_mft"></a>$MFT</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file, the Master
File Table, is an index of all the files on the volume.</p>
<p>It contains the attributes of each file and the root of any
indexes.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mft" title="NTFS Files: $MFT (0)">(More...)</a></p>
</dd>
<dt><a name="glossary_mftmirr" id="glossary_mftmirr"></a>$MFTMirr</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file stores a
copy of the first four records of $MFT.</p>
<p>It is a safety measure which probably only gets used when chkdsk
is run.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_mftmirr" title="NTFS Files: $MFTMirr (1)">(More...)</a></p>
</dd>
<dt><a name="glossary_mountmgrdatabase" id="glossary_mountmgrdatabase"></a>$MountMgrDatabase</dt>
<dd>
<p>$MountMgrDatabase is a named Data Stream of dot (the root
directory).</p>
<p>It contains a list of mounted volumes.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_dot">Dot, Root Directory</a>.</p>
</dd>
<dt><a name="glossary_mst" id="glossary_mst"></a>MST <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_multi_sector_transfer">(See Multi-Sector
Transfer)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_multi_sector_transfer">Multi-Sector
Transfer</a>.</p>
</dd>
<dt><a name="glossary_multi_sector_transfer" id="glossary_multi_sector_transfer"></a>Multi-Sector Transfer</dt>
<dd>
<pre class="programlisting">        multiple sectors, fixup, safety checks
                                
</pre></dd>
<dt><a name="glossary_nibble" id="glossary_nibble"></a>Nibble</dt>
<dd>
<p>Half of a byte (4 bits).</p>
</dd>
<dt><a name="glossary_nt_authority" id="glossary_nt_authority"></a>NT Authority</dt>
<dd>
<p>The NT Authority defines the scope of the security
identifier.</p>
<p>Numbers 0 - 4 represent internal identifiers,</p>
<p>e.g. World, Local. 5 represents the NT Authority.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_nt_sub_authority">NT Sub
Authority</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">Security Identifier
(SID)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>.</p>
</dd>
<dt><a name="glossary_ntfs" id="glossary_ntfs"></a>NTFS</dt>
<dd>
<p>NTFS is the file system of Windows NT, Windows 2000 and Windows
XP.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">(More...)</a></p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_filesystem">Filesystem</a>.</p>
</dd>
<dt><a name="glossary_nt_sub_authority" id="glossary_nt_sub_authority"></a>NT Sub Authority</dt>
<dd>
<p>The Sub Authority can contain any number of fields (five is
usual).</p>
<p>Sub Authorities beginning with 21 (0x15) denote a NT Domain
identifier.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_nt_authority">NT Authority</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">Security Identifier (SID)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>.</p>
</dd>
<dt><a name="glossary_o" id="glossary_o"></a>$O</dt>
<dd>
<p>This is one of the named indexes belonging to $Quota and
$ObjId.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_index">Index</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_q">$Q</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_objid">$ObjId</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_quota">$Quota</a>.</p>
</dd>
<dt><a name="glossary_object_id" id="glossary_object_id"></a>$OBJECT_ID</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> stores a
mapping between a SID and a Security Hash.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_object_id" title="Attribute - $OBJECT_ID (0x40)">(More...)</a></p>
</dd>
<dt><a name="glossary_objid" id="glossary_objid"></a>$ObjId</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> record's the
unique identifiers given to files and directorys when using
Distributed Link Tracking.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_objid" title="NTFS Files: $ObjId (Any)">(More...)</a></p>
</dd>
<dt><a name="glossary_pam" id="glossary_pam"></a>PAM</dt>
<dd>
<p>Pluggable Authentication Modules (PAM) are a set of libraries
for validating security on Linux.</p>
</dd>
<dt><a name="glossary_partition" id="glossary_partition"></a>Partition <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">(See
Volume)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_partition_table" id="glossary_partition_table"></a>Partition Table</dt>
<dd>
<pre class="programlisting">        partition table...
        SFS Win2K dynamic disk
                                
</pre></dd>
<dt><a name="glossary_permissions" id="glossary_permissions"></a>Permissions</dt>
<dd>
<p>There are two mechanisms for storing permissions in NTFS.</p>
<p>One is a superset of DOS File Permissions, which includes
<span class="emphasis"><em>Read Only</em></span> and <span class="emphasis"><em>Hidden</em></span>.</p>
<p>The other is based on ACEs and allows granting specific
permissions to specific users.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_ace">Access Control Entry (ACE)</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_permissions">File Permissions</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>.</p>
</dd>
<dt><a name="glossary_posix" id="glossary_posix"></a>POSIX</dt>
<dd>
<p>An acronym (pronounced like positive) for Portable Operating
System Interface, suggested by Richard M. Stallman.</p>
<p>It is a set of international standards (ISO/IEC 9945-1:1996(E),
ANSI/IEEE Std 1003.1 1996 Edition) to interface with Unix-like
exploitation systems, e.g. Linux.</p>
<p>NTFS does not support Unix-like device files.</p>
</dd>
<dt><a name="glossary_property_set" id="glossary_property_set"></a>$PROPERTY_SET</dt>
<dd>
<p>An obsolete attribute (0xF0) from NT4</p>
</dd>
<dt><a name="glossary_q" id="glossary_q"></a>$Q</dt>
<dd>
<p>This is one of the named indexes belonging to $Quota.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_index">Index</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_o">$O</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_quota">$Quota</a>.</p>
</dd>
<dt><a name="glossary_quota" id="glossary_quota"></a>$Quota</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file stores
information about file quotas.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_quota" title="NTFS Files: $Quota (NT:9, 2K:Any)">(More...)</a></p>
</dd>
<dt><a name="glossary_r" id="glossary_r"></a>$R</dt>
<dd>
<p>This is the named index belonging to $Reparse.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_index">Index</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_reparse">$Reparse</a>.</p>
</dd>
<dt><a name="glossary_rcrd_record" id="glossary_rcrd_record"></a>RCRD Record</dt>
<dd>
<p>This record is used in the $LogFile.</p>
<p>Each represents an atomic transaction that is to be
performed.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_logfile">$LogFile</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_transaction">Transaction</a>.</p>
</dd>
<dt><a name="glossary_record" id="glossary_record"></a>Record</dt>
<dd>
<p>There are several record types in NTFS.</p>
<p>FILE Record are used in the $MFT, INDX Records in indexes, RCRD
and RSTR Records in the $LogFile.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE Record</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_indx_record">INDX Record</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_rcrd_record">RCRD Record</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_rstr_record">RSTR Record</a>.</p>
</dd>
<dt><a name="glossary_recursion" id="glossary_recursion"></a>Recursion</dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_recursion">Recursion</a>.</p>
</dd>
<dt><a name="glossary_reference" id="glossary_reference"></a>Reference</dt>
<dd>
<p>file (are there any others?)</p>
</dd>
<dt><a name="glossary_reparse" id="glossary_reparse"></a>$Reparse</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file stores
information about reparse points.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_reparse" title="NTFS Files: $Reparse (Any)">(More...)</a></p>
</dd>
<dt><a name="glossary_reparse_point" id="glossary_reparse_point"></a>$REPARSE_POINT</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> stores
information about reparse points.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_reparse_point" title="Attribute - $REPARSE_POINT (0xC0)">(More...)</a></p>
</dd>
<dt><a name="glossary_resource_fork" id="glossary_resource_fork"></a>Resource Fork</dt>
<dd>
<p>In MacOS's filesystem, HFS, files are allowed to have multiple
data streams.</p>
<p>These are called resource forks.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_hfs">Hierarchical File System
(HFS)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_stream">Stream</a>.</p>
</dd>
<dt><a name="glossary_roll-back" id="glossary_roll-back"></a>Roll-back</dt>
<dd>
<p>When an NTFS volume is mounted, it is checked to see if it is in
a consistant state.</p>
<p>If it isn't then the $LogFile is consulted and transactions are
undone until the disk returns to a consistant state.</p>
<p>This does not guarantee data integrity, only disk integrity.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_logfile">$LogFile</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_transaction">Transaction</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_root_directory" id="glossary_root_directory"></a>Root Directory <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_dot">(See Dot, Root Directory)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_dot">Dot, Root Directory</a>.</p>
</dd>
<dt><a name="glossary_rstr_record" id="glossary_rstr_record"></a>RSTR Record</dt>
<dd>
<p>Two copies of this are in $LogFile.</p>
<p>A restart area has the magic number 'RSTR' followed by a fixup
and some other data, including three LSNs.</p>
<p>A restart area has a pointer into the log area, such as the
first and last log records written and the last checkpoint record
written. (that is three - now which is which?)</p>
</dd>
<dt><a name="glossary_runs" id="glossary_runs"></a>Runs <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_data_runs">(See Data Runs)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_data_runs">Data Runs</a>.</p>
</dd>
<dt><a name="glossary_sdh" id="glossary_sdh"></a>$SDH</dt>
<dd>
<p>This is one of the named indexes belonging to $Secure.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_index">Index</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sii">$SII</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_secure">$Secure</a>.</p>
</dd>
<dt><a name="glossary_sds" id="glossary_sds"></a>$SDS</dt>
<dd>
<p>This is the named data stream belonging to $Secure.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_secure">$Secure</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_stream">Stream</a>.</p>
</dd>
<dt><a name="glossary_sector" id="glossary_sector"></a>Sector</dt>
<dd>
<p>Unit of data on the physical storage unit.</p>
<p>The storage controller can only access data in multiples of this
unit.</p>
<p>A sector is usually 512 bytes, but can be 1 KB on certain Asian
hard disks.</p>
</dd>
<dt><a name="glossary_secure" id="glossary_secure"></a>$Secure</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file stores a
table of security descriptors used by the volume.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_secure" title="NTFS Files: $Secure (9)">(More...)</a></p>
</dd>
<dt><a name="glossary_security" id="glossary_security"></a>Security</dt>
<dd>
<p>There are two levels of security in NTFS.</p>
<p>There are the DOS File Permissions, such as <span class="emphasis"><em>Read Only</em></span> and <span class="emphasis"><em>Hidden</em></span> and an ACL model which grants
specific permissions to specific users.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_ace">Access Control Entry (ACE)</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">Access Control List (ACL)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_permissions">Permissions</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">Security Identifier (SID)</a>.</p>
</dd>
<dt><a name="glossary_security_descriptor" id="glossary_security_descriptor"></a>$SECURITY_DESCRIPTOR</dt>
<dd>
<p>This attribute stores all the security information about a file
or directory.</p>
<p>It contains an ACL for auditing, an ACL for permissions and a
SID to show the user and group of the owner.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_security_descriptor" title="Attribute - $SECURITY_DESCRIPTOR (0x50)">(More...)</a></p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">Attribute</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">Access Control List (ACL)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_ace">Access Control Entry (ACE)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">Security Identifier (SID)</a>.</p>
</dd>
<dt><a name="glossary_sid" id="glossary_sid"></a>Security
Identifier (SID)</dt>
<dd>
<p>This variable-length identifier uniquely identifies a user or a
group on an NT domain. It is used in the security permissions.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_ace">Access Control Entry (ACE)</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_acl">Access Control List (ACL)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_security_descriptor">$SECURITY_DESCRIPTOR</a>.</p>
</dd>
<dt><a name="glossary_sequence_array" id="glossary_sequence_array"></a>Sequence Array <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_update_sequence">(See Update Sequence)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_update_sequence">Update Sequence</a>.</p>
</dd>
<dt>SID <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sid">(See Security Identifier)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_update_sequence">Update Sequence</a>.</p>
</dd>
<dt><a name="glossary_sii" id="glossary_sii"></a>$SII</dt>
<dd>
<p>This is one of the named indexes belonging to $Secure.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_index">Index</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_sdh">$SDH</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_secure">$Secure</a>.</p>
</dd>
<dt><a name="glossary_sparse_file" id="glossary_sparse_file"></a>Sparse File</dt>
<dd>
<p>NTFS supports sparse files. If a file contains large,
contiguous, blocks of zeros, then NTFS can choose to not waste any
space storing these portions on disk.</p>
<p>They are represented as data runs containing nothing.</p>
<p>When read from disk, NTFS simply substitutes zeros.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_data_runs">Data Runs</a>.</p>
</dd>
<dt><a name="glossary_standard_information" id="glossary_standard_information"></a>$STANDARD_INFORMATION</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> contains
information about a file, such as its file permissions and when it
was created.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_standard_information" title="Attribute - $STANDARD_INFORMATION (0x10)">(More...)</a></p>
</dd>
<dt><a name="glossary_stream" id="glossary_stream"></a>Stream</dt>
<dd>
<p>All data on NTFS is stored in streams, which can have names.</p>
<p>A file can have more than one data streams, but exactly one must
have no name.</p>
<p>The <span class="emphasis"><em>size</em></span> of a file is the
size of its unnamed data attribute.</p>
</dd>
<dt><a name="glossary_symbolic_link" id="glossary_symbolic_link"></a>$SYMBOLIC_LINK</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a>, like <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume_version">$VOLUME_VERSION</a> existed in NTFS
v1.2, but wasn't used.</p>
<p>It does not longer exist in NTFS v3.0+.</p>
</dd>
<dt><a name="glossary_tb" id="glossary_tb"></a>TB <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">(See Units)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_units">Units</a>.</p>
</dd>
<dt><a name="glossary_time_stamp" id="glossary_time_stamp"></a>Time
Stamp</dt>
<dd>
<p>NTFS stores four significant times referring to files and
directories.</p>
<p>They are: File creation time; Last modification time; Last
modification of the MFT record; Last access time.</p>
<p>NTFS stores dates as the number of 100ns units since Jan 1
<sup>st</sup> 1601.</p>
<p>Unix, stores dates as the number of seconds since Jan 1
<sup>st</sup> 1970.</p>
<pre class="programlisting">        standardise 4 time fields name &amp; description concept page?
        refer to 4 times as:
          C creation
          A alter (modification)
          M mft (mft changed)
          R read (last access)

        FIXME:
        NOTE: There is conflicting information about the meaning of each of the time
        fields but the meaning as defined below has been verified to be
        correct by practical experimentation on Windows NT4 SP6a and is hence
        assumed to be the one and only correct interpretation.

        creation_time
        Time file was created. Updated when a filename is changed(?).

        last_data_change_time
        Time the data attribute was last modified.

        last_mft_change_time
        Time this mft record was last modified.

        last_access_time
        Approximate time when the file was last accessed (obviously this is not
        updated on read-only volumes). In Windows this is only updated when
        accessed if some time delta has passed since the last update.
                                
</pre>
<pre class="programlisting">        N.B. There is conflicting information about the meaning of each of the time
        fields but the meaning as defined below has been verified to be
        correct by practical experimentation on Windows NT4 SP6a and is hence
        assumed to be the one and only correct interpretation.
                                
</pre>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE Record</a>.</p>
</dd>
<dt><a name="glossary_transaction" id="glossary_transaction"></a>Transaction</dt>
<dd>
<p>A transaction on a system is a set of operations (on that
system) that constitutes a unit. This unit can't be divided.</p>
<p>Before the transaction, the state of the system is well defined.
During the transaction, it is undefined. After the transaction, it
is well defined again.</p>
<p>A transaction can't be half-realized: if no operation fails, the
transaction is realized. If on the contrary an error occurs in one
or more of the operations, the transaction is not realized.</p>
<p>A set of (even atomic) operations is not atomic by definition. A
transaction is a model that provides a kind of atomicity to this
set of operations.</p>
</dd>
<dt><a name="glossary_unfragmented" id="glossary_unfragmented"></a>Unfragmented <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_fragmented">(see Fragmented)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_fragmented">Fragmented</a>.</p>
</dd>
<dt><a name="glossary_unicode" id="glossary_unicode"></a>Unicode</dt>
<dd>
<p>International character set coded on 16 bits (ASCII is coded on
7 bits and Latin-1 coded on 8 bits). Unicode can represent every
symbol of almost every language in the world.</p>
</dd>
<dt><a name="glossary_units" id="glossary_units"></a>Units</dt>
<dd>
<p>Every size in this document is measured in bytes (unless clearly
marked).</p>
<p>The abbreviations for sizes are:</p>
<div class="table"><a name="id4824321" id="id4824321"></a>
<p class="title"><b>Table&nbsp;122.&nbsp;Measurement Units</b></p>
<table summary="Measurement Units" border="1">
<colgroup>
<col>
<col>
<col>
<col></colgroup>
<thead>
<tr>
<th>Abbr.</th>
<th>Name</th>
<th>Exactly</th>
<th>Approx.</th>
</tr>
</thead>
<tbody>
<tr>
<td>KB</td>
<td>Kilobyte</td>
<td>2 <sup>10</sup></td>
<td>10 <sup>3</sup></td>
</tr>
<tr>
<td>MB</td>
<td>Megabyte</td>
<td>2 <sup>20</sup></td>
<td>10 <sup>6</sup></td>
</tr>
<tr>
<td>GB</td>
<td>Gigabyte</td>
<td>2 <sup>30</sup></td>
<td>10 <sup>9</sup></td>
</tr>
<tr>
<td>TB</td>
<td>Terabyte</td>
<td>2 <sup>40</sup></td>
<td>10 <sup>12</sup></td>
</tr>
</tbody>
</table>
</div>
<p>see also Binary, Decimal, Hexadecimal</p>
<p>N.B. Technically, the correct abbreviation for 1024 bytes is
KiB, which stands for kilobinary bytes.</p>
</dd>
<dt><a name="glossary_upcase" id="glossary_upcase"></a>$UpCase</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file contains
128KB of capital letters.</p>
<p>For each character in the Unicode alphabet, there is an entry in
this file.</p>
<p>It is used to compare and sort filenames.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_upcase" title="NTFS Files: $UpCase (10)">(More...)</a></p>
</dd>
<dt><a name="glossary_update_sequence" id="glossary_update_sequence"></a>Update Sequence</dt>
<dd>
<p>Several structures in NTFS have sequence numbers in them to
check for consistancy errors.</p>
<p>They are FILE, INDX, RCRD and RSTR records.</p>
<p>Before the record is written to disk, the last two bytes of each
sector are copied to an array in the header.</p>
<p>The update sequence number is then incremented and written to
the end of each sector.</p>
<p>If any disk corruption occurs, this technique could detect
it.</p>
<pre class="programlisting">        The Update Sequence Array (usa) is an array of the __u16 values which belong
        to the end of each sector protected by the update sequence record in which
        this array is contained. Note that the first entry is the Update Sequence
        Number (usn), a cyclic counter of how many times the protected record has
        been written to disk. The values 0 and -1 (ie. 0xffff) are not used. All
        last __u16's of each sector have to be equal to the usn (during reading) or
        are set to it (during writing). If they are not, an incomplete multi sector
        transfer has occured when the data was written.
        The maximum size for the update sequence array is fixed to:
                maximum size = usa_ofs + (usa_count * 2) = 510 bytes
        The 510 bytes comes from the fact that the last __u16 in the array has to
        (obviously) finish before the last __u16 of the first 512-byte sector.
        This formula can be used as a consistency check in that usa_ofs +
        (usa_count * 2) has to be less than or equal to 510.
                                
</pre>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_file_record">FILE Record</a>,
<a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_indx_record">INDX Record</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_rcrd_record">RCRD Record</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_rstr_record">RSTR Record</a>.</p>
</dd>
<dt><a name="glossary_usnjrnl" id="glossary_usnjrnl"></a>$UsnJrnl</dt>
<dd>
<pre class="programlisting">used for logging
</pre>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_usnjrnl" title="NTFS Files: $UsnJrnl (Any)">(More...)</a></p>
</dd>
<dt>VCN <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_vcn">(See Virtual Cluster
Number)</a></dt>
<dd>
<p>See <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_vcn">Virtual Cluster Number
(VCN)</a>.</p>
</dd>
<dt><a name="glossary_vcn" id="glossary_vcn"></a>Virtual Cluster
Number (VCN)</dt>
<dd>
<p>When representing the data runs of a file, the clusters are
given virtual cluster numbers.</p>
<p>Cluster zero refers to the first cluster of the file.</p>
<p>The data runs map the VCNs to LCNs so that the file can be
located on the volume.</p>
<p>See Also <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_cluster">Cluster</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_lcn">Logical Cluster Number (LCN)</a>, <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_volume">Volume</a>.</p>
</dd>
<dt><a name="glossary_volume" id="glossary_volume"></a>Volume</dt>
<dd>
<p>(=drive=partition) (extended, striped, mirrored (not
supported))</p>
<p>A logical NTFS partition. It is a group of physical partitions
(see the fdisk utility, you can set up mirroring and stripping)
that act as one (somewhat like the Linux md block devices).</p>
</dd>
<dt><a name="glossary_volume2" id="glossary_volume2"></a>$Volume</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_metadata">metadata</a> file contains
information such as the name, serial number and whether the volume
needs checking for errors.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#file_volume" title="NTFS Files: $Volume (3)">(More...)</a></p>
</dd>
<dt><a name="glossary_volume_information" id="glossary_volume_information"></a>$VOLUME_INFORMATION</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> contains
information such as the serial number, creation time and whether
the volume needs checking for errors.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_information" title="Attribute - $VOLUME_INFORMATION (0x70)">(More...)</a></p>
</dd>
<dt><a name="glossary_volume_name" id="glossary_volume_name"></a>$VOLUME_NAME</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a> stores the name
of the volume in Unicode.</p>
<p><a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#attribute_volume_name" title="Attribute - $VOLUME_NAME (0x60)">(More...)</a></p>
</dd>
<dt><a name="glossary_volume_version" id="glossary_volume_version"></a>$VOLUME_VERSION</dt>
<dd>
<p>This <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_attribute">attribute</a>, like <a href="http://ftp.kolibrios.org/users/Asper/docs/NTFS/ntfsdoc.html#glossary_symbolic_link">$SYMBOLIC_LINK</a> existed in NTFS v1.2,
but wasn't used.</p>
<p>It does not longer exist in NTFS v3.0+.</p>
</dd>
</dl>
</div>
</div>
</div>


</body></html>